!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).F2=e()}(this,(function(){"use strict";var t=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},e={}.toString,i=function(t,i){return e.call(t)==="[object "+i+"]"},n=function(t){return i(t,"Function")},s=function(t){return null==t},r=function(t){return Array.isArray?Array.isArray(t):i(t,"Array")},a=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function o(t,e){if(t)if(r(t))for(var i=0,n=t.length;i<n&&!1!==e(t[i],i);i++);else if(a(t))for(var s in t)if(t.hasOwnProperty(s)&&!1===e(t[s],s))break}var l=Object.keys?function(t){return Object.keys(t)}:function(t){var e=[];return o(t,(function(i,s){n(t)&&"prototype"===s||e.push(s)})),e};var h=function(t){return"object"==typeof t&&null!==t},c=function(t){if(!h(t)||!i(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};var u=function(t){return i(t,"String")},g=function(t){return i(t,"Number")},d=function(t){return s(t)?"":t.toString()};function f(t,e){for(var i in e)e.hasOwnProperty(i)&&"constructor"!==i&&void 0!==e[i]&&(t[i]=e[i])}function p(t,e,i,n){return e&&f(t,e),i&&f(t,i),n&&f(t,n),t}function m(t,e,i,n){for(var s in i=i||0,n=n||5,e)if(e.hasOwnProperty(s)){var a=e[s];null!==a&&c(a)?(c(t[s])||(t[s]={}),i<n?m(t[s],a,i+1,n):t[s]=e[s]):r(a)?(t[s]=[],t[s]=t[s].concat(a)):void 0!==a&&(t[s]=a)}}var x=function(e,i){if(e===i)return!0;if(!e||!i)return!1;if(u(e)||u(i))return!1;if(t(e)||t(i)){if(e.length!==i.length)return!1;for(var n=!0,s=0;s<e.length&&(n=x(e[s],i[s]));s++);return n}if(h(e)||h(i)){var r=Object.keys(e),a=Object.keys(i);if(r.length!==a.length)return!1;for(n=!0,s=0;s<r.length&&(n=x(e[r[s]],i[r[s]]));s++);return n}return!1};function y(t,e){if(!e)return{0:t};const i=function(t){let i="_";for(let n=0,s=e.length;n<s;n++)i+=t[e[n]]&&t[e[n]].toString();return i},n={};for(let e=0,s=t.length;e<s;e++){const s=t[e],r=i(s);n[r]?n[r].push(s):n[r]=[s]}return n}var v=Object.freeze({__proto__:null,merge:function(t){let e=[];for(let i=0,n=t.length;i<n;i++)e=e.concat(t[i]);return e},values:function(t,e){const i=[],n={};for(let a=0,l=t.length;a<l;a++){const l=t[a][e];s(l)||(r(l)?o(l,t=>{n[t]||(i.push(t),n[t]=!0)}):n[l]||(i.push(l),n[l]=!0))}return i},firstValue:function(t,e){let i=null;for(let n=0,a=t.length;n<a;n++){const a=t[n][e];if(!s(a)){i=r(a)?a[0]:a;break}}return i},group:function(t,e,i={}){if(!e)return[t];const n=y(t,e),s=[];if(1===e.length&&i[e[0]]){o(i[e[0]],t=>{t="_"+t,s.push(n[t])})}else for(const t in n)s.push(n[t]);return s},groupToMap:y,remove:function(t,e){if(!t)return;const i=t.indexOf(e);-1!==i&&t.splice(i,1)},getRange:function(t){if(!t.length)return{min:0,max:0};const e=Math.max.apply(null,t);return{min:Math.min.apply(null,t),max:e}}});const _=!!function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0},S="object"==typeof wx&&"function"==typeof wx.getSystemInfoSync,b="object"==typeof my&&"function"==typeof my.getSystemInfoSync,C="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.sessionStorage;function P(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}function M(t,e){const i=e.get("el");if(!i)return t;const{top:n,right:s,bottom:r,left:a}=i.getBoundingClientRect(),o=parseFloat(P(i,"padding-left")),l=parseFloat(P(i,"padding-top")),h=s-a-o-parseFloat(P(i,"padding-right")),c=r-n-l-parseFloat(P(i,"padding-bottom")),u=e.get("pixelRatio");return{x:(t.x-a-o)/h*i.width/u,y:(t.y-n-l)/c*i.height/u}}function w(t,e,i,n,s){return{type:t,chart:e,native:s||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}var T=Object.freeze({__proto__:null,Array:v,upperFirst:function(t){var e=d(t);return e.charAt(0).toUpperCase()+e.substring(1)},lowerFirst:function(t){var e=d(t);return e.charAt(0).toLowerCase()+e.substring(1)},isString:u,isNumber:g,isBoolean:function(t){return i(t,"Boolean")},isFunction:n,isDate:function(t){return i(t,"Date")},isArray:r,isNil:s,isObject:a,isPlainObject:c,isEqual:x,deepMix:function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0;n<e.length;n+=1)m(t,e[n]);return t},mix:p,each:o,uniq:function(e){var i=[];return o(e,(function(e){(function(e,i){return!!t(e)&&e.indexOf(i)>-1})(i,e)||i.push(e)})),i},find:function(t,e){if(!r(t))return null;var i;if(n(e)&&(i=e),c(e)&&(i=function(t){return function(t,e){var i=l(e),n=i.length;if(s(t))return!n;for(var r=0;r<n;r+=1){var a=i[r];if(e[a]!==t[a]||!(a in t))return!1}return!0}(t,e)}),i)for(var a=0;a<t.length;a+=1)if(i(t[a]))return t[a];return null},isObjectValueEqual:function(t,e){t=Object.assign({},t),e=Object.assign({},e);const i=Object.getOwnPropertyNames(t),n=Object.getOwnPropertyNames(e);if(i.length!==n.length)return!1;for(let n=0,s=i.length;n<s;n++){const s=i[n];if(t[s]!==e[s])return!1}return!0},parsePadding:function(t){let e,i,n,a;return g(t)||u(t)?e=n=a=i=t:r(t)&&(e=t[0],i=s(t[1])?t[0]:t[1],n=s(t[2])?t[0]:t[2],a=s(t[3])?i:t[3]),[e,i,n,a]},directionEnabled:function(t,e){return void 0===t||"string"==typeof t&&-1!==t.indexOf(e)},isWx:S,isMy:b,isBrowser:C,isCanvasElement:function(t){return!(!t||"object"!=typeof t)&&(!(1!==t.nodeType||!t.nodeName)||!!t.isCanvasElement)},getPixelRatio:function(){return window&&window.devicePixelRatio||1},getStyle:P,getWidth:function(t){let e=P(t,"width");return"auto"===e&&(e=t.offsetWidth),parseFloat(e)},getHeight:function(t){let e=P(t,"height");return"auto"===e&&(e=t.offsetHeight),parseFloat(e)},getDomById:function(t){return t?document.getElementById(t):null},getRelativePosition:M,addEventListener:function(t,e,i){t.addEventListener(e,i,_)},removeEventListener:function(t,e,i){t.removeEventListener(e,i,_)},createEvent:function(t,e){const i=t.type;let n;if(t.touches){const s=t.changedTouches[0]||{},{x:r,y:a,clientX:o,clientY:l}=s;if(r&&a)return w(i,e,r,a,t);n={x:o,y:l}}else n={x:t.clientX,y:t.clientY};const s=M(n,e.get("canvas"));return w(i,e,s.x,s.y,t)},measureText:function(t,e,i){return i||(i=document.createElement("canvas").getContext("2d")),i.font=e||"12px sans-serif",i.measureText(t)}});const A={label:{fill:"#808080",fontSize:10},line:{stroke:"#E8E8E8",lineWidth:1},grid:{type:"line",stroke:"#E8E8E8",lineWidth:1,lineDash:[2]},tickLine:null,labelOffset:7.5};var D={fontFamily:'"Helvetica Neue", "San Francisco", Helvetica, Tahoma, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", sans-serif',defaultColor:"#1890FF",pixelRatio:1,padding:"auto",appendPadding:15,colors:["#1890FF","#2FC25B","#FACC14","#223273","#8543E0","#13C2C2","#3436C7","#F04864"],shapes:{line:["line","dash"],point:["circle","hollowCircle"]},sizes:[4,10],axis:{common:A,bottom:T.mix({},A,{grid:null}),left:T.mix({},A,{line:null}),right:T.mix({},A,{line:null}),circle:T.mix({},A,{line:null}),radius:T.mix({},A,{labelOffset:4})},shape:{line:{lineWidth:2,lineJoin:"round",lineCap:"round"},point:{lineWidth:0,size:3},area:{fillOpacity:.1}},_defaultAxis:A};const k={version:"3.6.4-beta.2",scales:{},widthRatio:{column:.5,rose:.999999,multiplePie:3/4},lineDash:[4,4],setTheme:function(t){T.deepMix(this,t)}};k.setTheme(D);var E=k;class I{constructor(){this.__events={}}on(t,e){if(!t||!e)return;const i=this.__events[t]||[];i.push(e),this.__events[t]=i}emit(t,e){if(a(t)&&(t=(e=t)&&e.type),!t)return;const i=this.__events[t];i&&i.length&&i.forEach(t=>{t.call(this,e)})}off(t,e){const i=this.__events,n=i[t];if(n&&n.length)if(e)for(let t=0,i=n.length;t<i;t++)n[t]===e&&n.splice(t,1);else delete i[t]}}class O extends I{getDefaultCfg(){return{}}constructor(t){super();const e={},i=this.getDefaultCfg();this._attrs=e,T.mix(e,i,t)}get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}destroy(){this._attrs={},this.destroyed=!0}}var Y=class{constructor(t){T.mix(this,t),this._init()}_init(){const t=this.start,e=this.end,i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),s=Math.min(t.y,e.y),r=Math.max(t.y,e.y);this.tl={x:i,y:s},this.tr={x:n,y:s},this.bl={x:i,y:r},this.br={x:n,y:r},this.width=n-i,this.height=r-s}reset(t,e){this.start=t,this.end=e,this._init()}isInRange(t,e){T.isObject(t)&&(e=t.y,t=t.x);const i=this.tl,n=this.br;return i.x<=t&&t<=n.x&&i.y<=e&&e<=n.y}};const F={multiply:(t,e)=>[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]],scale:(t,e,i)=>(t[0]=e[0]*i[0],t[1]=e[1]*i[0],t[2]=e[2]*i[1],t[3]=e[3]*i[1],t[4]=e[4],t[5]=e[5],t),rotate(t,e,i){const n=Math.cos(i),s=Math.sin(i),r=e[0]*n+e[2]*s,a=e[1]*n+e[3]*s,o=e[0]*-s+e[2]*n,l=e[1]*-s+e[3]*n;return t[0]=r,t[1]=a,t[2]=o,t[3]=l,t[4]=e[4],t[5]=e[5],t},translate:(t,e,i)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+e[0]*i[0]+e[2]*i[1],t[5]=e[5]+e[1]*i[0]+e[3]*i[1],t),transform(t,e){const i=[].concat(t);for(let t=0,n=e.length;t<n;t++){const n=e[t];switch(n[0]){case"t":F.translate(i,i,[n[1],n[2]]);break;case"s":F.scale(i,i,[n[1],n[2]]);break;case"r":F.rotate(i,i,n[1])}}return i}};var N=F,B={create:()=>[0,0],length(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},normalize(t,e){const i=this.length(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t},add:(t,e,i)=>(t[0]=e[0]+i[0],t[1]=e[1]+i[1],t),sub:(t,e,i)=>(t[0]=e[0]-i[0],t[1]=e[1]-i[1],t),scale:(t,e,i)=>(t[0]=e[0]*i,t[1]=e[1]*i,t),dot:(t,e)=>t[0]*e[0]+t[1]*e[1],direction:(t,e)=>t[0]*e[1]-e[0]*t[1],angle(t,e){const i=this.dot(t,e)/(this.length(t)*this.length(e));return Math.acos(i)},angleTo(t,e,i){const n=this.angle(t,e),s=this.direction(t,e)>=0;return i?s?2*Math.PI-n:n:s?n:2*Math.PI-n},zero:t=>0===t[0]&&0===t[1],distance(t,e){const i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},clone:t=>[t[0],t[1]],min:(t,e,i)=>(t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t),max:(t,e,i)=>(t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t),transformMat2d(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s+i[4],t[1]=i[1]*n+i[3]*s+i[5],t}};const X=[1,0,0,1,0,0];var L=class{_initDefaultCfg(){}constructor(t){let e,i;this._initDefaultCfg(),T.mix(this,t),this.plot?(e=this.plot.bl,i=this.plot.tr,this.start=e,this.end=i):(e=this.start,i=this.end),this.init(e,i)}_scale(t,e){const i=this.matrix,n=this.center;N.translate(i,i,[n.x,n.y]),N.scale(i,i,[t,e]),N.translate(i,i,[-n.x,-n.y])}init(t,e){this.matrix=[].concat(X),this.center={x:(e.x-t.x)/2+t.x,y:(e.y-t.y)/2+t.y},this.scale&&this._scale(this.scale[0],this.scale[1])}convertPoint(t){const{x:e,y:i}=this._convertPoint(t),n=[e,i];return B.transformMat2d(n,n,this.matrix),{x:n[0],y:n[1]}}invertPoint(t){return this._invertPoint(t)}_convertPoint(t){return t}_invertPoint(t){return t}reset(t){this.plot=t;const{bl:e,tr:i}=t;this.start=e,this.end=i,this.init(e,i)}};class z extends L{_initDefaultCfg(){this.type="cartesian",this.transposed=!1,this.isRect=!0}init(t,e){super.init(t,e),this.x={start:t.x,end:e.x},this.y={start:t.y,end:e.y}}_convertPoint(t){const e=this.transposed,i=e?"y":"x",n=e?"x":"y",s=this.x,r=this.y;return{x:s.start+(s.end-s.start)*t[i],y:r.start+(r.end-r.start)*t[n]}}_invertPoint(t){const e=this.transposed,i=e?"y":"x",n=e?"x":"y",s=this.x,r=this.y,a={};return a[i]=(t.x-s.start)/(s.end-s.start),a[n]=(t.y-r.start)/(r.end-r.start),a}}L.Cartesian=z,L.Rect=z;var R=L;const j={},G={_coord:null,draw(t,e){this.drawShape&&this.drawShape(t,e)},setCoord(t){this._coord=t},parsePoint(t){const e=this._coord;return e.isPolar&&(1===t.x&&(t.x=.9999999),1===t.y&&(t.y=.9999999)),e.convertPoint(t)},parsePoints(t){if(!t)return!1;const e=this,i=[];return t.forEach((function(t){i.push(e.parsePoint(t))})),i}},W={defaultShapeType:null,setCoord(t){this._coord=t},getShape(t){T.isArray(t)&&(t=t[0]);const e=this[t]||this[this.defaultShapeType];return e._coord=this._coord,e},getShapePoints(t,e){const i=this.getShape(t);return(i.getPoints||i.getShapePoints||this.getDefaultPoints)(e)},getDefaultPoints:()=>[],drawShape(t,e,i){const n=this.getShape(t);return e.color||(e.color=E.colors[0]),n.draw(e,i)}};j.registerFactory=function(t,e){const i=T.upperFirst(t),n=T.mix({},W,e);return j[i]=n,n.name=t,n},j.registerShape=function(t,e,i){const n=T.upperFirst(t),s=j[n],r=T.mix({},G,i);return s[e]=r,r},j.registShape=j.registerShape,j.getShapeFactory=function(t){return t=t||"point",this[T.upperFirst(t)]};var H=j;function V(t,e){for(var i in e)e.hasOwnProperty(i)&&"constructor"!==i&&void 0!==e[i]&&(t[i]=e[i])}var q=function(t,e,i,n){return e&&V(t,e),i&&V(t,i),n&&V(t,n),t},U=function(){var t=e.prototype;function e(t){this._initDefaultCfg(),q(this,t)}return t._initDefaultCfg=function(){this.adjustNames=["x","y"]},t.processAdjust=function(){},e}();function Z(t,e){return u(e)?e:t.invert(t.scale(e))}class ${constructor(t){this.type="base",this.name=null,this.method=null,this.values=[],this.scales=[],this.linear=null;let e=null;const i=this.callback;if(t.callback){const n=t.callback;e=(...t)=>{let e=n(...t);return s(e)&&(e=i.apply(this,t)),e}}p(this,t),e&&p(this,{callback:e})}_getAttrValue(t,e){const i=this.values;if(t.isCategory&&!this.linear){return i[t.translate(e)%i.length]}const n=t.scale(e);return this.getLinearValue(n)}getLinearValue(t){const e=this.values,i=e.length-1,n=Math.floor(i*t),s=i*t-n,r=e[n];return r+((n===i?r:e[n+1])-r)*s}callback(t){const e=this,i=e.scales[0];let n=null;return n="identity"===i.type?i.value:e._getAttrValue(i,t),n}getNames(){const t=this.scales,e=this.names,i=Math.min(t.length,e.length),n=[];for(let t=0;t<i;t++)n.push(e[t]);return n}getFields(){const t=this.scales,e=[];return o(t,t=>{e.push(t.field)}),e}getScale(t){return this.scales[this.names.indexOf(t)]}mapping(...t){const e=this.scales,i=this.callback;let n=t;if(i){for(let i=0,n=t.length;i<n;i++)t[i]=this._toOriginParam(t[i],e[i]);n=i.apply(this,t)}return n=[].concat(n),n}_toOriginParam(t,e){let i=t;if(!e.isLinear)if(r(t)){i=[];for(let n=0,s=t.length;n<s;n++)i.push(Z(e,t[n]))}else i=Z(e,t);return i}}function J(t,e,i,n){return t[n]+(e[n]-t[n])*i}function K(t){return"#"+Q(t[0])+Q(t[1])+Q(t[2])}function Q(t){return 1===(t=(t=Math.round(t)).toString(16)).length&&(t="0"+t),t}function tt(t){const e=[];return e.push(parseInt(t.substr(1,2),16)),e.push(parseInt(t.substr(3,2),16)),e.push(parseInt(t.substr(5,2),16)),e}const et={black:"#000000",blue:"#0000ff",grey:"#808080",green:"#008000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",red:"#ff0000",white:"#ffffff",yellow:"#ffff00"},it={toHex(t){if(et[t])return et[t];if("#"===t[0]){if(7===t.length)return t;const e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,n){return"#"+e+e+i+i+n+n}));return et[t]=e,e}let e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e.shift(),e=K(e),et[t]=e,e},hex2arr:tt,gradient(t){const e=[];return u(t)&&(t=t.split("-")),o(t,(function(t){-1===t.indexOf("#")&&(t=it.toHex(t)),e.push(tt(t))})),function(t){return function(t,e){const i=t.length-1,n=Math.floor(i*e),s=i*e-n,r=t[n],a=n===i?r:t[n+1];return K([J(r,a,s,0),J(r,a,s,1),J(r,a,s,2)])}(e,t)}}};var nt=Object.freeze({__proto__:null,Position:class extends ${constructor(t){super(t),this.names=["x","y"],this.type="position"}mapping(t,e){const i=this.scales,n=this.coord,a=i[0],l=i[1];let h,c,u;if(s(t)||s(e))return[];if(r(e)&&r(t)){h=[],c=[];for(let i=0,s=0,r=t.length,o=e.length;i<r&&s<o;i++,s++)u=n.convertPoint({x:a.scale(t[i]),y:l.scale(e[s])}),h.push(u.x),c.push(u.y)}else if(r(e))t=a.scale(t),c=[],o(e,(function(e){e=l.scale(e),u=n.convertPoint({x:t,y:e}),h&&h!==u.x?(r(h)||(h=[h]),h.push(u.x)):h=u.x,c.push(u.y)}));else if(r(t))e=l.scale(e),h=[],o(t,(function(t){t=a.scale(t),u=n.convertPoint({x:t,y:e}),c&&c!==u.y?(r(c)||(c=[c]),c.push(u.y)):c=u.y,h.push(u.x)}));else{t=a.scale(t),e=l.scale(e);const i=n.convertPoint({x:t,y:e});h=i.x,c=i.y}return[h,c]}},Shape:class extends ${constructor(t){super(t),this.names=["shape"],this.type="shape",this.gradient=null}getLinearValue(t){const e=this.values;return e[Math.round((e.length-1)*t)]}},Size:class extends ${constructor(t){super(t),this.names=["size"],this.type="size",this.gradient=null}},Color:class extends ${constructor(t){super(t),this.names=["color"],this.type="color",this.gradient=null,u(this.values)&&(this.linear=!0)}getLinearValue(t){let e=this.gradient;if(!e){const t=this.values;e=it.gradient(t),this.gradient=e}return e(t)}}});const st=["color","size","shape"];function rt(t){return T.isArray(t)?t:T.isString(t)?t.split("*"):[t]}class at extends O{getDefaultCfg(){return{type:null,data:null,attrs:{},scales:{},container:null,styleOptions:null,chart:null,shapeType:"",generatePoints:!1,attrOptions:{},sortable:!1,startOnZero:!0,visible:!0,connectNulls:!1,ignoreEmptyGroup:!1}}init(){this._initAttrs(),this._processData()}_getGroupScales(){const t=this,e=[];return T.each(st,(function(i){const n=t.getAttr(i);if(n){const t=n.scales;T.each(t,(function(t){t&&t.isCategory&&-1===e.indexOf(t)&&e.push(t)}))}})),e}_groupData(t){const e=this.get("colDefs"),i=this._getGroupScales();if(i.length){const n={},s=[];return T.each(i,t=>{const i=t.field;s.push(i),e&&e[i]&&e[i].values&&(n[t.field]=e[i].values)}),T.Array.group(t,s,n)}return[t]}_setAttrOptions(t,e){this.get("attrOptions")[t]=e;const i=this.get("attrs");Object.keys(i).length&&this._createAttr(t,e)}_createAttrOption(t,e,i,n){const s={};s.field=e,i?T.isFunction(i)?s.callback=i:s.values=i:s.values=n,this._setAttrOptions(t,s)}_createAttr(t,e){const i=this,n=i.get("attrs"),s=i.get("coord"),r=T.upperFirst(t),a=rt(e.field);"position"===t&&(e.coord=s);const o=[];for(let t=0,e=a.length;t<e;t++){const e=a[t],n=i._createScale(e);o.push(n)}if("position"===t){const t=o[1];"polar"===s.type&&s.transposed&&i.hasAdjust("stack")&&t.values.length&&t.change({nice:!1,min:0,max:Math.max.apply(null,t.values)})}e.scales=o;const l=new nt[r](e);return n[t]=l,l}_initAttrs(){const t=this.get("attrOptions");for(const e in t)t.hasOwnProperty(e)&&this._createAttr(e,t[e])}_createScale(t){const e=this.get("scales");let i=e[t];return i||(i=this.get("chart").createScale(t),e[t]=i),i}_processData(){const t=this,e=this.get("data"),i=[];let n=this._groupData(e);if(this.get("ignoreEmptyGroup")){const t=this.getYScale();n=n.filter(e=>e.some(e=>void 0!==e[t.field]))}for(let e=0,s=n.length;e<s;e++){const s=n[e],r=t._saveOrigin(s);this.hasAdjust("dodge")&&t._numberic(r),i.push(r)}return t.get("adjust")&&t._adjustData(i),t.get("sortable")&&t._sort(i),t.emit("afterprocessdata",{dataArray:i}),t.set("dataArray",i),i}_saveOrigin(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i],s={};for(const t in n)s[t]=n[t];s._origin=n,e.push(s)}return e}_numberic(t){const e=this.getAttr("position").scales;for(let i=0,n=t.length;i<n;i++){const n=t[i],s=Math.min(2,e.length);for(let t=0;t<s;t++){const i=e[t];if(i.isCategory){const t=i.field;n[t]=i.translate(n[t])}}}}_adjustData(t){const e=this,i=e.get("adjust");if(i){const n=T.upperFirst(i.type);if(!U[n])throw new Error("not support such adjust : "+i);const s=e.getXScale(),r=e.getYScale(),a=T.mix({xField:s.field,yField:r.field},i);new U[n](a).processAdjust(t),"Stack"===n&&e._updateStackRange(r.field,r,t)}}_updateStackRange(t,e,i){const n=T.Array.merge(i);let s=e.min,r=e.max;for(let e=0,i=n.length;e<i;e++){const i=n[e],a=Math.min.apply(null,i[t]),o=Math.max.apply(null,i[t]);a<s&&(s=a),o>r&&(r=o)}(s<e.min||r>e.max)&&e.change({min:s,max:r})}_sort(t){const e=this.getXScale(),{field:i,type:n}=e;"identity"!==n&&e.values.length>1&&T.each(t,t=>{t.sort((t,s)=>"timeCat"===n?e._toTimeStamp(t._origin[i])-e._toTimeStamp(s._origin[i]):e.translate(t._origin[i])-e.translate(s._origin[i]))}),this.set("hasSorted",!0),this.set("dataArray",t)}paint(){const t=this,e=t.get("dataArray"),i=[],n=t.getShapeFactory();n.setCoord(t.get("coord")),t._beforeMapping(e);for(let s=0,r=e.length;s<r;s++){let r=e[s];r.length&&(r=t._mapping(r),i.push(r),t.draw(r,n))}t.set("dataArray",i)}getShapeFactory(){let t=this.get("shapeFactory");if(!t){const e=this.get("shapeType");t=H.getShapeFactory(e),this.set("shapeFactory",t)}return t}_mapping(t){const e=this,i=e.get("attrs"),n=e.getYScale().field,s={};for(const r in i)if(i.hasOwnProperty(r)){const a=i[r],o=a.names,l=a.scales;for(let i=0,r=t.length;i<r;i++){const r=t[i];if(r._originY=r[n],"position"===a.type){const t=e._getAttrValues(a,r);for(let e=0,i=t.length;e<i;e++){const i=t[e];r[o[e]]=T.isArray(i)&&1===i.length?i[0]:i}}else{const t=o[0],i=`${t}${r[l[0].field]}`;let n=s[i];n||(n=e._getAttrValues(a,r),s[i]=n),r[t]=n[0]}}}return t}_getAttrValues(t,e){const i=t.scales,n=[];for(let t=0,s=i.length;t<s;t++){const s=i[t],r=s.field;"identity"===s.type?n.push(s.value):n.push(e[r])}return t.mapping(...n)}getAttrValue(t,e){const i=this.getAttr(t);let n=null;if(i){n=this._getAttrValues(i,e)[0]}return n}_beforeMapping(t){const e=this;e.get("generatePoints")&&e._generatePoints(t)}isInCircle(){const t=this.get("coord");return t&&t.isPolar}getCallbackCfg(t,e,i){if(!t)return e;const n={},s=t.map((function(t){return i[t]}));return T.each(e,(function(t,e){T.isFunction(t)?n[e]=t.apply(null,s):n[e]=t})),n}getDrawCfg(t){const e=this,i=e.isInCircle(),n={origin:t,x:t.x,y:t.y,color:t.color,size:t.size,shape:t.shape,isInCircle:i,opacity:t.opacity},s=e.get("styleOptions");return s&&s.style&&(n.style=e.getCallbackCfg(s.fields,s.style,t._origin)),e.get("generatePoints")&&(n.points=t.points,n.nextPoints=t.nextPoints),i&&(n.center=e.get("coord").center),n}draw(t,e){const i=this,n=i.get("container"),s=i.getYScale();T.each(t,(function(t,r){if(s&&T.isNil(t._origin[s.field]))return;t.index=r;const a=i.getDrawCfg(t),o=t.shape;i.drawShape(o,t,a,n,e)}))}drawShape(t,e,i,n,s){const r=s.drawShape(t,i,n);r&&T.each([].concat(r),t=>{t.set("origin",e)})}_generatePoints(t){const e=this,i=e.getShapeFactory(),n=e.getAttr("shape");T.each(t,(function(t){for(let s=0,r=t.length;s<r;s++){const r=t[s],a=e.createShapePointsCfg(r),o=n?e._getAttrValues(n,r):null,l=i.getShapePoints(o,a);r.points=l}})),T.each(t,(e,i)=>{const n=t[i+1];n&&(e[0].nextPoints=n[0].points)})}createShapePointsCfg(t){const e=this.getXScale(),i=this.getYScale(),n=this._normalizeValues(t[e.field],e);let s;return s=i?this._normalizeValues(t[i.field],i):t.y?t.y:.1,{x:n,y:s,y0:i?i.scale(this.getYMinValue()):void 0}}getYMinValue(){const t=this.getYScale(),{min:e,max:i}=t;let n;return n=this.get("startOnZero")?i<=0&&e<=0?i:e>=0?e:0:e,n}_normalizeValues(t,e){let i=[];if(T.isArray(t))for(let n=0,s=t.length;n<s;n++){const s=t[n];i.push(e.scale(s))}else i=e.scale(t);return i}getAttr(t){return this.get("attrs")[t]}getXScale(){return this.getAttr("position").scales[0]}getYScale(){return this.getAttr("position").scales[1]}hasAdjust(t){return this.get("adjust")&&this.get("adjust").type===t}_getSnap(t,e,i){let n,s=0;const r=this.getYScale().field;if(this.hasAdjust("stack")&&t.field===r){n=[],i.forEach((function(t){n.push(t._originY)}));for(let t=n.length;s<t&&!(n[0][0]>e);s++){if(n[n.length-1][1]<=e){s=n.length-1;break}if(n[s][0]<=e&&n[s][1]>e)break}}else{n=t.values,n.sort((t,e)=>t-e);for(let t=n.length;s<t&&!(t<=1)&&!((n[0]+n[1])/2>e)&&!((n[s-1]+n[s])/2<=e&&(n[s+1]+n[s])/2>e);s++)if((n[n.length-2]+n[n.length-1])/2<=e){s=n.length-1;break}}return n[s]}getSnapRecords(t){const e=this,i=e.get("coord"),n=e.getXScale(),s=e.getYScale(),r=n.field,a=e.get("dataArray");this.get("hasSorted")||this._sort(a);let o=[];const l=i.invertPoint(t);let h=l.x;e.isInCircle()&&!i.transposed&&h>(1+n.rangeMax())/2&&(h=n.rangeMin());let c=n.invert(h);n.isCategory||(c=e._getSnap(n,c));const u=[];if(a.forEach((function(t){t.forEach((function(t){const i=T.isNil(t._origin)?t[r]:t._origin[r];e._isEqual(i,c,n)&&u.push(t)}))})),this.hasAdjust("stack")&&i.isPolar&&i.transposed){if(h>=0&&h<=1){let t=s.invert(l.y);t=e._getSnap(s,t,u),u.forEach(e=>{(T.isArray(t)?e._originY.toString()===t.toString():e._originY===t)&&o.push(e)})}}else o=u;return o}getRecords(t){const e=this.getXScale(),i=this.get("dataArray"),n=e.field;return i.map(i=>{for(let s=i.length-1;s>=0;s--){const r=i[s],a=T.isNil(r._origin)?r[n]:r._origin[n];if(this._isEqual(a,t,e))return r}return null})}_isEqual(t,e,i){return"timeCat"===i.type?i._toTimeStamp(t)===e:e===t}position(t){return this._setAttrOptions("position",{field:t}),this}color(t,e){return this._createAttrOption("color",t,e,E.colors),this}size(t,e){return this._createAttrOption("size",t,e,E.sizes),this}shape(t,e){const i=this.get("type"),n=E.shapes[i]||[];return this._createAttrOption("shape",t,e,n),this}style(t,e){let i,n=this.get("styleOptions");return n||(n={},this.set("styleOptions",n)),T.isObject(t)&&(e=t,t=null),t&&(i=rt(t)),n.fields=i,n.style=e,this}adjust(t){return T.isString(t)&&(t={type:t}),this.set("adjust",t),this}animate(t){return this.set("animateCfg",t),this}changeData(t){this.set("data",t),this.set("scales",{}),this.init()}clearInner(){const t=this.get("container");t&&t.clear()}reset(){this.set("attrs",{}),this.set("attrOptions",{}),this.set("adjust",null),this.clearInner()}clear(){this.clearInner()}destroy(){this.clear(),super.destroy()}_display(t){this.set("visible",t);const e=this.get("container"),i=e.get("canvas");e.set("visible",t),i.draw()}show(){this._display(!0)}hide(){this._display(!1)}}var ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt=function(t){var e=void 0===t?"undefined":ot(t);return null!==t&&"object"===e||"function"===e},ht={}.toString,ct=function(t,e){return ht.call(t)==="[object "+e+"]"},ut=Array.isArray?Array.isArray:function(t){return ct(t,"Array")},gt=function(t,e){if(t){if(ut(t))for(var i=0,n=t.length;i<n&&!1!==e(t[i],i);i++);else if(lt(t))for(var s in t)if(t.hasOwnProperty(s)&&!1===e(t[s],s))break}},dt=function(t){return null==t},ft=function(){var t=e.prototype;function e(t){this._initDefaultCfg(),q(this,t),this.init()}return t._initDefaultCfg=function(){this.type="base",this.formatter=null,this.range=[0,1],this.ticks=null,this.values=[]},t.init=function(){},t.getTicks=function(){var t=this,e=t.ticks,i=[];return gt(e,(function(e){var n;n=lt(e)?e:{text:t.getText(e),tickValue:e,value:t.scale(e)},i.push(n)})),i},t.getText=function(t,e){var i=this.formatter;return t=i?i(t,e):t,!dt(t)&&t.toString||(t=""),t.toString()},t.rangeMin=function(){return this.range[0]},t.rangeMax=function(){var t=this.range;return t[t.length-1]},t.invert=function(t){return t},t.translate=function(t){return t},t.scale=function(t){return t},t.clone=function(){var t=this,e=t.constructor,i={};return gt(t,(function(e,n){i[n]=t[n]})),new e(i)},t.change=function(t){return this.ticks=null,q(this,t),this.init(),this},e}(),pt=function(t){return ct(t,"Number")};function mt(t,e){var i=t.length;if(0===i)return NaN;var n=t[0];if(e<t[0])return NaN;if(e>=t[i-1])return t[i-1];for(var s=1;s<t.length&&!(e<t[s]);s++)n=t[s];return n}function xt(t,e){var i,n=t.length;if(0===n)return NaN;if(e>t[n-1])return NaN;if(e<t[0])return t[0];for(var s=1;s<t.length;s++)if(e<=t[s]){i=t[s];break}return i}var yt={snapFactorTo:function(t,e,i){if(isNaN(t))return NaN;var n=1;if(0!==t){t<0&&(n=-1);var s=function(t){var e=1;if(t===1/0||t===-1/0)throw new Error("Not support Infinity!");if(t<1){for(var i=0;t<1;)e/=10,t*=10,i++;e.toString().length>12&&(e=parseFloat(e.toFixed(i)))}else for(;t>10;)e*=10,t/=10;return e}(t*=n);n*=s,t/=s}t="floor"===i?yt.snapFloor(e,t):"ceil"===i?yt.snapCeiling(e,t):yt.snapTo(e,t);var r=parseFloat((t*n).toPrecision(12));Math.abs(n)<1&&r.toString().length>12&&(r=t/parseInt(1/n)*(n>0?1:-1));return r},snapMultiple:function(t,e,i){return("ceil"===i?Math.ceil(t/e):"floor"===i?Math.floor(t/e):Math.round(t/e))*e},snapTo:function(t,e){var i=mt(t,e),n=xt(t,e);if(isNaN(i)||isNaN(n)){if(t[0]>=e)return t[0];var s=t[t.length-1];if(s<=e)return s}return Math.abs(e-i)<Math.abs(n-e)?i:n},snapFloor:function(t,e){return mt(t,e)},snapCeiling:function(t,e){return xt(t,e)},fixedBase:function(t,e){var i=e.toString(),n=i.indexOf("."),s=i.indexOf("e-");if(n<0&&s<0)return Math.round(t);var r=s>=0?parseInt(i.substr(s+2),10):i.substr(n+1).length;return r>20&&(r=20),parseFloat(t.toFixed(r))}},vt=yt,_t=[0,1,1.2,1.5,1.6,2,2.2,2.4,2.5,3,4,5,6,7.5,8,10],St=[0,1,2,4,5,10];var bt=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){t.prototype._initDefaultCfg.call(this);this.type="linear",this.isLinear=!0,this.nice=!1,this.min=null,this.minLimit=null,this.max=null,this.maxLimit=null,this.tickCount=null,this.tickInterval=null,this.minTickInterval=null,this.snapArray=null},s.init=function(){if(this.ticks){var t=this.ticks,e=this.translate(t[0]),i=this.translate(t[t.length-1]);(dt(this.min)||this.min>e)&&(this.min=e),(dt(this.max)||this.max<i)&&(this.max=i)}else this.min=this.translate(this.min),this.max=this.translate(this.max),this.initTicks()},s.calculateTicks=function(){var t=this.min,e=this.max,i=this.minLimit,n=this.maxLimit,s=this.tickCount,r=this.tickInterval,a=this.minTickInterval,o=this.snapArray;if(1===s)throw new Error("linear scale'tickCount should not be 1");if(e<t)throw new Error("max: "+e+" should not be less than min: "+t);return function(t){var e=t.min,i=t.max,n=t.interval,s=t.minTickInterval,r=[],a=t.minCount||5,o=t.maxCount||7,l=a===o,h=dt(t.minLimit)?-1/0:t.minLimit,c=dt(t.maxLimit)?1/0:t.maxLimit,u=(a+o)/2,g=u,d=t.snapArray?t.snapArray:l?_t:St;if(e===h&&i===c&&l&&(n=(i-e)/(g-1)),dt(e)&&(e=0),dt(i)&&(i=0),Math.abs(i-e)<1e-12&&(0===e?i=1:e>0?e=0:i=0,i-e<5&&!n&&i-e>=1&&(n=1)),dt(n)){var f=(i-e)/(u-1);n=vt.snapFactorTo(f,d,"ceil"),o!==a&&((g=parseInt((i-e)/n,10))>o&&(g=o),g<a&&(g=a),n=vt.snapFactorTo((i-e)/(g-1),d,"floor"))}if(pt(s)&&n<s&&(n=s),t.interval||o!==a)i=Math.min(vt.snapMultiple(i,n,"ceil"),c),e=Math.max(vt.snapMultiple(e,n,"floor"),h),g=Math.round((i-e)/n),e=vt.fixedBase(e,n),i=vt.fixedBase(i,n);else{u=parseInt(u,10);var p,m=(i+e)/2,x=vt.snapMultiple(m,n,"ceil"),y=Math.floor((u-2)/2),v=x+y*n;p=u%2==0?x-y*n:x-(y+1)*n;for(var _=null;v<i&&(null===_||v>_);)_=v,v=vt.fixedBase(v+n,n);for(var S=null;p>e&&(null===S||p<S);)S=p,p=vt.fixedBase(p-n,n);i=v,e=p}i=Math.min(i,c),e=Math.max(e,h),r.push(e);for(var b=1;b<g;b++){var C=vt.fixedBase(n*b+e,n);C<i&&r.push(C)}return r[r.length-1]<i&&r.push(i),{min:e,max:i,interval:n,count:g,ticks:r}}({min:t,max:e,minLimit:i,maxLimit:n,minCount:s,maxCount:s,interval:r,minTickInterval:a,snapArray:o}).ticks},s.initTicks=function(){var t=this,e=t.calculateTicks();if(t.nice)t.ticks=e,t.min=e[0],t.max=e[e.length-1];else{var i=[];gt(e,(function(e){e>=t.min&&e<=t.max&&i.push(e)})),i.length||(i.push(t.min),i.push(t.max)),t.ticks=i}},s.scale=function(t){if(dt(t))return NaN;var e=this.max,i=this.min;if(e===i)return 0;var n=(t-i)/(e-i),s=this.rangeMin();return s+n*(this.rangeMax()-s)},s.invert=function(t){var e=(t-this.rangeMin())/(this.rangeMax()-this.rangeMin());return this.min+e*(this.max-this.min)},n}(ft);ft.Linear=bt;var Ct=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){t.prototype._initDefaultCfg.call(this),this.isIdentity=!0,this.type="identity",this.value=null},s.getText=function(){return this.value.toString()},s.scale=function(t){return this.value!==t&&pt(t)?t:this.range[0]},s.invert=function(){return this.value},n}(ft);ft.Identity=Ct;var Pt=function(t){var e,i,n,s={},r=[],a=t.isRounding,o=(e=t.data,i=[],gt(e,(function(t){i=i.concat(t)})),i),l=o.length,h=t.maxCount||8;if(a?2===(n=function(t,e){var i;for(i=e;i>0&&t%i!=0;i--);if(1===i)for(i=e;i>0&&(t-1)%i!=0;i--);return i}(l-1,h-1)+1)?n=h:n<h-4&&(n=h-4):n=h,!a&&l<=n+n/2)r=[].concat(o);else{for(var c=parseInt(l/(n-1),10),u=o.map((function(t,e){return e%c==0?o.slice(e,e+c):null})).filter((function(t){return t})),g=1,d=u.length;g<d&&(a?g*c<l-c:g<n-1);g++)r.push(u[g][0]);if(o.length){r.unshift(o[0]);var f=o[l-1];-1===r.indexOf(f)&&r.push(f)}}return s.categories=o,s.ticks=r,s},Mt=function(t){return ct(t,"String")};var wt=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){t.prototype._initDefaultCfg.call(this),this.type="cat",this.isCategory=!0,this.isRounding=!0},s.init=function(){var t=this.values,e=this.tickCount;if(gt(t,(function(e,i){t[i]=e.toString()})),!this.ticks){var i=t;if(e)i=Pt({maxCount:e,data:t,isRounding:this.isRounding}).ticks;this.ticks=i}},s.getText=function(e){return-1===this.values.indexOf(e)&&pt(e)&&(e=this.values[Math.round(e)]),t.prototype.getText.call(this,e)},s.translate=function(t){var e=this.values.indexOf(t);return-1===e&&pt(t)?e=t:-1===e&&(e=NaN),e},s.scale=function(t){var e=this.rangeMin(),i=this.rangeMax();return(Mt(t)||-1!==this.values.indexOf(t))&&(t=this.translate(t)),e+(this.values.length>1?t/(this.values.length-1):t)*(i-e)},s.invert=function(t){if(Mt(t))return t;var e=this.rangeMin(),i=this.rangeMax();t<e&&(t=e),t>i&&(t=i);var n=(t-e)/(i-e),s=Math.round(n*(this.values.length-1))%this.values.length;return s=s||0,this.values[s]},n}(ft);ft.Cat=wt;var Tt=wt,At=ft;const Dt={linear:"Linear",cat:"Cat",timeCat:"TimeCat",identity:"Identity"};function kt(t){Object.keys(t).forEach(e=>{delete t[e]})}var Et=class{constructor(t){this.defs={},this.scales={},T.mix(this,t)}setFieldDef(t,e){const{defs:i}=this;T.isObject(t)?T.mix(i,t):i[t]=e,this.updateScales()}_getDef(t){const e=this.defs;let i=null;return(E.scales[t]||e[t])&&(i=T.mix({},E.scales[t]),T.each(e[t],(function(t,e){T.isNil(t)?delete i[e]:i[e]=t}))),i}_getDefaultType(t,e,i){if(i&&i.type)return i.type;let n="linear",s=T.Array.firstValue(e,t);return T.isArray(s)&&(s=s[0]),T.isString(s)&&(n="cat"),n}_getScaleDef(t,e,i,n){let s;s=n&&n.values?n.values:T.Array.values(i,e);const r={field:e,values:s};if("cat"!==t&&"timeCat"!==t){if(!n||!n.min||!n.max){const{min:t,max:e}=T.Array.getRange(s);r.min=t,r.max=e,r.nice=!0}}else r.isRounding=!1;return r}_adjustRange(t,e){const{range:i,values:n}=e;if("linear"===t||i||!n)return e;const s=n.length;if(1===s)e.range=[.5,1];else{const{chart:t}=this,i=t.get("coord"),n=E.widthRatio.multiplePie;let r=0;!function(t){if(!t.isPolar)return!1;const e=t.startAngle,i=t.endAngle;return!(!T.isNil(e)&&!T.isNil(i)&&i-e<2*Math.PI)}(i)?(r=1/s*1/2,e.range=[r,1-r]):i.transposed?(r=1/s*n,e.range=[r/2,1-r/2]):e.range=[0,1-1/s]}return e}_getScaleCfg(t,e){const i=this._getDef(t);if(!e||!e.length)return i&&i.type?(i.field=t,{type:Dt[i.type],cfg:i}):{type:"Identity",cfg:{value:t,field:t.toString(),values:[t]}};let n=e[0][t];if(null===n&&(n=T.Array.firstValue(e,t)),T.isNumber(t)||T.isNil(n)&&!i)return{type:"Identity",cfg:{value:t,field:t.toString(),values:[t]}};const s=this._getDefaultType(t,e,i);let r=this._getScaleDef(s,t,e,i);return i&&T.mix(r,i),r=this._adjustRange(s,r),{type:Dt[s],cfg:r}}createScale(t,e){const{scales:i}=this,{type:n,cfg:s}=this._getScaleCfg(t,e),r=i[t];if(r&&Dt[r.type]===n)return r.change(s),r;const a=new At[n](s);return i[t]=a,a}_updateScale(t){const{field:e}=t,i=this.chart._getScaleData(e),{cfg:n}=this._getScaleCfg(e,i);t.change(n)}updateScales(){const{scales:t}=this;T.each(t,t=>{this._updateScale(t)})}adjustStartZero(t){const{defs:e}=this,{field:i,min:n,max:s}=t;e[i]&&e[i].min||(n>0?t.change({min:0}):s<0&&t.change({max:0}))}clear(){kt(this.defs),kt(this.scales),this.data=null}};var It=class{_initDefaultCfg(){this.ticks=[],this.tickLine={},this.offsetFactor=1,this.frontContainer=null,this.backContainer=null,this.gridPoints=[]}constructor(t){this._initDefaultCfg(),T.mix(this,t),this.draw()}draw(){const{line:t,tickLine:e,label:i,grid:n}=this;n&&this.drawGrid(n),e&&this.drawTicks(e),t&&this.drawLine(t),i&&this.drawLabels()}drawTicks(t){const e=this,i=e.ticks,n=t.length,s=e.getContainer(t.top);T.each(i,(function(i){const r=e.getOffsetPoint(i.value),a=e.getSidePoint(r,n);s.addShape("line",{className:"axis-tick",attrs:T.mix({x1:r.x,y1:r.y,x2:a.x,y2:a.y},t)})._id=e._id+"-ticks"}))}drawLabels(){const t=this,e=t.labelOffset,i=t.labels;T.each(i,i=>{const n=t.getContainer(i.get("top")),s=t.getOffsetPoint(i.get("value")),{x:r,y:a}=t.getSidePoint(s,e);i.attr(T.mix({x:r,y:a},t.getTextAlignInfo(s,e),i.get("textStyle"))),i._id=t._id+"-"+i.attr("text"),n.add(i)})}drawLine(){}drawGrid(t){const e=this,{gridPoints:i,ticks:n}=e;let s=t;const r=i.length;T.each(i,(function(i,a){if(T.isFunction(t)){const e=n[a]||{},i=t(e.text,a,r);s=i?T.mix({},E._defaultAxis.grid,i):null}if(s){const t=s.type,n=i.points,r=e.getContainer(s.top);let a;if("arc"===t){const{center:t,startAngle:i,endAngle:o}=e,l=B.length([n[0].x-t.x,n[0].y-t.y]);a=r.addShape("Arc",{className:"axis-grid",attrs:T.mix({x:t.x,y:t.y,startAngle:i,endAngle:o,r:l},s)})}else a=r.addShape("Polyline",{className:"axis-grid",attrs:T.mix({points:n},s)});a._id=i._id}}))}getOffsetPoint(){}getAxisVector(){}getOffsetVector(t,e){const i=this.getAxisVector(t),n=B.normalize([],i),s=this.offsetFactor,r=[-1*n[1]*s,n[0]*s];return B.scale([],r,e)}getSidePoint(t,e){const i=this.getOffsetVector(t,e);return{x:t.x+i[0],y:t.y+i[1]}}getTextAlignInfo(t,e){const i=this.getOffsetVector(t,e);let n,s;return n=i[0]>0?"left":i[0]<0?"right":"center",s=i[1]>0?"top":i[1]<0?"bottom":"middle",{textAlign:n,textBaseline:s}}getContainer(t){const{frontContainer:e,backContainer:i}=this;return t?e:i}};It.Line=class extends It{_initDefaultCfg(){super._initDefaultCfg(),this.start=null,this.end=null}getOffsetPoint(t){const{start:e,end:i}=this;return{x:e.x+(i.x-e.x)*t,y:e.y+(i.y-e.y)*t}}getAxisVector(){const{start:t,end:e}=this;return[e.x-t.x,e.y-t.y]}drawLine(t){const e=this.getContainer(t.top),{start:i,end:n}=this;e.addShape("line",{className:"axis-line",attrs:T.mix({x1:i.x,y1:i.y,x2:n.x,y2:n.y},t)})}};var Ot=It;function Yt(t,e){T.each(t,t=>{t=t.split(":"),e.addColorStop(Number(t[0]),t[1])})}var Ft={parseStyle(t,e,i){if("("===t[1])try{const n=t[0];if("l"===n)return function(t,e,i){const n=t.split(" ");let s=n[0].slice(2,n[0].length-1);var r,a;r=parseFloat(s)*Math.PI/180,a=2*Math.PI,s=(r%a+a)%a;const o=n.slice(1),{minX:l,minY:h,maxX:c,maxY:u}=e.getBBox();let g,d;s>=0&&s<.5*Math.PI?(g={x:l,y:h},d={x:c,y:u}):.5*Math.PI<=s&&s<Math.PI?(g={x:c,y:h},d={x:l,y:u}):Math.PI<=s&&s<1.5*Math.PI?(g={x:c,y:u},d={x:l,y:h}):(g={x:l,y:u},d={x:c,y:h});const f=Math.tan(s),p=f*f,m=(d.x-g.x+f*(d.y-g.y))/(p+1)+g.x,x=f*(d.x-g.x+f*(d.y-g.y))/(p+1)+g.y,y=i.createLinearGradient(g.x,g.y,m,x);return Yt(o,y),y}(t,e,i);if("r"===n)return function(t,e,i){const n=t.split(" ");let s=n[0].slice(2,n[0].length-1);s=s.split(",");const r=parseFloat(s[0]),a=parseFloat(s[1]),o=parseFloat(s[2]),l=n.slice(1);if(0===o){return l[l.length-1].split(":")[1]}const{width:h,height:c,minX:u,minY:g}=e.getBBox(),d=Math.sqrt(h*h+c*c)/2,f=i.createRadialGradient(u+h*r,g+c*a,o*d,u+h/2,g+c/2,d);return Yt(l,f),f}(t,e,i)}catch(t){console.error("error in parsing gradient string, please check if there are any extra whitespaces."),console.error(t)}return t}};const Nt={stroke:"strokeStyle",fill:"fillStyle",opacity:"globalAlpha"},Bt=["fillStyle","font","globalAlpha","lineCap","lineWidth","lineJoin","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline","lineDash","shadow"],Xt=["circle","sector","polygon","rect","polyline"];var Lt=class{_initProperties(){this._attrs={zIndex:0,visible:!0,destroyed:!1}}constructor(t){this._initProperties(),T.mix(this._attrs,t);const e=this._attrs.attrs;e&&this.initAttrs(e),this.initTransform()}get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}isGroup(){return this.get("isGroup")}isShape(){return this.get("isShape")}initAttrs(t){this.attr(T.mix(this.getDefaultAttrs(),t))}getDefaultAttrs(){return{}}_setAttr(t,e){const i=this._attrs.attrs;if("clip"===t)e=this._setAttrClip(e);else{const n=Nt[t];n&&(i[n]=e)}i[t]=e}_getAttr(t){return this._attrs.attrs[t]}_setAttrClip(t){return t&&Xt.indexOf(t._attrs.type)>-1?(null===t.get("canvas")&&(t=Object.assign({},t)),t.set("parent",this.get("parent")),t.set("context",this.get("context")),t):null}attr(t,e){const i=this;if(i.get("destroyed"))return null;const n=arguments.length;if(0===n)return i._attrs.attrs;if(T.isObject(t)){this._attrs.bbox=null;for(const e in t)i._setAttr(e,t[e]);return i._afterAttrsSet&&i._afterAttrsSet(),i}return 2===n?(this._attrs.bbox=null,i._setAttr(t,e),i._afterAttrsSet&&i._afterAttrsSet(),i):i._getAttr(t)}getParent(){return this.get("parent")}draw(t){this.get("destroyed")||this.get("visible")&&(this.setContext(t),this.drawInner(t),this.restoreContext(t))}setContext(t){const e=this._attrs.attrs.clip;t.save(),e&&(e.resetTransform(t),e.createPath(t),t.clip()),this.resetContext(t),this.resetTransform(t)}restoreContext(t){t.restore()}resetContext(t){const e=this._attrs.attrs;if(!this._attrs.isGroup)for(const i in e)if(Bt.indexOf(i)>-1){let n=e[i];"fillStyle"!==i&&"strokeStyle"!==i||(n=Ft.parseStyle(n,this,t)),"lineDash"===i&&t.setLineDash&&T.isArray(n)?t.setLineDash(n):t[i]=n}}hasFill(){return this.get("canFill")&&this._attrs.attrs.fillStyle}hasStroke(){return this.get("canStroke")&&this._attrs.attrs.strokeStyle}drawInner(){}show(){return this.set("visible",!0),this}hide(){return this.set("visible",!1),this}isVisible(){return this.get("visible")}_removeFromParent(){const t=this.get("parent");if(t){const e=t.get("children");T.Array.remove(e,this)}return this}remove(t){t?this.destroy():this._removeFromParent()}destroy(){if(this.get("destroyed"))return null;this._removeFromParent(),this._attrs={},this.set("destroyed",!0)}getBBox(){return{minX:0,maxX:0,minY:0,maxY:0,width:0,height:0}}initTransform(){const t=this._attrs.attrs||{};t.matrix||(t.matrix=[1,0,0,1,0,0]),this._attrs.attrs=t}getMatrix(){return this._attrs.attrs.matrix}setMatrix(t){this._attrs.attrs.matrix=[t[0],t[1],t[2],t[3],t[4],t[5]]}transform(t){const e=this._attrs.attrs.matrix;return this._attrs.attrs.matrix=N.transform(e,t),this}setTransform(t){return this._attrs.attrs.matrix=[1,0,0,1,0,0],this.transform(t)}translate(t,e){const i=this._attrs.attrs.matrix;N.translate(i,i,[t,e])}rotate(t){const e=this._attrs.attrs.matrix;N.rotate(e,e,t)}scale(t,e){const i=this._attrs.attrs.matrix;N.scale(i,i,[t,e])}moveTo(t,e){const i=this._attrs.x||0,n=this._attrs.y||0;this.translate(t-i,e-n),this.set("x",t),this.set("y",e)}apply(t){const e=this._attrs.attrs.matrix;return B.transformMat2d(t,t,e),this}resetTransform(t){const e=this._attrs.attrs.matrix;var i;(1!==(i=e)[0]||0!==i[1]||0!==i[2]||1!==i[3]||0!==i[4]||0!==i[5])&&t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}isDestroyed(){return this.get("destroyed")}};var zt=class extends Lt{_initProperties(){this._attrs={zIndex:0,visible:!0,destroyed:!1,isShape:!0,attrs:{}}}getType(){return this._attrs.type}drawInner(t){const e=this.get("attrs");this.createPath(t);const i=t.globalAlpha;if(this.hasFill()){const n=e.fillOpacity;T.isNil(n)||1===n?t.fill():(t.globalAlpha=n,t.fill(),t.globalAlpha=i)}if(this.hasStroke()){if(e.lineWidth>0){const i=e.strokeOpacity;T.isNil(i)||1===i||(t.globalAlpha=i),t.stroke()}}}getBBox(){let t=this._attrs.bbox;return t||(t=this.calculateBox(),t&&(t.x=t.minX,t.y=t.minY,t.width=t.maxX-t.minX,t.height=t.maxY-t.minY),this._attrs.bbox=t),t}calculateBox(){return null}createPath(){}};const Rt={};var jt={getGroupClass(){},getChildren(){return this.get("children")},addShape(t,e={}){const i=this.get("canvas");let n=Rt[t];n||(n=T.upperFirst(t),Rt[t]=n),e.canvas=i,"Text"===n&&i&&i.get("fontFamily")&&(e.attrs.fontFamily=e.attrs.fontFamily||i.get("fontFamily"));const s=new zt[n](e);return this.add(s),s},addGroup(t){const e=this.get("canvas"),i=this.getGroupClass();(t=T.mix({},t)).canvas=e,t.parent=this;const n=new i(t);return this.add(n),n},contain(t){return this.get("children").indexOf(t)>-1},sort(){const t=this.get("children");for(let e=0,i=t.length;e<i;e++){t[e]._INDEX=e}return t.sort(function(t){return function(e,i){const n=t(e,i);return 0===n?e._INDEX-i._INDEX:n}}((function(t,e){return t.get("zIndex")-e.get("zIndex")}))),this},clear(){const t=this.get("children");for(;0!==t.length;)t[t.length-1].remove(!0);return this},add(t){const e=this,i=e.get("children");T.isArray(t)||(t=[t]);for(let n=0,s=t.length;n<s;n++){const s=t[n],r=s.get("parent");if(r){const t=r.get("children");T.Array.remove(t,s)}e._setEvn(s),i.push(s)}return e},_setEvn(t){const e=this;t._attrs.parent=e,t._attrs.context=e._attrs.context,t._attrs.canvas=e._attrs.canvas;const i=t._attrs.attrs.clip;if(i&&(i.set("parent",e),i.set("context",e.get("context"))),t._attrs.isGroup){const e=t._attrs.children;for(let i=0,n=e.length;i<n;i++)t._setEvn(e[i])}}};class Gt extends Lt{_initProperties(){this._attrs={zIndex:0,visible:!0,destroyed:!1,isGroup:!0,children:[]}}drawInner(t){const e=this.get("children");for(let i=0,n=e.length;i<n;i++){e[i].draw(t)}return this}getBBox(){let t=1/0,e=-1/0,i=1/0,n=-1/0;const s=this.get("children");for(let r=0,a=s.length;r<a;r++){const a=s[r];if(a.get("visible")){const s=a.getBBox();if(!s)continue;const r=[s.minX,s.minY],o=[s.minX,s.maxY],l=[s.maxX,s.minY],h=[s.maxX,s.maxY],c=a.attr("matrix");B.transformMat2d(r,r,c),B.transformMat2d(o,o,c),B.transformMat2d(l,l,c),B.transformMat2d(h,h,c),t=Math.min(r[0],o[0],l[0],h[0],t),e=Math.max(r[0],o[0],l[0],h[0],e),i=Math.min(r[1],o[1],l[1],h[1],i),n=Math.max(r[1],o[1],l[1],h[1],n)}}return{minX:t,minY:i,maxX:e,maxY:n,x:t,y:i,width:e-t,height:n-i}}destroy(){this.get("destroyed")||(this.clear(),super.destroy())}}T.mix(Gt.prototype,jt,{getGroupClass:()=>Gt});var Wt=Gt,Ht={requestAnimationFrame:"object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:function(t){return setTimeout(t,16)}};const Vt=(t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},qt=(t,e)=>{const i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.sqrt(i*i+n*n)},Ut=(t,e)=>{if(!t)return;const i=[],n=t.length;for(let s=0;s<n;s++){const n=t[s],{x:r,y:a,clientX:o,clientY:l}=n;let h;h=g(r)||g(a)?{x:r,y:a}:M({x:o,y:l},e),i.push(h)}return i};class Zt{constructor({canvas:t,el:e}){this.canvas=t,this.delegateEvent(e),this.processEvent={}}delegateEvent(t){t.addEventListener("click",this._click),t.addEventListener("touchstart",this._start),t.addEventListener("touchmove",this._move),t.addEventListener("touchend",this._end),t.addEventListener("touchcancel",this._cancel)}emitEvent(t,e){this.canvas.emit(t,e)}_click=t=>{this.emitEvent("click",t)};_start=t=>{const e=Ut(t.touches,this.canvas);var i,n;e&&(t.points=e,this.emitEvent("touchstart",t),this.reset(),this.startTime=Date.now(),this.startPoints=e,e.length>1?(this.startDistance=qt(e[0],e[1]),this.center=(i=e[0],n=e[1],{x:i.x+(n.x-i.x)/2,y:i.y+(n.y-i.y)/2})):this.pressTimeout=setTimeout(()=>{t.direction="none",this.emitStart("press",t),this.emitEvent("press",t),this.eventType="press"},250))};_move=t=>{const e=Ut(t.touches,this.canvas);if(!e)return;this.clearPressTimeout(),t.points=e,this.emitEvent("touchmove",t);const i=this.startPoints;if(i)if(e.length>1){const i=this.startDistance,n=qt(e[0],e[1]);t.zoom=n/i,t.center=this.center,this.emitStart("pinch",t),this.emitEvent("pinch",t)}else{const n=e[0].x-i[0].x,s=e[0].y-i[0].y,r=this.direction||Vt(i[0],e[0]);this.direction=r;const a=this.getEventType(e);t.direction=r,t.deltaX=n,t.deltaY=s,this.emitStart(a,t),this.emitEvent(a,t);const o=this.lastMoveTime,l=Date.now();l-o>0&&(this.prevMoveTime=o,this.prevMovePoints=this.lastMovePoints,this.lastMoveTime=l,this.lastMovePoints=e)}};_end=t=>{this.emitEnd(t),this.emitEvent("touchend",t);const e=this.lastMoveTime;if(Date.now()-e<100){const i=e-(this.prevMoveTime||this.startTime);if(i>0){const e=this.prevMovePoints||this.startPoints,n=this.lastMovePoints,s=qt(e[0],n[0])/i;s>.3&&(t.velocity=s,t.direction=Vt(e[0],n[0]),this.emitEvent("swipe",t))}}this.reset();const i=t.touches;i&&i.length>0&&this._start(t)};_cancel=t=>{this.emitEvent("touchcancel",t),this.reset()};getEventType(t){const{eventType:e,canvas:i,startTime:n,startPoints:s}=this;if(e)return e;let r;const a=i.__events.pan;if(a&&a.length){r=Date.now()-n>250&&qt(s[0],t[0])<10?"press":"pan"}else r="press";return this.eventType=r,r}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}emitStart(t,e){this.isProcess(t)||(this.enable(t),this.emitEvent(t+"start",e))}emitEnd(t){const e=this.processEvent;Object.keys(e).forEach(i=>{this.emitEvent(i+"end",t),delete e[i]})}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=0)}reset(){this.clearPressTimeout(),this.startTime=0,this.startPoints=null,this.startDistance=0,this.direction=null,this.eventType=null,this.pinch=!1,this.prevMoveTime=0,this.prevMovePoints=null,this.lastMoveTime=0,this.lastMovePoints=null}}class $t extends I{constructor(t){super(),this.context=t,this.width=0,this.height=0,this.style={},this.currentStyle={},this.isCanvasElement=!0}getContext(){return this.context}getBoundingClientRect(){return{top:0,right:this.width,bottom:this.height,left:0}}addEventListener(t,e){this.on(t,e)}removeEventListener(t,e){this.off(t,e)}dispatchEvent(t,e){this.emit(t,e)}}var Jt={create:t=>t?function(t){if(!t)return!1;if(1!==t.nodeType||!t.nodeName||"canvas"!==t.nodeName.toLowerCase())return!1;let e=!1;try{t.addEventListener("eventTest",()=>{e=!0}),t.dispatchEvent(new Event("eventTest"))}catch(t){e=!1}return e}(t.canvas)?t.canvas:new $t(t):null};const{requestAnimationFrame:Kt}=Ht;class Qt extends I{get(t){return this._attrs[t]}set(t,e){this._attrs[t]=e}constructor(t){super(),this._attrs=T.mix({type:"canvas",children:[]},t),this._initPixelRatio(),this._initCanvas()}_initPixelRatio(){this.get("pixelRatio")||this.set("pixelRatio",T.getPixelRatio())}beforeDraw(){const t=this._attrs.context,e=this._attrs.el;t&&t.clearRect&&t.clearRect(0,0,e.width,e.height)}_initCanvas(){const t=this.get("el"),e=this.get("context");if(!t&&!e)throw new Error("Please specify the id, el or context of the chart!");let i;i=t?T.isString(t)?T.getDomById(t):t:Jt.create(e),e&&i&&!i.getContext&&(i.getContext=function(){return e});let n=this.get("width");n||(n=T.getWidth(i));let s=this.get("height");s||(s=T.getHeight(i)),this.set("canvas",this),this.set("el",i),this.set("context",e||i.getContext("2d")),this.changeSize(n,s);const r=new Zt({canvas:this,el:i});this.set("eventController",r)}changeSize(t,e){const i=this.get("pixelRatio"),n=this.get("el");if(n.style&&(n.style.width=t+"px",n.style.height=e+"px"),T.isCanvasElement(n)&&(n.width=t*i,n.height=e*i,1!==i)){this.get("context").scale(i,i)}this.set("width",t),this.set("height",e)}getWidth(){const t=this.get("pixelRatio");return this.get("width")*t}getHeight(){const t=this.get("pixelRatio");return this.get("height")*t}getPointByClient(t,e){const i=this.get("el"),n=i.getBoundingClientRect(),s=n.right-n.left,r=n.bottom-n.top;return{x:(t-n.left)*(i.width/s),y:(e-n.top)*(i.height/r)}}_beginDraw(){this._attrs.toDraw=!0}_endDraw(){this._attrs.toDraw=!1}draw(){const t=this;t.get("destroyed")||(t.get("animateHandler")?this._beginDraw():function e(){t.set("animateHandler",Kt(()=>{t.set("animateHandler",void 0),t.get("toDraw")&&e()})),t.beforeDraw();try{const e=t._attrs.context,i=t._attrs.children;for(let t=0,n=i.length;t<n;t++){i[t].draw(e)}e.draw&&e.draw()}catch(e){console.warn("error in draw canvas, detail as:"),console.warn(e),t._endDraw()}t._endDraw()}())}destroy(){if(this.get("destroyed"))return;const t=this.get("el");t.width=0,t.height=0,this.clear(),this._attrs={},this.set("destroyed",!0)}isDestroyed(){return this.get("destroyed")}}T.mix(Qt.prototype,jt,{getGroupClass:()=>Wt});zt.Rect=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="rect"}getDefaultAttrs(){return{x:0,y:0,width:0,height:0,radius:0,lineWidth:0}}createPath(t){const e=this.get("attrs"),{x:i,y:n,width:s,height:r}=e;t.beginPath();let a=e.radius;a&&s*r?(a=T.parsePadding(a),t.moveTo(i+a[0],n),t.lineTo(i+s-a[1],n),t.arc(i+s-a[1],n+a[1],a[1],-Math.PI/2,0,!1),t.lineTo(i+s,n+r-a[2]),t.arc(i+s-a[2],n+r-a[2],a[2],0,Math.PI/2,!1),t.lineTo(i+a[3],n+r),t.arc(i+a[3],n+r-a[3],a[3],Math.PI/2,Math.PI,!1),t.lineTo(i,n+a[0]),t.arc(i+a[0],n+a[0],a[0],Math.PI,3*Math.PI/2,!1),t.closePath()):t.rect(i,n,s,r)}calculateBox(){const t=this.get("attrs"),{x:e,y:i,width:n,height:s}=t;return{minX:e,minY:i,maxX:e+n,maxY:i+s}}};zt.Circle=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="circle"}getDefaultAttrs(){return{x:0,y:0,r:0,lineWidth:0}}createPath(t){const e=this.get("attrs"),{x:i,y:n,r:s}=e;t.beginPath(),t.arc(i,n,s,0,2*Math.PI,!1),t.closePath()}calculateBox(){const t=this.get("attrs"),{x:e,y:i,r:n}=t;return{minX:e-n,maxX:e+n,minY:i-n,maxY:i+n}}};const te=B.create(),ee=B.create(),ie=B.create();function ne(t,e,i,n,s){const r=t*t;return e+(3*-e+t*(3*e-e*t))*t+(3*i+t*(-6*i+3*i*t))*t+(3*n-3*n*t)*r+s*(r*t)}function se(t){let e=1/0,i=-1/0,n=1/0,s=-1/0;const r={x:t[0],y:t[1]},a={x:t[2],y:t[3]},o={x:t[4],y:t[5]},l={x:t[6],y:t[7]};for(let t=0;t<100;t++){const f={x:ne(d=t/100,(h=r).x,(c=a).x,(u=o).x,(g=l).x),y:ne(d,h.y,c.y,u.y,g.y)};f.x<e&&(e=f.x),f.x>i&&(i=f.x),f.y<n&&(n=f.y),f.y>s&&(s=f.y)}var h,c,u,g,d;return{minX:e,minY:n,maxX:i,maxY:s}}var re={getBBoxFromPoints(t,e){if(0===t.length)return;let i=t[0],n=i.x,s=i.x,r=i.y,a=i.y;const o=t.length;for(let e=1;e<o;e++)i=t[e],n=Math.min(n,i.x),s=Math.max(s,i.x),r=Math.min(r,i.y),a=Math.max(a,i.y);return{minX:n-(e=e/2||0),minY:r-e,maxX:s+e,maxY:a+e}},getBBoxFromLine:(t,e,i,n,s)=>(s=s/2||0,{minX:Math.min(t,i)-s,minY:Math.min(e,n)-s,maxX:Math.max(t,i)+s,maxY:Math.max(e,n)+s}),getBBoxFromArc(t,e,i,n,s,r){const a=Math.abs(n-s);if(a%(2*Math.PI)<1e-4&&a>1e-4)return{minX:t-i,minY:e-i,maxX:t+i,maxY:e+i};te[0]=Math.cos(n)*i+t,te[1]=Math.sin(n)*i+e,ee[0]=Math.cos(s)*i+t,ee[1]=Math.sin(s)*i+e;const o=[0,0],l=[0,0];if(B.min(o,te,ee),B.max(l,te,ee),(n%=2*Math.PI)<0&&(n+=2*Math.PI),(s%=2*Math.PI)<0&&(s+=2*Math.PI),n>s&&!r?s+=2*Math.PI:n<s&&r&&(n+=2*Math.PI),r){const t=s;s=n,n=t}for(let r=0;r<s;r+=Math.PI/2)r>n&&(ie[0]=Math.cos(r)*i+t,ie[1]=Math.sin(r)*i+e,B.min(o,ie,o),B.max(l,ie,l));return{minX:o[0],minY:o[1],maxX:l[0],maxY:l[1]}},getBBoxFromBezierGroup(t,e){let i=1/0,n=-1/0,s=1/0,r=-1/0;for(let e=0,a=t.length;e<a;e++){const a=se(t[e]);a.minX<i&&(i=a.minX),a.maxX>n&&(n=a.maxX),a.minY<s&&(s=a.minY),a.maxY>r&&(r=a.maxY)}return{minX:i-(e=e/2||0),minY:s-e,maxX:n+e,maxY:r+e}}};zt.Line=class extends zt{_initProperties(){super._initProperties(),this._attrs.canStroke=!0,this._attrs.type="line"}getDefaultAttrs(){return{x1:0,y1:0,x2:0,y2:0,lineWidth:1}}createPath(t){const e=this.get("attrs"),{x1:i,y1:n,x2:s,y2:r}=e;t.beginPath(),t.moveTo(i,n),t.lineTo(s,r)}calculateBox(){const t=this.get("attrs"),{x1:e,y1:i,x2:n,y2:s,lineWidth:r}=t;return re.getBBoxFromLine(e,i,n,s,r)}};function ae(t){return[t.x,t.y]}zt.Polygon=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="polygon"}getDefaultAttrs(){return{points:null,lineWidth:0}}createPath(t){const e=this.get("attrs").points;t.beginPath();for(let i=0,n=e.length;i<n;i++){const n=e[i];0===i?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y)}t.closePath()}calculateBox(){const t=this.get("attrs"),{points:e}=t;return re.getBBoxFromPoints(e)}};var oe={smooth:function(t,e,i){const n=!!e,s=function(t,e,i,n){const s=[];let r,a;const o=!!n;let l,h,c,u,g,d;if(o){for(l=[1/0,1/0],h=[-1/0,-1/0],d=0,g=t.length;d<g;d++)c=ae(t[d]),B.min(l,l,c),B.max(h,h,c);B.min(l,l,n[0]),B.max(h,h,n[1])}for(d=0,u=t.length;d<u;d++){if(c=ae(t[d]),i)r=ae(t[d?d-1:u-1]),a=ae(t[(d+1)%u]);else{if(0===d||d===u-1){s.push([c[0],c[1]]);continue}r=ae(t[d-1]),a=ae(t[d+1])}const n=B.sub([],a,r);B.scale(n,n,e);let g=B.distance(c,r),f=B.distance(c,a);const p=g+f;0!==p&&(g/=p,f/=p);const m=B.scale([],n,-g),x=B.scale([],n,f),y=B.add([],c,m),v=B.add([],c,x);o&&(B.max(y,y,l),B.min(y,y,h),B.max(v,v,l),B.min(v,v,h)),s.push([y[0],y[1]]),s.push([v[0],v[1]])}return i&&s.push(s.shift()),s}(t,.4,n,i),r=t.length,a=[];let o,l,h;for(let e=0;e<r-1;e++)o=s[2*e],l=s[2*e+1],h=t[e+1],a.push(["C",o[0],o[1],l[0],l[1],h.x,h.y]);return n&&(o=s[r],l=s[r+1],h=t[0],a.push(["C",o[0],o[1],l[0],l[1],h.x,h.y])),a}};function le(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];isNaN(n.x)||isNaN(n.y)||e.push(n)}return e}zt.Polyline=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="polyline"}getDefaultAttrs(){return{points:null,lineWidth:1,smooth:!1}}createPath(t){const e=this.get("attrs"),{points:i,smooth:n}=e,s=le(i);if(t.beginPath(),s.length)if(t.moveTo(s[0].x,s[0].y),n){const e=[[0,0],[1,1]],i=oe.smooth(s,!1,e);for(let e=0,n=i.length;e<n;e++){const n=i[e];t.bezierCurveTo(n[1],n[2],n[3],n[4],n[5],n[6])}}else{let e,i;for(e=1,i=s.length-1;e<i;e++)t.lineTo(s[e].x,s[e].y);t.lineTo(s[i].x,s[i].y)}}calculateBox(){const t=this.get("attrs"),{points:e,smooth:i,lineWidth:n}=t,s=le(e);if(i){const t=[],e=[[0,0],[1,1]],i=oe.smooth(s,!1,e);for(let e=0,n=i.length;e<n;e++){const n=i[e];if(0===e)t.push([s[0].x,s[0].y,n[1],n[2],n[3],n[4],n[5],n[6]]);else{const s=i[e-1];t.push([s[5],s[6],n[1],n[2],n[3],n[4],n[5],n[6]])}}return re.getBBoxFromBezierGroup(t,n)}return re.getBBoxFromPoints(s,n)}};zt.Arc=class extends zt{_initProperties(){super._initProperties(),this._attrs.canStroke=!0,this._attrs.canFill=!0,this._attrs.type="arc"}getDefaultAttrs(){return{x:0,y:0,r:0,startAngle:0,endAngle:2*Math.PI,anticlockwise:!1,lineWidth:1}}createPath(t){const e=this.get("attrs"),{x:i,y:n,r:s,startAngle:r,endAngle:a,anticlockwise:o}=e;t.beginPath(),r!==a&&t.arc(i,n,s,r,a,o)}calculateBox(){const t=this.get("attrs"),{x:e,y:i,r:n,startAngle:s,endAngle:r,anticlockwise:a}=t;return re.getBBoxFromArc(e,i,n,s,r,a)}};zt.Sector=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="sector"}getDefaultAttrs(){return{x:0,y:0,lineWidth:0,r:0,r0:0,startAngle:0,endAngle:2*Math.PI,anticlockwise:!1}}createPath(t){const e=this.get("attrs"),{x:i,y:n,startAngle:s,endAngle:r,r:a,r0:o,anticlockwise:l}=e;t.beginPath();const h=Math.cos(s),c=Math.sin(s);t.moveTo(h*o+i,c*o+n),t.lineTo(h*a+i,c*a+n),(Math.abs(r-s)>1e-4||0===s&&r<0)&&(t.arc(i,n,a,s,r,l),t.lineTo(Math.cos(r)*o+i,Math.sin(r)*o+n),0!==o&&t.arc(i,n,o,r,s,!l)),t.closePath()}calculateBox(){const t=this.get("attrs"),{x:e,y:i,r:n,r0:s,startAngle:r,endAngle:a,anticlockwise:o}=t,l=re.getBBoxFromArc(e,i,n,r,a,o),h=re.getBBoxFromArc(e,i,s,r,a,o);return{minX:Math.min(l.minX,h.minX),minY:Math.min(l.minY,h.minY),maxX:Math.max(l.maxX,h.maxX),maxY:Math.max(l.maxY,h.maxY)}}};var he={calcRotatedBox({width:t,height:e,rotate:i}){const n=Math.abs(i);return{width:Math.abs(t*Math.cos(n)+e*Math.sin(n)),height:Math.abs(e*Math.cos(n)+t*Math.sin(n))}}};let ce=0,ue={};zt.Text=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="text"}getDefaultAttrs(){return{lineWidth:0,lineCount:1,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom",lineHeight:null,textArr:null}}_getFontStyle(){const t=this._attrs.attrs,{fontSize:e,fontFamily:i,fontWeight:n,fontStyle:s,fontVariant:r}=t;return`${s} ${r} ${n} ${e}px ${i}`}_afterAttrsSet(){const t=this._attrs.attrs;if(t.font=this._getFontStyle(),t.text){const e=t.text;let i=null,n=1;T.isString(e)&&-1!==e.indexOf("\n")&&(i=e.split("\n"),n=i.length),t.lineCount=n,t.textArr=i}this.set("attrs",t)}_getTextHeight(){const t=this._attrs.attrs;if(t.height)return t.height;const e=t.lineCount,i=1*t.fontSize;if(e>1){return i*e+this._getSpaceingY()*(e-1)}return i}_getSpaceingY(){const t=this._attrs.attrs,e=t.lineHeight,i=1*t.fontSize;return e?e-i:.14*i}drawInner(t){const e=this,i=e._attrs.attrs,n=i.text;let s=i.x,r=i.y;if(T.isNil(n)||isNaN(s)||isNaN(r))return;const a=i.textArr,o=1*i.fontSize,l=e._getSpaceingY();i.rotate&&(t.translate(s,r),t.rotate(i.rotate),s=0,r=0);const h=i.textBaseline;let c,u;if(a&&(c=e._getTextHeight()),e.hasFill()){const e=i.fillOpacity;if(T.isNil(e)||1===e||(t.globalAlpha=e),a)for(let e=0,i=a.length;e<i;e++){const i=a[e];u=r+e*(l+o)-c+o,"middle"===h&&(u+=c-o-(c-o)/2),"top"===h&&(u+=c-o),t.fillText(i,s,u)}else t.fillText(n,s,r)}if(e.hasStroke())if(a)for(let e=0,i=a.length;e<i;e++){const i=a[e];u=r+e*(l+o)-c+o,"middle"===h&&(u+=c-o-(c-o)/2),"top"===h&&(u+=c-o),t.strokeText(i,s,u)}else t.strokeText(n,s,r)}calculateBox(){const t=this._attrs.attrs,{x:e,y:i,textAlign:n,textBaseline:s}=t;let r=this._getTextWidth();if(!r)return{minX:e,minY:i,maxX:e,maxY:i};let a=this._getTextHeight();if(t.rotate){const e=he.calcRotatedBox({width:r,height:a,rotate:t.rotate});r=e.width,a=e.height}const o={x:e,y:i-a};return n&&("end"===n||"right"===n?o.x-=r:"center"===n&&(o.x-=r/2)),s&&("top"===s?o.y+=a:"middle"===s&&(o.y+=a/2)),{minX:o.x,minY:o.y,maxX:o.x+r,maxY:o.y+a}}_getTextWidth(){const t=this._attrs.attrs;if(t.width)return t.width;const e=t.text,i=this.get("context");if(T.isNil(e))return;const n=t.font,s=t.textArr,r=e+""+n;if(ue[r])return ue[r];let a=0;if(s)for(let t=0,e=s.length;t<e;t++){const e=s[t];a=Math.max(a,T.measureText(e,n,i).width)}else a=T.measureText(e,n,i).width;return ce>5e3&&(ce=0,ue={}),ce++,ue[r]=a,a}};zt.Custom=class extends zt{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.createPath=null,this._attrs.type="custom"}createPath(t){const e=this.get("createPath");e&&e.call(this,t)}calculateBox(){const t=this.get("calculateBox");return t&&t.call(this)}};var ge={Canvas:Qt,Group:Wt,Shape:zt,Matrix:N,Vector2:B};const{Shape:de}=ge;var fe=class{constructor(t){this.axisCfg={},this.frontPlot=null,this.backPlot=null,this.axes={},T.mix(this,t)}_isHide(t){const e=this.axisCfg;return!e||!1===e[t]}_getLinePosition(t,e,i,n){let s="";const r=t.field,a=this.axisCfg;return a[r]&&a[r].position?s=a[r].position:"x"===e?s=n?"left":"bottom":"y"===e&&(s=i?"right":"left",n&&(s="bottom")),s}_getLineCfg(t,e,i){let n,s,r=1;return"x"===e?(n={x:0,y:0},s={x:1,y:0}):"right"===i?(n={x:1,y:0},s={x:1,y:1}):(n={x:0,y:0},s={x:0,y:1},r=-1),t.transposed&&(r*=-1),{offsetFactor:r,start:t.convertPoint(n),end:t.convertPoint(s)}}_getCircleCfg(t){return{startAngle:t.startAngle,endAngle:t.endAngle,center:t.center,radius:t.circleRadius}}_getRadiusCfg(t){let e,i;return t.transposed?(e={x:0,y:0},i={x:1,y:0}):(e={x:0,y:0},i={x:0,y:1}),{offsetFactor:-1,start:t.convertPoint(e),end:t.convertPoint(i)}}_getAxisCfg(t,e,i,n,s){const r=this,a=this.axisCfg,o=e.getTicks(),l=T.deepMix({ticks:o,frontContainer:this.frontPlot,backContainer:this.backPlot},s,a[e.field]),h=[],c=l.label,u=o.length;let g=0,d=0,f=c;return T.each(o,(t,e)=>{if(T.isFunction(c)){const i=c(t.text,e,u);f=i?T.mix({},E._defaultAxis.label,i):null}if(f){const e={};f.textAlign&&(e.textAlign=f.textAlign),f.textBaseline&&(e.textBaseline=f.textBaseline);const i=new de.Text({className:"axis-label",attrs:T.mix({x:0,y:0,text:t.text,fontFamily:r.chart.get("canvas").get("fontFamily")},f),value:t.value,textStyle:e,top:f.top,context:r.chart.get("canvas").get("context")});h.push(i);const{width:n,height:s}=i.getBBox();g=Math.max(g,n),d=Math.max(d,s)}}),l.labels=h,l.maxWidth=g,l.maxHeight=d,l}_createAxis(t,e,i,n,s=""){const r=this,a=t.type,o=t.transposed;let l,h,c;if("cartesian"===a||"rect"===a){const t=r._getLinePosition(e,n,s,o);c=E.axis[t],c.position=t,l="Line",h=t}else"x"===n&&!o||"y"===n&&o?(c=E.axis.circle,l="Circle",h="circle"):(c=E.axis.radius,l="Line",h="radius");const u=r._getAxisCfg(t,e,i,n,c);u.type=l,u.dimType=n,u.verticalScale=i,u.index=s,this.axes[h]=u}createAxis(t,e,i){const n=this;e&&!n._isHide(e.field)&&n._createAxis(t,e,i[0],"x"),T.each(i,(function(i,s){n._isHide(i.field)||n._createAxis(t,i,e,"y",s)}));const s=this.axes,r=n.chart;if(r._isAutoPadding()){const e=T.parsePadding(r.get("padding")),i=T.parsePadding(r.get("appendPadding")),n=r.get("legendRange")||{top:0,right:0,bottom:0,left:0},a=["auto"===e[0]?n.top+2*i[0]:e[0],"auto"===e[1]?n.right+i[1]:e[1],"auto"===e[2]?n.bottom+i[2]:e[2],"auto"===e[3]?n.left+i[3]:e[3]];if(t.isPolar){const t=s.circle;if(t){const{maxHeight:e,maxWidth:i,labelOffset:n}=t;a[0]+=e+n,a[1]+=i+n,a[2]+=e+n,a[3]+=i+n}}else{if(s.right&&"auto"===e[1]){const{maxWidth:t,labelOffset:e}=s.right;a[1]+=t+e}if(s.left&&"auto"===e[3]){const{maxWidth:t,labelOffset:e}=s.left;a[3]+=t+e}if(s.bottom&&"auto"===e[2]){const{maxHeight:t,labelOffset:e}=s.bottom;a[2]+=t+e}}r.set("_padding",a),r._updateLayout(a)}T.each(s,e=>{const{type:i,grid:s,verticalScale:r,ticks:a,dimType:o,position:l,index:h}=e;let c;if(t.isPolar?"Line"===i?c=n._getRadiusCfg(t):"Circle"===i&&(c=n._getCircleCfg(t)):c=n._getLineCfg(t,o,l),s&&r){const i=[],n=function(t){const e=t.slice(0);if(e.length>0){const t=e[0],i=e[e.length-1];0!==t.value&&e.unshift({value:0}),1!==i.value&&e.push({value:1})}return e}(r.getTicks());T.each(a,e=>{const s=[];T.each(n,i=>{const n="x"===o?e.value:i.value,r="x"===o?i.value:e.value;if(n>=0&&n<=1&&r>=0&&r<=1){const e=t.convertPoint({x:n,y:r});s.push(e)}}),i.push({points:s,_id:"axis-"+o+h+"-grid-"+e.tickValue})}),e.gridPoints=i,t.isPolar&&(e.center=t.center,e.startAngle=t.startAngle,e.endAngle=t.endAngle)}c._id="axis-"+o,T.isNil(h)||(c._id="axis-"+o+h),new Ot[i](T.mix(e,c))})}clear(){this.axes={},this.frontPlot.clear(),this.backPlot.clear()}};const{Shape:pe}=ge;var me=Object.freeze({__proto__:null,getClip:function(t){const e=t.start,i=t.end,n=i.x-e.x,s=Math.abs(i.y-e.y);let r;if(t.isPolar){const{circleRadius:e,center:i,startAngle:n,endAngle:s}=t;r=new pe.Sector({attrs:{x:i.x,y:i.y,r:e,r0:0,startAngle:n,endAngle:s}})}else r=new pe.Rect({attrs:{x:e.x,y:i.y-10,width:n,height:s+20}});return r.isClip=!0,r},isPointInPlot:function(t,e){const{x:i,y:n}=t,{tl:s,tr:r,br:a}=e;return i>=s.x&&i<=r.x&&n>=s.y&&n<=a.y}});const{Canvas:xe}=ge;function ye(t,e){return t-e}class ve extends O{static initPlugins(){return{_plugins:[],_cacheId:0,register(t){const e=this._plugins;[].concat(t).forEach(t=>{-1===e.indexOf(t)&&e.push(t)}),this._cacheId++},unregister(t){const e=this._plugins;[].concat(t).forEach(t=>{const i=e.indexOf(t);-1!==i&&e.splice(i,1)}),this._cacheId++},clear(){this._plugins=[],this._cacheId++},count(){return this._plugins.length},getAll(){return this._plugins},notify(t,e,i){const n=this.descriptors(t),s=n.length;let r,a,o,l,h;for(r=0;r<s;++r)if(a=n[r],o=a.plugin,h=o[e],"function"==typeof h&&(l=[t].concat(i||[]),!1===h.apply(o,l)))return!1;return!0},descriptors(t){const e=t._plugins||(t._plugins={});if(e.id===this._cacheId)return e.descriptors;const i=[],n=[];return this._plugins.concat(t&&t.get("plugins")||[]).forEach(t=>{-1===i.indexOf(t)&&(i.push(t),n.push({plugin:t}))}),e.descriptors=n,e.id=this._cacheId,n}}}getDefaultCfg(){return{id:null,rendered:!1,padding:E.padding,data:null,scales:{},geoms:[],colDefs:null,pixelRatio:E.pixelRatio,filters:null,appendPadding:E.appendPadding}}_syncYScales(){if(!this.get("syncY"))return;const t=this.get("geoms"),e=[];let i=[],n=[];T.each(t,t=>{const s=t.getYScale();s.isLinear&&(e.push(s),i.push(s.min),n.push(s.max))}),i=Math.min.apply(null,i),n=Math.max.apply(null,n),T.each(e,t=>{t.change({min:i}),t.change({max:n})})}_getFieldsForLegend(){const t=[],e=this.get("geoms");return T.each(e,e=>{const i=e.get("attrOptions").color;if(i&&i.field&&T.isString(i.field)){const e=i.field.split("*");T.each(e,e=>{-1===t.indexOf(e)&&t.push(e)})}}),t}_getScaleData(t){let e=this.get("data");const i=this.get("filteredData");if(i.length){-1===this._getFieldsForLegend().indexOf(t)&&(e=i)}return e}_adjustScale(){const t=this.get("scaleController"),e=this.get("geoms");for(let i=0;i<e.length;i++){const n=e[i];if("interval"===n.get("type")){const e=n.getYScale();t.adjustStartZero(e)}}}_removeGeoms(){const t=this.get("geoms");for(;t.length>0;){t.shift().destroy()}}_clearGeoms(){const t=this.get("geoms");for(let e=0,i=t.length;e<i;e++){t[e].clear()}}_clearInner(){this._clearGeoms(),ve.plugins.notify(this,"clearInner"),this.get("axisController")&&this.get("axisController").clear()}_initFilteredData(){const t=this.get("filters");let e=this.get("data")||[];t&&(e=e.filter((function(e){let i=!0;return T.each(t,(function(t,n){if(t&&(i=t(e[n],e),!i))return!1})),i}))),this.set("filteredData",e)}_changeGeomsData(){const t=this.get("geoms"),e=this.get("filteredData");for(let i=0,n=t.length;i<n;i++){t[i].changeData(e)}}_initGeom(t){const e=this.get("coord"),i=this.get("filteredData"),n=this.get("colDefs"),s=this.get("middlePlot");t.set("chart",this),t.set("container",s.addGroup()),t.set("data",i),t.set("coord",e),t.set("colDefs",n),t.init(),this.emit("_aftergeominit",t)}_initGeoms(){const t=this.get("geoms");for(let e=0,i=t.length;e<i;e++)this._initGeom(t[e])}_initCoord(){const t=this.get("plotRange"),e=T.mix({type:"cartesian"},this.get("coordCfg"),{plot:t}),i=e.type,n=new(0,R[T.upperFirst(i)])(e);this.set("coord",n)}_initLayout(){let t=this.get("_padding");t||(t=this.get("margin")||this.get("padding"),t=T.parsePadding(t));const e="auto"===t[0]?0:t[0],i="auto"===t[1]?0:t[1],n="auto"===t[2]?0:t[2],s={x:"auto"===t[3]?0:t[3],y:e},r={x:this.get("width")-i,y:this.get("height")-n},a=this.get("plot");if(a)return void a.reset(s,r);const o=new Y({start:s,end:r});this.set("plotRange",o),this.set("plot",o)}_initCanvas(){const t=this;try{const e=new xe({el:t.get("el")||t.get("id"),context:t.get("context"),pixelRatio:t.get("pixelRatio"),width:t.get("width"),height:t.get("height"),fontFamily:E.fontFamily});t.set("canvas",e),t.set("el",e.get("el")),t.set("width",e.get("width")),t.set("height",e.get("height"))}catch(t){throw t}ve.plugins.notify(t,"afterCanvasInit")}_initLayers(){const t=this.get("canvas");this.set("backPlot",t.addGroup()),this.set("middlePlot",t.addGroup({zIndex:10})),this.set("frontPlot",t.addGroup({zIndex:20}))}_initEvents(){this.on("afterdatachange",()=>{this._initFilteredData(),this._changeGeomsData(),this._adjustScale()}),this.on("_aftersizechange",()=>{this._initLayout();const t=this.get("coord");t&&t.reset(this.get("plot"))})}_initScaleController(){const t=new Et({chart:this});this.set("colDefs",t.defs),this.set("scales",t.scales),this.set("scaleController",t)}_clearScaleController(){this.get("scaleController").clear()}_init(){this._initCanvas(),this._initLayout(),this._initLayers(),this._initEvents(),this._initScaleController(),this.set("axisController",new fe({frontPlot:this.get("frontPlot").addGroup({className:"axisContainer"}),backPlot:this.get("backPlot").addGroup({className:"axisContainer"}),chart:this})),ve.plugins.notify(this,"init")}constructor(t){super(t);const e=this;T.each(at,(function(t,i){const n=T.lowerFirst(i);e[n]=function(i){const n=new t(i);return e.addGeom(n),n}})),e._init()}init(){this._initFilteredData(),this._initCoord(),ve.plugins.notify(this,"beforeGeomInit"),this._initGeoms(),this._syncYScales(),this._adjustScale(),this.emit("afterinit")}source(t,e){return this.set("data",t),e&&this.scale(e),this}scale(t,e){return this.get("scaleController").setFieldDef(t,e),this}axis(t,e){const i=this.get("axisController");return t?(i.axisCfg=i.axisCfg||{},i.axisCfg[t]=e):i.axisCfg=null,this}coord(t,e){let i;return T.isObject(t)?i=t:(i=e||{},i.type=t||"cartesian"),this.set("coordCfg",i),this}filter(t,e){const i=this.get("filters")||{};i[t]=e,this.set("filters",i),this.get("rendered")&&this.emit("afterdatachange",this.get("data"))}render(){const t=this.get("rendered"),e=this.get("canvas"),i=this.get("geoms");t||(this.init(),this.set("rendered",!0)),this.emit("beforerender"),ve.plugins.notify(this,"beforeGeomDraw"),this._renderAxis();const n=this.get("middlePlot");if(this.get("limitInPlot")&&!n.attr("clip")){const t=this.get("coord"),e=me.getClip(t);e.set("canvas",n.get("canvas")),n.attr("clip",e)}for(let t=0,e=i.length;t<e;t++){i[t].paint()}return ve.plugins.notify(this,"afterGeomDraw"),e.sort(),this.get("frontPlot").sort(),ve.plugins.notify(this,"beforeCanvasDraw"),e.draw(),this.emit("afterrender"),this}clear(){return ve.plugins.notify(this,"clear"),this._clearInner(),this._removeGeoms(),this._clearScaleController(),this.set("legendItems",null),this.set("filters",null),this.set("isUpdate",!1),this.set("_padding",null),this.set("rendered",!1),this.get("canvas").draw(),this}repaint(){this.get("rendered")&&(this.set("isUpdate",!0),this.set("legendItems",null),ve.plugins.notify(this,"repaint"),this._clearInner(),this.render())}changeData(t){this.emit("beforedatachange",t),this.set("data",t),ve.plugins.notify(this,"changeData"),this.emit("afterdatachange",t),this.set("_padding",null),this.repaint()}changeSize(t,e){return t?this.set("width",t):t=this.get("width"),e?this.set("height",e):e=this.get("height"),this.get("canvas").changeSize(t,e),this.emit("_aftersizechange",{width:t,height:e}),this.repaint(),this}destroy(){this.clear(),this.get("canvas").destroy(),ve.plugins.notify(this,"afterCanvasDestroyed"),this._interactions&&T.each(this._interactions,t=>{t.destroy()}),super.destroy()}getPosition(t){const e=this.get("coord"),i=this.getXScale(),n=this.getYScales()[0],s=i.field,r=i.scale(t[s]),a=n.field,o=n.scale(t[a]);return e.convertPoint({x:r,y:o})}getRecord(t){const e=this.get("coord"),i=this.getXScale(),n=this.getYScales()[0],s=e.invertPoint(t),r={};return r[i.field]=i.invert(s.x),r[n.field]=n.invert(s.y),r}getSnapRecords(t){const e=this.get("geoms")[0];let i=[];return e&&(i=e.getSnapRecords(t)),i}createScale(t){const e=this._getScaleData(t);return this.get("scaleController").createScale(t,e)}addGeom(t){const e=this.get("rendered");this.get("geoms").push(t),e&&this._initGeom(t)}getXScale(){return this.get("geoms")[0].getXScale()}getYScales(){const t=this.get("geoms"),e=[];return T.each(t,(function(t){const i=t.getYScale();-1===e.indexOf(i)&&e.push(i)})),e}getLegendItems(){if(this.get("legendItems"))return this.get("legendItems");const t={},e=[],i=this.get("geoms");return T.each(i,i=>{const n=i.getAttr("color");if(n){const i=n.getScale("color");if(i.isCategory&&!function(t,e){let i=!1;return T.each(t,t=>{const n=[].concat(t.values),s=[].concat(e.values);t.type!==e.type||t.field!==e.field||n.sort(ye).toString()!==s.sort(ye).toString()||(i=!0)}),i}(e,i)){e.push(i);const s=i.field,r=i.getTicks(),a=[];T.each(r,t=>{const e=t.text,s=t.value,r=i.invert(s),o={fill:n.mapping(r).join("")||E.defaultColor,radius:3,symbol:"circle",stroke:"#fff"};a.push({name:e,dataValue:r,checked:!0,marker:o})}),t[s]=a}}}),this.set("legendItems",t),t}registerPlugins(t){const e=this;let i=e.get("plugins")||[];T.isArray(i)||(i=[i]),[].concat(t).forEach(t=>{-1===i.indexOf(t)&&(t.init&&t.init(e),i.push(t))}),ve.plugins._cacheId++,e.set("plugins",i)}_renderAxis(){const t=this.get("axisController"),e=this.getXScale(),i=this.getYScales(),n=this.get("coord");ve.plugins.notify(this,"beforeRenderAxis"),t.createAxis(n,e,i)}_isAutoPadding(){if(this.get("_padding"))return!1;const t=this.get("padding");return T.isArray(t)?-1!==t.indexOf("auto"):"auto"===t}_updateLayout(t){const e=this.get("width"),i=this.get("height"),n={x:t[3],y:t[0]},s={x:e-t[1],y:i-t[2]},r=this.get("plot"),a=this.get("coord");r.reset(n,s),a.reset(r)}}ve.plugins=ve.initPlugins();const _e={};_e.Global=E,_e.version=E.version,_e.Chart=ve,_e.Shape=H,_e.G=ge,_e.Util=T,_e.Helper=me,_e.track=()=>null;var Se=_e;var be={splitPoints(t){const e=[],i=t.x;let n=t.y;return n=T.isArray(n)?n:[n],n.forEach((function(t,n){const s={x:T.isArray(i)?i[n]:i,y:t};e.push(s)})),e},splitArray(t,e,i){if(!t.length)return[];const n=[];let s,r=[];return T.each(t,(function(t){s=t._origin?t._origin[e]:t[e],i?T.isNil(s)||r.push(t):T.isArray(s)&&T.isNil(s[0])||T.isNil(s)?r.length&&(n.push(r),r=[]):r.push(t)})),r.length&&n.push(r),n}};H.registerFactory("point",{defaultShapeType:"circle",getDefaultPoints:t=>be.splitPoints(t)});function Ce(t,e,i){if(0===t.size)return;const n=function(t){const e={lineWidth:0,stroke:t.color,fill:t.color};return t.size&&(e.size=t.size),T.mix(e,t.style),T.mix({},E.shape.point,e)}(t),s=n.r||n.size,r=t.x,a=T.isArray(t.y)?t.y:[t.y];"hollowCircle"===i&&(n.lineWidth=1,n.fill=null);for(let t=0,o=a.length;t<o;t++)return"rect"===i?e.addShape("Rect",{className:"point",attrs:T.mix({x:r-s,y:a[t]-s,width:2*s,height:2*s},n)}):e.addShape("Circle",{className:"point",attrs:T.mix({x:r,y:a[t],r:s},n)})}T.each(["circle","hollowCircle","rect"],(function(t){H.registerShape("point",t,{draw:(e,i)=>Ce(e,i,t)})}));at.Point=class extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="point",t.shapeType="point",t.generatePoints=!1,t}draw(t,e){const i=this,n=i.get("container");T.each(t,t=>{const s=t.shape,r=i.getDrawCfg(t);if(T.isArray(t.y)){const a=i.hasAdjust("stack");T.each(t.y,(o,l)=>{r.y=o,a&&0===l||i.drawShape(s,t,r,n,e)})}else T.isNil(t.y)||i.drawShape(s,t,r,n,e)})}};H.registerFactory("line",{defaultShapeType:"line"});T.each(["line","smooth","dash"],(function(t){H.registerShape("line",t,{draw(e,i){const n="smooth"===t,s=function(t){const e={strokeStyle:t.color};return t.size>=0&&(e.lineWidth=t.size),T.mix(e,t.style),T.mix({},E.shape.line,e)}(e);return"dash"===t&&(s.lineDash=E.lineDash),function(t,e,i,n){const s=t.points;if(s.length&&T.isArray(s[0].y)){const r=[],a=[];for(let t=0,e=s.length;t<e;t++){const e=s[t],i=be.splitPoints(e);a.push(i[0]),r.push(i[1])}return t.isInCircle&&(r.push(r[0]),a.push(a[0])),t.isStack?e.addShape("Polyline",{className:"line",attrs:T.mix({points:r,smooth:n},i)}):[e.addShape("Polyline",{className:"line",attrs:T.mix({points:r,smooth:n},i)}),e.addShape("Polyline",{className:"line",attrs:T.mix({points:a,smooth:n},i)})]}return t.isInCircle&&s.push(s[0]),e.addShape("Polyline",{className:"line",attrs:T.mix({points:s,smooth:n},i)})}(e,i,s,n)}})}));class Pe extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="path",t.shapeType="line",t}getDrawCfg(t){const e=super.getDrawCfg(t);return e.isStack=this.hasAdjust("stack"),e}draw(t,e){const i=this,n=i.get("container"),s=i.getYScale(),r=i.get("connectNulls"),a=be.splitArray(t,s.field,r),o=this.getDrawCfg(t[0]);o.origin=t,T.each(a,(function(s,r){o.splitedIndex=r,o.points=s,i.drawShape(o.shape,t[0],o,n,e)}))}}at.Path=Pe;var Me=Pe;function we(t,e){return Math.abs(t-e)<1e-5}function Te(t){return!isNaN(t)&&!T.isNil(t)}function Ae(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];Te(n.x)&&Te(n.y)&&e.push(n)}return e}function De(t,e,i){const n=t.points;let s=[],r=[];T.each(n,(function(t){r.push(t[0]),s.push(t[1])}));const a=T.mix({fillStyle:t.color},E.shape.area,t.style);return r.reverse(),s=this.parsePoints(s),r=this.parsePoints(r),t.isInCircle&&(s.push(s[0]),r.unshift(r[r.length-1]),function(t,e){let i=!0;return T.each(t,(function(t){if(!we(t.x,e.x)||!we(t.y,e.y))return i=!1,!1})),i}(r,t.center)&&(r=[])),function(t,e,i,n,s){let r;const a=t.concat(e);return r=s?i.addShape("Custom",{className:"area",attrs:T.mix({points:a},n),createPath(t){const e=[[0,0],[1,1]],i=Ae(this._attrs.attrs.points),n=i.length,s=i.slice(0,n/2),r=i.slice(n/2,n),a=oe.smooth(s,!1,e);t.beginPath(),t.moveTo(s[0].x,s[0].y);for(let e=0,i=a.length;e<i;e++){const i=a[e];t.bezierCurveTo(i[1],i[2],i[3],i[4],i[5],i[6])}if(r.length){const i=oe.smooth(r,!1,e);t.lineTo(r[0].x,r[0].y);for(let e=0,n=i.length;e<n;e++){const n=i[e];t.bezierCurveTo(n[1],n[2],n[3],n[4],n[5],n[6])}}t.closePath()},calculateBox(){const t=Ae(this._attrs.attrs.points);return re.getBBoxFromPoints(t)}}):i.addShape("Polyline",{className:"area",attrs:T.mix({points:a},n)}),r}(s,r,e,a,i)}at.Line=class extends Me{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="line",t.sortable=!0,t}};H.registerFactory("area",{defaultShapeType:"area",getDefaultPoints(t){const e=t.x;let i=t.y;const n=t.y0;i=T.isArray(i)?i:[n,i];const s=[];return s.push({x:e,y:i[0]},{x:e,y:i[1]}),s}});T.each(["area","smooth"],(function(t){H.registerShape("area",t,{draw(e,i){const n="smooth"===t;return De.call(this,e,i,n)}})}));at.Area=class extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="area",t.shapeType="area",t.generatePoints=!0,t.sortable=!0,t}draw(t,e){const i=this,n=i.get("container"),s=this.getDrawCfg(t[0]),r=i.getYScale(),a=i.get("connectNulls"),o=be.splitArray(t,r.field,a);s.origin=t,T.each(o,(function(r,a){s.splitedIndex=a;const o=r.map(t=>t.points);s.points=o,i.drawShape(s.shape,t[0],s,n,e)}))}};const ke={initEvent(){const t=this.get("chart");t&&t.on("_aftersizechange",()=>{this.set("_width",null)})},getDefalutSize(){let t=this.get("defaultSize");if(!t){const e=this.get("coord"),i=this.getXScale(),n=this.get("dataArray"),s=T.uniq(i.values).length,r=i.range;let a=1/s,o=1;e&&e.isPolar?o=e.transposed&&s>1?E.widthRatio.multiplePie:E.widthRatio.rose:(i.isLinear&&(a*=r[1]-r[0]),o=E.widthRatio.column),a*=o,this.hasAdjust("dodge")&&(a/=n.length),t=a,this.set("defaultSize",t)}return t},getDimWidth(t){const e=this.get("coord"),i=e.convertPoint({x:0,y:0}),n=e.convertPoint({x:"x"===t?1:0,y:"x"===t?0:1});let s=0;return i&&n&&(s=Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2))),s},_getWidth(){let t=this.get("_width");if(!t){const e=this.get("coord");t=e&&e.isPolar&&!e.transposed?(e.endAngle-e.startAngle)*e.circleRadius:this.getDimWidth("x"),this.set("_width",t)}return t},_toNormalizedSize(t){return t/this._getWidth()},_toCoordSize(t){return this._getWidth()*t},getNormalizedSize(t){let e=this.getAttrValue("size",t);return e=T.isNil(e)?this.getDefalutSize():this._toNormalizedSize(e),e},getSize(t){let e=this.getAttrValue("size",t);if(T.isNil(e)){const t=this.getDefalutSize();e=this._toCoordSize(t)}return e}};function Ee(t){const{x:e,y:i,y0:n,size:s}=t;let r,a,o=n,l=i;return T.isArray(i)&&(l=i[1],o=i[0]),T.isArray(e)?(r=e[0],a=e[1]):(r=e-s/2,a=e+s/2),[{x:r,y:o},{x:r,y:l},{x:a,y:l},{x:a,y:o}]}H.registerFactory("interval",{defaultShapeType:"rect",getDefaultPoints:t=>Ee(t)});H.registerShape("interval","rect",{draw(t,e){const i=this.parsePoints(t.points),n=T.mix({fill:t.color},E.shape.interval,t.style);if(t.isInCircle){let s=i.slice(0);this._coord.transposed&&(s=[i[0],i[3],i[2],i[1]]);const{x:r,y:a}=t.center,o=[1,0],l=[s[0].x-r,s[0].y-a],h=[s[1].x-r,s[1].y-a],c=[s[2].x-r,s[2].y-a];let u=B.angleTo(o,h),g=B.angleTo(o,c);const d=B.length(l),f=B.length(h);return u>=1.5*Math.PI&&(u-=2*Math.PI),g>=1.5*Math.PI&&(g-=2*Math.PI),e.addShape("Sector",{className:"interval",attrs:T.mix({x:r,y:a,r:f,r0:d,startAngle:u,endAngle:g},n)})}const s=function(t){const e=[],i=[];for(let n=0,s=t.length;n<s;n++){const s=t[n];e.push(s.x),i.push(s.y)}const n=Math.min.apply(null,e),s=Math.min.apply(null,i);return{x:n,y:s,width:Math.max.apply(null,e)-n,height:Math.max.apply(null,i)-s}}(i);return e.addShape("rect",{className:"interval",attrs:T.mix(s,n)})}}),["pyramid","funnel"].forEach(t=>{H.registerShape("interval",t,{getPoints:t=>(t.size=2*t.size,Ee(t)),draw(e,i){const n=this.parsePoints(e.points),s=this.parsePoints(e.nextPoints);let r=null;var a,o;s?r=[n[0],n[1],s[1],s[0]]:(r=[n[0],n[1]],"pyramid"===t?r.push((a=n[2],o=n[3],{x:(a.x-o.x)/2+o.x,y:(a.y-o.y)/2+o.y})):r.push(n[2],n[3]));const l=T.mix({fill:e.color,points:r},E.shape.interval,e.style);return i.addShape("polygon",{className:"interval",attrs:l})}})});at.Interval=class extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="interval",t.shapeType="interval",t.generatePoints=!0,t}constructor(t){super(t),T.mix(this,ke)}init(){super.init(),this.initEvent()}createShapePointsCfg(t){const e=super.createShapePointsCfg(t);return e.size=this.getNormalizedSize(t),e}clearInner(){super.clearInner(),this.set("defaultSize",null)}};H.registerFactory("polygon",{defaultShapeType:"polygon",getDefaultPoints(t){const e=[],{x:i,y:n}=t;for(let t=0,s=i.length;t<s;t++)e.push({x:i[t],y:n[t]});return e}});H.registerShape("polygon","polygon",{draw(t,e){const i=this.parsePoints(t.points),n=T.mix({fill:t.color,points:i},t.style);return e.addShape("Polygon",{className:"polygon",attrs:n})}});at.Polygon=class extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}createShapePointsCfg(t){const e=super.createShapePointsCfg(t),i=this;let n,s=e.x,r=e.y;if(!T.isArray(s)||!T.isArray(r)){const t=i.getXScale(),a=i.getYScale(),o=.5/(t.values?t.values.length:t.ticks.length),l=.5/(a.values?a.values.length:a.ticks.length);t.isCategory&&a.isCategory?(s=[s-o,s-o,s+o,s+o],r=[r-l,r+l,r+l,r-l]):T.isArray(s)?(n=s,s=[n[0],n[0],n[1],n[1]],r=[r-l/2,r+l/2,r+l/2,r-l/2]):T.isArray(r)&&(n=r,r=[n[0],n[1],n[1],n[0]],s=[s-o/2,s-o/2,s+o/2,s+o/2]),e.x=s,e.y=r}return e}};H.registerFactory("schema",{});H.registerShape("schema","candle",{getPoints:t=>function(t,e,i){const n=function(t){const e=t.sort((function(t,e){return t<e?1:-1})),i=e.length;if(i<4){const t=e[i-1];for(let n=0;n<4-i;n++)e.push(t)}return e}(e);return[{x:t,y:n[0]},{x:t,y:n[1]},{x:t-i/2,y:n[2]},{x:t-i/2,y:n[1]},{x:t+i/2,y:n[1]},{x:t+i/2,y:n[2]},{x:t,y:n[2]},{x:t,y:n[3]}]}(t.x,t.y,t.size),draw(t,e){const i=this.parsePoints(t.points),n=T.mix({stroke:t.color,fill:t.color,lineWidth:1},t.style);return e.addShape("Custom",{className:"schema",attrs:n,createPath(t){t.beginPath(),t.moveTo(i[0].x,i[0].y),t.lineTo(i[1].x,i[1].y),t.moveTo(i[2].x,i[2].y);for(let e=3;e<6;e++)t.lineTo(i[e].x,i[e].y);t.closePath(),t.moveTo(i[6].x,i[6].y),t.lineTo(i[7].x,i[7].y)}})}});at.Schema=class extends at{getDefaultCfg(){const t=super.getDefaultCfg();return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}constructor(t){super(t),T.mix(this,ke)}init(){super.init(),this.initEvent()}createShapePointsCfg(t){const e=super.createShapePointsCfg(t);return e.size=this.getNormalizedSize(t),e}clearInner(){super.clearInner(),this.set("defaultSize",null)}};var Ie=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){this.xField=null,this.yField=null},s.processAdjust=function(t){this.processStack(t)},s.processStack=function(t){var e=this.xField,i=this.yField,n=t.length,s={positive:{},negative:{}};this.reverseOrder&&(t=t.slice(0).reverse());for(var r=0;r<n;r++)for(var a=t[r],o=0,l=a.length;o<l;o++){var h=a[o],c=h[e]||0,u=h[i],g=c.toString();if(u=ut(u)?u[1]:u,!dt(u)){var d=u>=0?"positive":"negative";s[d][g]||(s[d][g]=0),h[i]=[s[d][g],u+s[d][g]],s[d][g]+=u}}},n}(U);U.Stack=Ie;var Oe=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){this.marginRatio=.5,this.dodgeRatio=.5,this.adjustNames=["x","y"]},s.getDodgeOffset=function(t,e,i){var n=t.pre,s=t.next,r=s-n,a=r*this.dodgeRatio/i,o=this.marginRatio*a;return(n+s)/2+(.5*(r-i*a-(i-1)*o)+((e+1)*a+e*o)-.5*a-.5*r)},s.processAdjust=function(t){var e=this,i=t.length,n=e.xField;gt(t,(function(t,s){for(var r=0,a=t.length;r<a;r++){var o=t[r],l=o[n],h={pre:1===a?l-1:l-.5,next:1===a?l+1:l+.5},c=e.getDodgeOffset(h,s,i);o[n]=c}}))},n}(U);U.Dodge=Oe;var Ye=function(t){return ct(t,"Function")},Fe=function(t,e){if(ut(t)){var i=t[0],n=void 0;n=Ye(e)?e(t[0]):t[0][e];var s=void 0;return gt(t,(function(t){(s=Ye(e)?e(t):t[e])>n&&(i=t,n=s)})),i}};var Ne={merge:function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(t[i]);return e}},Be=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){this.xField=null,this.yField=null,this.cacheMax=null,this.adjustNames=["y"],this.groupFields=null},s._getMax=function(t){var e=this.mergeData,i=Fe(e,(function(e){var i=e[t];return ut(i)?Math.max.apply(null,i):i}))[t];return ut(i)?Math.max.apply(null,i):i},s._getXValuesMax=function(){var t=this.yField,e=this.xField,i={},n=this.mergeData;return gt(n,(function(n){var s=n[e],r=n[t],a=ut(r)?Math.max.apply(null,r):r;i[s]=i[s]||0,i[s]<a&&(i[s]=a)})),i},s.processAdjust=function(t){var e=Ne.merge(t);this.mergeData=e,this._processSymmetric(t),this.mergeData=null},s._processSymmetric=function(t){var e,i=this.xField,n=this.yField,s=this._getMax(n),r=t[0][0];r&&ut(r[n])&&(e=this._getXValuesMax()),gt(t,(function(t){gt(t,(function(t){var r,a=t[n];if(ut(a)){var o=t[i],l=e[o];r=(s-l)/2;var h=[];gt(a,(function(t){h.push(r+t)})),t[n]=h}else r=(s-a)/2,t[n]=[r,a+r]}))}))},n}(U);U.Symmetric=Be;L.Polar=class extends L{_initDefaultCfg(){this.type="polar",this.startAngle=-Math.PI/2,this.endAngle=3*Math.PI/2,this.inner=0,this.innerRadius=0,this.isPolar=!0,this.transposed=!1,this.center=null,this.radius=null}init(t,e){super.init(t,e);const i=this.inner||this.innerRadius,n=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);let r,a;this.startAngle===-Math.PI&&0===this.endAngle?(r=Math.min(n/2,s),a={x:(t.x+e.x)/2,y:t.y}):(r=Math.min(n,s)/2,a={x:(t.x+e.x)/2,y:(t.y+e.y)/2});const o=this.radius;o>0&&o<=1&&(r*=o),this.x={start:this.startAngle,end:this.endAngle},this.y={start:r*i,end:r},this.center=a,this.circleRadius=r}_convertPoint(t){const e=this.center,i=this.transposed,n=i?"y":"x",s=i?"x":"y",r=this.x,a=this.y,o=r.start+(r.end-r.start)*t[n],l=a.start+(a.end-a.start)*t[s];return{x:e.x+Math.cos(o)*l,y:e.y+Math.sin(o)*l}}_invertPoint(t){const{center:e,transposed:i,x:n,y:s}=this,r=i?"y":"x",a=i?"x":"y",o=[1,0,0,1,0,0];N.rotate(o,o,n.start);let l=[1,0];B.transformMat2d(l,l,o),l=[l[0],l[1]];const h=[t.x-e.x,t.y-e.y];if(B.zero(h))return{x:0,y:0};let c=B.angleTo(l,h,n.end<n.start);Math.abs(c-2*Math.PI)<.001&&(c=0);const u=B.length(h);let g=c/(n.end-n.start);g=n.end-n.start>0?g:-g;const d=(u-s.start)/(s.end-s.start),f={};return f[r]=g,f[a]=d,f}};It.Circle=class extends It{_initDefaultCfg(){super._initDefaultCfg(),this.startAngle=-Math.PI/2,this.endAngle=3*Math.PI/2,this.radius=null,this.center=null}getOffsetPoint(t){const{startAngle:e,endAngle:i}=this,n=e+(i-e)*t;return this._getCirclePoint(n)}_getCirclePoint(t,e){const i=this.center;return e=e||this.radius,{x:i.x+Math.cos(t)*e,y:i.y+Math.sin(t)*e}}getTextAlignInfo(t,e){const i=this.getOffsetVector(t,e);let n,s="middle";return i[0]>0?n="left":i[0]<0?n="right":(n="center",i[1]>0?s="top":i[1]<0&&(s="bottom")),{textAlign:n,textBaseline:s}}getAxisVector(t){const e=this.center,i=this.offsetFactor;return[(t.y-e.y)*i,-1*(t.x-e.x)*i]}drawLine(t){const{center:e,radius:i,startAngle:n,endAngle:s}=this;this.getContainer(t.top).addShape("arc",{className:"axis-line",attrs:T.mix({x:e.x,y:e.y,r:i,startAngle:n,endAngle:s},t)})}};var Xe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Le(t,e){return t(e={exports:{}},e.exports),e.exports}var ze=Le((function(t){!function(e){var i={},n=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,s=/\d\d?/,r=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,a=/\[([^]*?)\]/gm,o=function(){};function l(t,e){for(var i=[],n=0,s=t.length;n<s;n++)i.push(t[n].substr(0,e));return i}function h(t){return function(e,i,n){var s=n[t].indexOf(i.charAt(0).toUpperCase()+i.substr(1).toLowerCase());~s&&(e.month=s)}}function c(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}var u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],g=["January","February","March","April","May","June","July","August","September","October","November","December"],d=l(g,3),f=l(u,3);i.i18n={dayNamesShort:f,dayNames:u,monthNamesShort:d,monthNames:g,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10)*t%10]}};var p={D:function(t){return t.getDate()},DD:function(t){return c(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return t.getDay()},dd:function(t){return c(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return c(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return String(t.getFullYear()).substr(2)},YYYY:function(t){return c(t.getFullYear(),4)},h:function(t){return t.getHours()%12||12},hh:function(t){return c(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return c(t.getHours())},m:function(t){return t.getMinutes()},mm:function(t){return c(t.getMinutes())},s:function(t){return t.getSeconds()},ss:function(t){return c(t.getSeconds())},S:function(t){return Math.round(t.getMilliseconds()/100)},SS:function(t){return c(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return c(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+c(100*Math.floor(Math.abs(e)/60)+Math.abs(e)%60,4)}},m={D:[s,function(t,e){t.day=e}],Do:[new RegExp(s.source+r.source),function(t,e){t.day=parseInt(e,10)}],M:[s,function(t,e){t.month=e-1}],YY:[s,function(t,e){var i=+(""+(new Date).getFullYear()).substr(0,2);t.year=""+(e>68?i-1:i)+e}],h:[s,function(t,e){t.hour=e}],m:[s,function(t,e){t.minute=e}],s:[s,function(t,e){t.second=e}],YYYY:[/\d{4}/,function(t,e){t.year=e}],S:[/\d/,function(t,e){t.millisecond=100*e}],SS:[/\d{2}/,function(t,e){t.millisecond=10*e}],SSS:[/\d{3}/,function(t,e){t.millisecond=e}],d:[s,o],ddd:[r,o],MMM:[r,h("monthNamesShort")],MMMM:[r,h("monthNames")],a:[r,function(t,e,i){var n=e.toLowerCase();n===i.amPm[0]?t.isPm=!1:n===i.amPm[1]&&(t.isPm=!0)}],ZZ:[/([\+\-]\d\d:?\d\d|Z)/,function(t,e){"Z"===e&&(e="+00:00");var i,n=(e+"").match(/([\+\-]|\d\d)/gi);n&&(i=60*n[1]+parseInt(n[2],10),t.timezoneOffset="+"===n[0]?i:-i)}]};m.dd=m.d,m.dddd=m.ddd,m.DD=m.D,m.mm=m.m,m.hh=m.H=m.HH=m.h,m.MM=m.M,m.ss=m.s,m.A=m.a,i.masks={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},i.format=function(t,e,s){var r=s||i.i18n;if("number"==typeof t&&(t=new Date(t)),"[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw new Error("Invalid Date in fecha.format");e=i.masks[e]||e||i.masks.default;var o=[];return(e=(e=e.replace(a,(function(t,e){return o.push(e),"??"}))).replace(n,(function(e){return e in p?p[e](t,r):e.slice(1,e.length-1)}))).replace(/\?\?/g,(function(){return o.shift()}))},i.parse=function(t,e,s){var r=s||i.i18n;if("string"!=typeof e)throw new Error("Invalid format in fecha.parse");if(e=i.masks[e]||e,t.length>1e3)return!1;var a=!0,o={};if(e.replace(n,(function(e){if(m[e]){var i=m[e],n=t.search(i[0]);~n?t.replace(i[0],(function(e){return i[1](o,e,r),t=t.substr(n+e.length),e})):a=!1}return m[e]?"":e.slice(1,e.length-1)})),!a)return!1;var l,h=new Date;return!0===o.isPm&&null!=o.hour&&12!=+o.hour?o.hour=+o.hour+12:!1===o.isPm&&12==+o.hour&&(o.hour=0),null!=o.timezoneOffset?(o.minute=+(o.minute||0)-+o.timezoneOffset,l=new Date(Date.UTC(o.year||h.getFullYear(),o.month||0,o.day||1,o.hour||0,o.minute||0,o.second||0,o.millisecond||0))):l=new Date(o.year||h.getFullYear(),o.month||0,o.day||1,o.hour||0,o.minute||0,o.second||0,o.millisecond||0),l},t.exports?t.exports=i:e.fecha=i}(Xe)})),Re=function(t){return ct(t,"Date")},je=function(t){return Mt(t)&&(t=t.indexOf("T")>0?new Date(t).getTime():new Date(t.replace(/-/gi,"/")).getTime()),Re(t)&&(t=t.getTime()),t};var Ge=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s._initDefaultCfg=function(){t.prototype._initDefaultCfg.call(this),this.type="timeCat",this.sortable=!0,this.tickCount=5,this.mask="YYYY-MM-DD"},s.init=function(){var t=this,e=this.values;gt(e,(function(i,n){e[n]=t._toTimeStamp(i)})),this.sortable&&e.sort((function(t,e){return t-e})),t.ticks||(t.ticks=this.calculateTicks())},s.calculateTicks=function(){var t,e=this.tickCount;e?t=Pt({maxCount:e,data:this.values,isRounding:this.isRounding}).ticks:t=this.values;return t},s.translate=function(t){t=this._toTimeStamp(t);var e=this.values.indexOf(t);return-1===e&&(e=pt(t)&&t<this.values.length?t:NaN),e},s.scale=function(t){var e=this.rangeMin(),i=this.rangeMax(),n=this.translate(t);return e+(1===this.values.length||isNaN(n)?n:n>-1?n/(this.values.length-1):0)*(i-e)},s.getText=function(t){var e="",i=this.translate(t);e=i>-1?this.values[i]:t;var n=this.formatter;return e=parseInt(e,10),e=n?n(e):ze.format(e,this.mask)},s.getTicks=function(){var t=this,e=this.ticks,i=[];return gt(e,(function(e){var n;n=lt(e)?e:{text:Mt(e)?e:t.getText(e),value:t.scale(e),tickValue:e},i.push(n)})),i},s._toTimeStamp=function(t){return je(t)},n}(Tt);ft.TimeCat=Ge;const We={min:0,median:.5,max:1};var He=class{_initDefaultCfg(){}constructor(t){this._initDefaultCfg(),T.deepMix(this,t)}_getNormalizedValue(t,e){let i;return i=T.isNil(We[t])?e.scale(t):We[t],i}parsePercentPoint(t,e){const i=parseFloat(e[0])/100,n=parseFloat(e[1])/100,s=t.start,r=t.end,a=Math.abs(s.x-r.x),o=Math.abs(s.y-r.y);return{x:a*i+Math.min(s.x,r.x),y:o*n+Math.min(s.y,r.y)}}parsePoint(t,e){const i=this.xScale,n=this.yScales;if(T.isFunction(e)&&(e=e(i,n)),T.isString(e[0])&&-1!==e[0].indexOf("%")&&!isNaN(e[0].slice(0,-1)))return this.parsePercentPoint(t,e);const s=this._getNormalizedValue(e[0],i),r=this._getNormalizedValue(e[1],n[0]),a=t.convertPoint({x:s,y:r});return this.limitInPlot?s>=0&&s<=1&&r>=0&&r<=1?a:null:a}render(){}repaint(){this.remove();const{coord:t,container:e,canvas:i}=this;e&&!e.isDestroyed()&&(this.render(t,e),i.draw())}remove(){const{element:t}=this;t&&t.remove(!0)}changeVisible(t){this.visible=t;const e=this.element;e&&(e.set?e.set("visible",t):e.style.display=t?"":"none")}};He.Text=class extends He{_initDefaultCfg(){this.type="text",this.position=null,this.content=null,this.style={fill:"#000"},this.offsetX=0,this.offsetY=0}render(t,e){const i=this.position,n=this.parsePoint(t,i);if(!n)return;const{content:s,style:r,offsetX:a,offsetY:o}=this;a&&(n.x+=a),o&&(n.y+=o);const l=e.addShape("text",{className:"guide-text",attrs:T.mix({x:n.x,y:n.y,text:s},r)});return this.element=l,l}};He.Line=class extends He{_initDefaultCfg(){this.type="line",this.start=[],this.end=[],this.style={stroke:"#000",lineWidth:1}}render(t,e){const i=[];if(i[0]=this.parsePoint(t,this.start),i[1]=this.parsePoint(t,this.end),!i[0]||!i[1])return;const n=e.addShape("Line",{className:"guide-line",attrs:T.mix({x1:i[0].x,y1:i[0].y,x2:i[1].x,y2:i[1].y},this.style)});return this.element=n,n}};He.Arc=class extends He{_initDefaultCfg(){this.type="arc",this.start=[],this.end=[],this.style={stroke:"#999",lineWidth:1}}render(t,e){const i=this.parsePoint(t,this.start),n=this.parsePoint(t,this.end);if(!i||!n)return;const s=t.center,r=Math.sqrt((i.x-s.x)*(i.x-s.x)+(i.y-s.y)*(i.y-s.y)),a=Math.atan2(i.y-s.y,i.x-s.x),o=Math.atan2(n.y-s.y,n.x-s.x),l=e.addShape("arc",{className:"guide-arc",attrs:T.mix({x:s.x,y:s.y,r:r,startAngle:a,endAngle:o},this.style)});return this.element=l,l}};function Ve(t,e){for(const i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i]);return t}function qe(t){const e=document.createElement("div");return t=t.replace(/(^\s*)|(\s*$)/g,""),e.innerHTML=""+t,e.childNodes[0]}He.Rect=class extends He{_initDefaultCfg(){this.type="rect",this.start=[],this.end=[],this.style={fill:"#CCD7EB",opacity:.4}}render(t,e){const i=this.parsePoint(t,this.start),n=this.parsePoint(t,this.end);if(!i||!n)return;const s=e.addShape("rect",{className:"guide-rect",attrs:T.mix({x:Math.min(i.x,n.x),y:Math.min(i.y,n.y),width:Math.abs(n.x-i.x),height:Math.abs(i.y-n.y)},this.style)});return this.element=s,s}};He.Html=class extends He{_initDefaultCfg(){this.type="html",this.position=null,this.alignX="center",this.alignY="middle",this.offsetX=null,this.offsetY=null,this.html=null}render(t,e){const i=this.parsePoint(t,this.position);if(!i)return;let n=qe(this.html);n=Ve(n,{position:"absolute",top:Math.floor(i.y)+"px",left:Math.floor(i.x)+"px",visibility:"hidden"});const s=e.get("canvas").get("el");let r=s.parentNode;r=Ve(r,{position:"relative"});const a=qe('<div class="guideWapper" style="position: absolute;top: 0; left: 0;"></div>');r.appendChild(a),a.appendChild(n);const o=s.offsetTop,l=s.offsetLeft,{alignX:h,alignY:c,offsetX:u,offsetY:g}=this,d=function(t,e,i,n){const s=[];return"left"===t&&"top"===e?(s[0]=0,s[1]=0):"right"===t&&"top"===e?(s[0]=-i,s[1]=0):"left"===t&&"bottom"===e?(s[0]=0,s[1]=Math.floor(-n)):"right"===t&&"bottom"===e?(s[0]=Math.floor(-i),s[1]=Math.floor(-n)):"right"===t&&"middle"===e?(s[0]=Math.floor(-i),s[1]=Math.floor(-n/2)):"left"===t&&"middle"===e?(s[0]=0,s[1]=Math.floor(-n/2)):"center"===t&&"bottom"===e?(s[0]=Math.floor(-i/2),s[1]=Math.floor(-n)):"center"===t&&"top"===e?(s[0]=Math.floor(-i/2),s[1]=0):(s[0]=Math.floor(-i/2),s[1]=Math.floor(-n/2)),s}(h,c,T.getWidth(n),T.getHeight(n));i.x=i.x+d[0]+l,i.y=i.y+d[1]+o,u&&(i.x+=u),g&&(i.y+=g),Ve(n,{top:Math.floor(i.y)+"px",left:Math.floor(i.x)+"px",visibility:"visible"}),this.element=a}remove(){const t=this.element;t&&t.parentNode&&t.parentNode.removeChild(t)}};He.Tag=class extends He{_initDefaultCfg(){this.type="tag",this.position=null,this.content=null,this.direct="tl",this.autoAdjust=!0,this.offsetX=0,this.offsetY=0,this.side=4,this.background={padding:5,radius:2,fill:"#1890FF"},this.textStyle={fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"},this.withPoint=!0,this.pointStyle={fill:"#1890FF",r:3,lineWidth:1,stroke:"#fff"}}_getDirect(t,e,i,n){let s=this.direct;const r=this.side,a=t.get("canvas"),o=a.get("width"),l=a.get("height"),{x:h,y:c}=e;let u=s[0],g=s[1];"t"===u&&c-r-n<0?u="b":"b"===u&&c+r+n>l&&(u="t");const d="c"===u?r:0;return"l"===g&&h-d-i<0?g="r":"r"===g&&h+d+i>o?g="l":"c"===g&&(i/2+h+d>o?g="l":h-i/2-d<0&&(g="r")),s=u+g,s}render(t,e){const i=this.parsePoint(t,this.position);if(!i)return;if(isNaN(i.x)||isNaN(i.y))return;const{content:n,background:s,textStyle:r}=this,a=[],o=e.addGroup({className:"guide-tag"});if(this.withPoint){const t=o.addShape("Circle",{className:"guide-tag-point",attrs:T.mix({x:i.x,y:i.y},this.pointStyle)});a.push(t)}const l=o.addGroup(),h=l.addShape("text",{className:"guide-tag-text",zIndex:1,attrs:T.mix({x:0,y:0,text:n},r)});a.push(h);const c=h.getBBox(),u=T.parsePadding(s.padding),g=c.width+u[1]+u[3],d=c.height+u[0]+u[2],f=c.minY-u[0],p=c.minX-u[3],m=l.addShape("rect",{className:"guide-tag-bg",zIndex:-1,attrs:T.mix({x:p,y:f,width:g,height:d},s)});a.push(m);const x=this.autoAdjust?this._getDirect(e,i,g,d):this.direct,y=this.side;let v,_=i.x+this.offsetX,S=i.y+this.offsetY;const b=T.parsePadding(s.radius);"tl"===x?(v=[{x:g+p-y-1,y:d+f-1},{x:g+p,y:d+f-1},{x:g+p,y:d+y+f}],b[2]=0,_-=g,S=S-y-d):"cl"===x?(v=[{x:g+p-1,y:(d-y)/2+f-1},{x:g+p-1,y:(d+y)/2+f+1},{x:g+y+p,y:d/2+f}],_=_-g-y,S-=d/2):"bl"===x?(v=[{x:g+p,y:-y+f},{x:g+p-y-1,y:f+1},{x:g+p,y:f+1}],b[1]=0,_-=g,S+=y):"bc"===x?(v=[{x:g/2+p,y:-y+f},{x:(g-y)/2+p-1,y:f+1},{x:(g+y)/2+p+1,y:f+1}],_-=g/2,S+=y):"br"===x?(v=[{x:p,y:f-y},{x:p,y:f+1},{x:p+y+1,y:f+1}],b[0]=0,S+=y):"cr"===x?(v=[{x:p-y,y:d/2+f},{x:p+1,y:(d-y)/2+f-1},{x:p+1,y:(d+y)/2+f+1}],_+=y,S-=d/2):"tr"===x?(v=[{x:p,y:d+y+f},{x:p,y:d+f-1},{x:y+p+1,y:d+f-1}],b[3]=0,S=S-d-y):"tc"===x&&(v=[{x:(g-y)/2+p-1,y:d+f-1},{x:(g+y)/2+p+1,y:d+f-1},{x:g/2+p,y:d+y+f}],_-=g/2,S=S-d-y);const C=l.addShape("Polygon",{className:"guide-tag-side",zIndex:0,attrs:{points:v,fill:s.fill}});return a.push(C),m.attr("radius",b),l.moveTo(_-p,S-f),l.sort(),this.element=o,a}};He.Point=class extends He{_initDefaultCfg(){this.type="point",this.position=null,this.offsetX=0,this.offsetY=0,this.style={fill:"#1890FF",r:3,lineWidth:1,stroke:"#fff"}}render(t,e){const i=this.parsePoint(t,this.position);if(!i)return null;const n=e.addShape("Circle",{className:"guide-point",attrs:T.mix({x:i.x+this.offsetX,y:i.y+this.offsetY},this.style)});return this.element=n,n}};const{Rect:Ue}=zt;He.RegionFilter=class extends He{_initDefaultCfg(){this.type="regionFilter",this.start=[],this.end=[],this.color=null,this.style=null}render(t){const e=this.parsePoint(t,this.start),i=this.parsePoint(t,this.end);if(!e||!i)return;const n=new Ue({attrs:{x:Math.min(e.x,i.x),y:Math.min(e.y,i.y),width:Math.abs(i.x-e.x),height:Math.abs(i.y-e.y)}});this.clip=n;const s=this.chart,r=this.color,a=this.style||{},o=[];s.get("geoms").map(t=>{const e=t.get("container"),i=e.get("children"),s=e.addGroup({zIndex:10,className:"guide-region-filter"});return i.map(t=>{if(t.get("isShape")){const e=t.get("type"),i=T.mix({},t.get("attrs"),a);r&&(i.fill||i.fillStyle)&&(i.fill=i.fillStyle=r),r&&(i.stroke||i.strokeStyle)&&(i.stroke=i.strokeStyle=r);const n={attrs:i};"custom"!==e&&"Custom"!==e||(n.createPath=t.get("createPath"),n.calculateBox=t.get("calculateBox")),s.addShape(e,n)}return t}),s.attr("clip",n),e.sort(),o.push(s),t}),this.element=o}remove(){const t=this.element;T.each(t,t=>{t&&t.remove(!0)}),this.clip&&this.clip.remove(!0)}};const{Shape:Ze}=ge,$e={circle(t,e,i,n){n.arc(t,e,i,0,2*Math.PI,!1)},square(t,e,i,n){n.moveTo(t-i,e-i),n.lineTo(t+i,e-i),n.lineTo(t+i,e+i),n.lineTo(t-i,e+i),n.closePath()}};var Je=class extends Ze{_initProperties(){super._initProperties(),this._attrs.canFill=!0,this._attrs.canStroke=!0,this._attrs.type="marker"}getDefaultAttrs(){return{x:0,y:0,lineWidth:0}}createPath(t){const e=this.get("attrs"),{x:i,y:n,radius:s}=e,r=e.symbol||"circle";let a;a=T.isFunction(r)?r:$e[r],t.beginPath(),a(i,n,s,t,this)}calculateBox(){const t=this.get("attrs"),{x:e,y:i,radius:n}=t;return{minX:e-n,minY:i-n,maxX:e+n,maxY:i+n}}};const{Group:Ke}=ge;var Qe=class{getDefaultCfg(){return{showTitle:!1,title:null,items:null,titleGap:12,itemGap:10,itemMarginBottom:12,itemFormatter:null,itemWidth:null,wordSpace:6,x:0,y:0,layout:"horizontal",joinString:": "}}constructor(t){T.deepMix(this,this.getDefaultCfg(),t),this._init(),this._renderTitle(),this._renderItems()}_init(){const t=new Ke({zIndex:this.zIndex||0});this.container=t;const e=t.addGroup();this.wrapper=e;const i=e.addGroup({className:"itemsGroup"});this.itemsGroup=i,this.parent&&this.parent.add(t)}_renderTitle(t){t=t||this.title;let e=this.titleShape,i=0;if(this.showTitle&&t){if(e&&!e.get("destroyed"))e.attr("text",t);else{const{wrapper:i,titleStyle:n}=this;e=i.addShape("text",{className:"title",attrs:T.mix({x:0,y:0,text:t},n)}),this.titleShape=e}i=e.getBBox().height+this.titleGap}this._titleHeight=i}_renderItems(t){const e=this;(t=t||e.items)&&(e.reversed&&t.reverse(),T.each(t,(t,i)=>{e._addItem(t,i)}),t.length>1&&this._adjustItems(),this._renderBackground())}_renderBackground(){const t=this.background;if(t){const e=this.container,i=this.wrapper,{minX:n,minY:s,width:r,height:a}=i.getBBox();let o=t.padding||[0,0,0,0];o=T.parsePadding(o);const l=T.mix({x:n-o[3],y:s-o[0],width:r+o[1]+o[3],height:a+o[0]+o[2]},t);let h=this.backShape;h?h.attr(l):h=e.addShape("Rect",{zIndex:-1,attrs:l}),this.backShape=h,e.sort()}}_addItem(t){const e=this.itemsGroup.addGroup({name:t.name,value:t.value,dataValue:t.dataValue,checked:t.checked}),{unCheckStyle:i,unCheckColor:n,nameStyle:s,valueStyle:r,wordSpace:a}=this,{marker:o,value:l}=t;let h,c=0;if(n&&(i.fill=n),o){const n=o.radius||3,s=T.mix({x:n,y:this._titleHeight},o);!1===t.checked&&T.mix(s,i);const r=new Je({className:"item-marker",attrs:s});e.add(r),c+=r.getBBox().width+a}let u=t.name;if(u){const n=this.joinString||"";u=l?u+n:u,h=e.addShape("text",{className:"name",attrs:T.mix({x:c,y:this._titleHeight,text:this._formatItemValue(u)},s,!1===t.checked?i:null)})}if(l){let n=c;h&&(n+=h.getBBox().width),e.addShape("text",{className:"value",attrs:T.mix({x:n,y:this._titleHeight,text:l},r,!1===t.checked?i:null)})}return e}_formatItemValue(t){const e=this.itemFormatter;return e&&(t=e.call(this,t)),t}_getMaxItemWidth(){let t;const e=this.itemWidth;if(T.isNumber(e)||T.isNil(e))return e;if("auto"===e){const e=this.itemsGroup.get("children"),i=e.length;let n=0;for(let t=0;t<i;t++){const{width:i}=e[t].getBBox();n=Math.max(n,i)}const s=this.maxLength,r=this.itemGap,a=(s-r)/2,o=(s-2*r)/3;return t=2===i?Math.max(n,a):n<=o?o:n<=a?a:n,t}}_adjustHorizontal(){const{maxLength:t,itemsGroup:e}=this,i=e.get("children"),{itemGap:n,itemMarginBottom:s}=this,r=this._titleHeight;let a,o,l=0,h=0;const c=this._getMaxItemWidth(),u=[];for(let e=0,g=i.length;e<g;e++){const g=i[e],d=g.getBBox(),f=d.height,p=d.width;a=c||p,o=f+s,a-(t-h)>1e-4&&(l++,h=0),g.moveTo(h,l*o),u.push({x:h,y:l*o+r-f/2,width:1.375*p,height:1.375*f}),h+=a+n}this.legendHitBoxes=u}_adjustVertical(){const{maxLength:t,itemsGroup:e}=this,{itemGap:i,itemMarginBottom:n,itemWidth:s}=this,r=this._titleHeight,a=e.get("children");let o,l,h=0,c=0,u=0;const g=[];for(let e=0,d=a.length;e<d;e++){const d=a[e],f=d.getBBox();o=f.width,l=f.height,T.isNumber(s)?c=s+i:o>c&&(c=o+i),t-h<l?(h=0,u+=c,d.moveTo(u,0),g.push({x:u,y:r-l/2,width:1.375*o,height:1.375*l})):(d.moveTo(u,h),g.push({x:u,y:h-l/2+r,width:1.375*o,height:1.375*l})),h+=l+n}this.legendHitBoxes=g}_adjustItems(){"horizontal"===this.layout?this._adjustHorizontal():this._adjustVertical()}moveTo(t,e){this.x=t,this.y=e;const i=this.container;return i&&i.moveTo(t,e),this}setItems(t){this.clearItems(),this._renderItems(t)}setTitle(t){this._renderTitle(t)}clearItems(){this.itemsGroup.clear()}getWidth(){return this.container.getBBox().width}getHeight(){return this.container.getBBox().height}show(){this.container.show()}hide(){this.container.hide()}clear(){const t=this.container;t.clear(),t.remove(!0)}};const{Group:ti}=ge;var ei=class{getDefaultCfg(){return{x:0,y:0,content:"",textStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"},background:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},width:0,height:0,className:""}}constructor(t){T.deepMix(this,this.getDefaultCfg(),t),this._init();const{content:e,x:i,y:n}=this;T.isNil(e)||this.updateContent(e),this.updatePosition(i,n)}_init(){const{content:t,textStyle:e,background:i,className:n,visible:s}=this,r=new ti({className:n,zIndex:0,visible:s}),a=r.addShape("Text",{className:n+"-text",zIndex:1,attrs:T.mix({text:t,x:0,y:0},e)}),o=r.addShape("Rect",{className:n+"-bg",zIndex:-1,attrs:T.mix({x:0,y:0,width:0,height:0},i)});r.sort(),this.container=r,this.textShape=a,this.backgroundShape=o}_getBBox(){const t=this.textShape,e=this.background,i=t.getBBox(),n=T.parsePadding(e.padding),s=i.width+n[1]+n[3],r=i.height+n[0]+n[2];return{x:i.minX-n[3],y:i.minY-n[0],width:s,height:r}}updateContent(t){const{textShape:e,backgroundShape:i}=this;if(!T.isNil(t)){T.isObject(t)||(t={text:t}),e.attr(t);const{x:n,y:s,width:r,height:a}=this._getBBox(),o=this.width||r,l=this.height||a;i.attr({x:n,y:s,width:o,height:l}),this._width=o,this._height=l,this.content=t.text}}updatePosition(t,e){const i=this.container,{x:n,y:s}=this._getBBox();i.moveTo(t-n,e-s),this.x=t-n,this.y=e-s}getWidth(){return this._width}getHeight(){return this._height}show(){this.container.show()}hide(){this.container.hide()}clear(){const t=this.container;t.clear(),t.remove(!0),this.container=null,this.textShape=null,this.backgroundShape=null}};var ii=class{getDefaultCfg(){return{showCrosshairs:!1,crosshairsStyle:{stroke:"rgba(0, 0, 0, 0.25)",lineWidth:1},crosshairsType:"y",showXTip:!1,showYTip:!1,xTip:null,xTipBackground:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},yTip:null,yTipBackground:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},background:null,layout:"horizontal",offsetX:0,offsetY:0}}constructor(t){T.deepMix(this,this.getDefaultCfg(),t);const{frontPlot:e,custom:i}=this;if(!i){const i=new Qe(T.mix({parent:e,zIndex:3},t));this.container=i;const{fixed:n,background:s}=this;n||(this.tooltipArrow=e.addShape("Polygon",{className:"tooltip-arrow",visible:!1,zIndex:2,attrs:T.mix({points:[]},s)}))}if(this.showXTip){const{xTipBackground:t}=this,i=new ei({className:"xTip",background:t,visible:!1});e.add(i.container),this.xTipBox=i}if(this.showYTip){const{yTipBackground:t}=this,i=new ei({className:"yTip",background:t,visible:!1});e.add(i.container),this.yTipBox=i}this.showCrosshairs&&this._renderCrosshairs(),e.sort()}setContent(t,e){if(this.title=t,this.items=e,!this.custom){const i=this.container;i.setTitle(t),i.setItems(e)}}setYTipContent(t){const e=this.yTip;t=T.isFunction(e)?e(t):T.mix({text:t},e),this.yTipBox&&this.yTipBox.updateContent(t)}setYTipPosition(t){const e=this.plotRange,i=this.crosshairsShapeX;if(this.showYTip){const n=this.yTipBox,s=n.getHeight(),r=n.getWidth();let a=e.tl.x-r,o=t-s/2;o<=e.tl.y&&(o=e.tl.y),o+s>=e.br.y&&(o=e.br.y-s),a<0&&(a=e.tl.x,i&&i.attr("x1",e.tl.x+r)),n.updatePosition(a,o)}}setXTipContent(t){const e=this.xTip;t=T.isFunction(e)?e(t):T.mix({text:t},e),this.xTipBox&&this.xTipBox.updateContent(t)}setXTipPosition(t){const{showXTip:e,canvas:i,plotRange:n,xTipBox:s,crosshairsShapeY:r}=this;if(e){const e=i.get("height"),a=s.getWidth(),o=s.getHeight();let l=t-a/2,h=n.br.y;l<=n.tl.x&&(l=n.tl.x),l+a>=n.tr.x&&(l=n.tr.x-a),e-h<o&&(h-=o),s.updatePosition(l,h),r&&r.attr("y1",h)}}setXCrosshairPosition(t){this.crosshairsShapeX&&this.crosshairsShapeX.moveTo(0,t)}setYCrosshairPosition(t){this.crosshairsShapeY&&this.crosshairsShapeY.moveTo(t,0)}setPosition(t){const{container:e,plotRange:i,offsetX:n,offsetY:s,fixed:r,tooltipArrow:a}=this;if(!e)return;const o=e.container.getBBox(),{minX:l,minY:h,width:c,height:u}=o,{tl:g,tr:d}=i;let f=0;const p=g.y-u-4+s;if(r){f=(g.x+d.x)/2-c/2+n}else{let i;if(i=t.length>1?(t[0].x+t[t.length-1].x)/2:t[0].x,f=i-c/2+n,f<g.x&&(f=g.x),f+c>d.x&&(f=d.x-c),a){a.attr("points",[{x:i-3,y:g.y-4+s},{x:i+3,y:g.y-4+s},{x:i,y:g.y+s}]);const t=e.backShape,n=T.parsePadding(t.attr("radius"));i===g.x?(n[3]=0,a.attr("points",[{x:g.x,y:g.y+s},{x:g.x,y:g.y-4+s},{x:g.x+4,y:g.y-4+s}])):i===d.x&&(n[2]=0,a.attr("points",[{x:d.x,y:g.y+s},{x:d.x-4,y:g.y-4+s},{x:d.x,y:g.y-4+s}])),t.attr("radius",n)}}e.moveTo(f-l,p-h)}setMarkers(t={}){const{items:e,style:i,type:n}=t,s=this._getMarkerGroup(n);if("circle"===n)for(let t=0,n=e.length;t<n;t++){const n=e[t],r=new Je({className:"tooltip-circle-marker",attrs:T.mix({x:n.x,y:n.y,stroke:n.color},i)});s.add(r)}else s.addShape("rect",{className:"tooltip-rect-marker",attrs:i})}clearMarkers(){const t=this.markerGroup;t&&t.clear()}show(){const t=this.crosshairsShapeX,e=this.crosshairsShapeY,i=this.markerGroup,n=this.container,s=this.tooltipArrow,r=this.xTipBox,a=this.yTipBox,o=this.canvas;t&&t.show(),e&&e.show(),i&&i.show(),n&&n.show(),s&&s.show(),r&&r.show(),a&&a.show(),o.draw()}hide(){const t=this.crosshairsShapeX,e=this.crosshairsShapeY,i=this.markerGroup,n=this.container,s=this.tooltipArrow,r=this.xTipBox,a=this.yTipBox;t&&t.hide(),e&&e.hide(),i&&i.hide(),n&&n.hide(),s&&s.hide(),r&&r.hide(),a&&a.hide()}destroy(){const t=this.crosshairsShapeX,e=this.crosshairsShapeY,i=this.markerGroup,n=this.container,s=this.tooltipArrow,r=this.xTipBox,a=this.yTipBox;t&&t.remove(!0),e&&e.remove(!0),i&&i.remove(!0),s&&s.remove(!0),n&&n.clear(),r&&r.clear(),a&&a.clear(),this.destroyed=!0}_getMarkerGroup(t){let e=this.markerGroup;return e?e.clear():("circle"===t?(e=this.frontPlot.addGroup({zIndex:1}),this.frontPlot.sort()):e=this.backPlot.addGroup(),this.markerGroup=e),e}_renderCrosshairs(){const{crosshairsType:t,crosshairsStyle:e,frontPlot:i,plotRange:n}=this,{tl:s,br:r}=n;T.directionEnabled(t,"x")&&(this.crosshairsShapeX=i.addShape("Line",{className:"tooltip-crosshairs-x",zIndex:0,visible:!1,attrs:T.mix({x1:s.x,y1:0,x2:r.x,y2:0},e)})),T.directionEnabled(t,"y")&&(this.crosshairsShapeY=i.addShape("Line",{className:"tooltip-crosshairs-y",zIndex:0,visible:!1,attrs:T.mix({x1:0,y1:r.y,x2:0,y2:s.y},e)}))}};function ni(t){const e=t.getAttr("color");if(e){const t=e.getScale(e.type);if(t.isLinear)return t}const i=t.getXScale(),n=t.getYScale();return n||i}function si(t,e){let i,n;const s=t._getGroupScales();if(s.length&&T.each(s,(function(t){return n=t,!1})),n){const t=n.field;i=n.getText(e[t])}else{const e=ni(t);i=e.alias||e.field}return i}function ri(t,e){const i=ni(t);return i.getText(e[i.field])}function ai(t,e){const i=t.getAttr("position").getFields()[0],n=t.get("scales")[i];return n.getText(e[n.field])}function oi(t){const e=[];return T.each(t,(function(t){const i=function(t,e){let i=-1;return T.each(t,(function(t,n){if(t.title===e.title&&t.name===e.name&&t.value===e.value&&t.color===e.color)return i=n,!1})),i}(e,t);-1===i?e.push(t):e[i]=t})),e}E.tooltip=T.deepMix({triggerOn:"press",triggerOff:"pressend",alwaysShow:!1,showTitle:!1,showCrosshairs:!1,crosshairsStyle:{stroke:"rgba(0, 0, 0, 0.25)",lineWidth:1},showTooltipMarker:!0,background:{radius:1,fill:"rgba(0, 0, 0, 0.65)",padding:[3,5]},titleStyle:{fontSize:12,fill:"#fff",textAlign:"start",textBaseline:"top"},nameStyle:{fontSize:12,fill:"rgba(255, 255, 255, 0.65)",textAlign:"start",textBaseline:"middle"},valueStyle:{fontSize:12,fill:"#fff",textAlign:"start",textBaseline:"middle"},showItemMarker:!0,itemMarkerStyle:{radius:3,symbol:"circle",lineWidth:1,stroke:"#fff"},layout:"horizontal",snap:!1},E.tooltip||{});class li{constructor(t){this.enable=!0,this.cfg={},this.tooltip=null,this.chart=null,this.timeStamp=0,T.mix(this,t);const e=this.chart.get("canvas");this.canvas=e,this.canvasDom=e.get("el")}_setCrosshairsCfg(){const t=this.chart,e=T.mix({},E.tooltip),i=t.get("geoms"),n=[];T.each(i,t=>{const e=t.get("type");-1===n.indexOf(e)&&n.push(e)});const s=t.get("coord").type;return!i.length||"cartesian"!==s&&"rect"!==s||1===n.length&&-1!==["line","area","path","point"].indexOf(n[0])&&T.mix(e,{showCrosshairs:!0}),e}_getMaxLength(t={}){const{layout:e,plotRange:i}=t;return"horizontal"===e?i.br.x-i.bl.x:i.bl.y-i.tr.y}render(){if(this.tooltip)return;const t=this.chart,e=t.get("canvas"),i=t.get("frontPlot").addGroup({className:"tooltipContainer",zIndex:10}),n=t.get("backPlot").addGroup({className:"tooltipContainer"}),s=t.get("plotRange"),r=t.get("coord"),a=this._setCrosshairsCfg(),o=this.cfg,l=T.deepMix({plotRange:s,frontPlot:i,backPlot:n,canvas:e,fixed:r.transposed||r.isPolar},a,o);l.maxLength=this._getMaxLength(l),this._tooltipCfg=l;const h=new ii(l);this.tooltip=h,this.bindEvents()}clear(){const t=this.tooltip;t&&(t.destroy(),this.unBindEvents()),this.tooltip=null,this.prePoint=null,this._lastActive=null}_getTooltipMarkerStyle(t={}){const{type:e,items:i}=t,n=this._tooltipCfg;if("rect"===e){let e,s,r,a;const o=this.chart,{tl:l,br:h}=o.get("plotRange"),c=o.get("coord"),u=i[0],g=i[i.length-1],d=u.width;c.transposed?(e=l.x,s=g.y-.75*d,r=h.x-l.x,a=u.y-g.y+1.5*d):(e=u.x-.75*d,s=l.y,r=g.x-u.x+1.5*d,a=h.y-l.y),t.style=T.mix({x:e,y:s,width:r,height:a,fill:"#CCD6EC",opacity:.3},n.tooltipMarkerStyle)}else t.style=T.mix({radius:4,fill:"#fff",lineWidth:2},n.tooltipMarkerStyle);return t}_setTooltip(t,e,i={}){const n=this._lastActive,s=this.tooltip,r=this._tooltipCfg;e=oi(e);const a=this.chart,o=a.get("coord"),l=a.getYScales()[0],h=r.snap;if(!1===h&&l.isLinear){const e=o.invertPoint(t),i=a.get("plotRange");let n,r;me.isPointInPlot(t,i)&&(o.transposed?(n=l.invert(e.x),r=t.x,s.setXTipContent(n),s.setXTipPosition(r),s.setYCrosshairPosition(r)):(n=l.invert(e.y),r=t.y,s.setYTipContent(n),s.setYTipPosition(r),s.setXCrosshairPosition(r)))}if(r.onShow&&r.onShow({x:t.x,y:t.y,tooltip:s,items:e,tooltipMarkerCfg:i}),c=n,u=e,JSON.stringify(c)===JSON.stringify(u)){if(!1===h&&(T.directionEnabled(r.crosshairsType,"y")||r.showYTip)){this.chart.get("canvas").draw()}return}var c,u;this._lastActive=e;const g=r.onChange;g&&g({x:t.x,y:t.y,tooltip:s,items:e,tooltipMarkerCfg:i});const d=e[0],f=d.title||d.name;let p=d.x;if(e.length>1&&(p=(e[0].x+e[e.length-1].x)/2),s.setContent(f,e,o.transposed),s.setPosition(e,t),o.transposed){let t=d.y;e.length>1&&(t=(e[0].y+e[e.length-1].y)/2),s.setYTipContent(f),s.setYTipPosition(t),s.setXCrosshairPosition(t),h&&(s.setXTipContent(d.value),s.setXTipPosition(p),s.setYCrosshairPosition(p))}else s.setXTipContent(f),s.setXTipPosition(p),s.setYCrosshairPosition(p),h&&(s.setYTipContent(d.value),s.setYTipPosition(d.y),s.setXCrosshairPosition(d.y));const m=i.items;r.showTooltipMarker&&m.length?(i=this._getTooltipMarkerStyle(i),s.setMarkers(i)):s.clearMarkers(),s.show()}showTooltip(t){const e=this,i=e.chart;let n;const s=[],r=[],a=e._tooltipCfg;let o;a.showItemMarker&&(o=a.itemMarkerStyle);const l=i.get("geoms"),h=i.get("coord");if(T.each(l,e=>{if(e.get("visible")){const i=e.get("type"),a=e.getSnapRecords(t),l=e.get("adjust");if("interval"===i&&l&&"symmetric"===l.type)return;T.each(a,t=>{if(t.x&&t.y){const{x:a,y:l,_origin:c,color:u}=t,g={x:a,y:T.isArray(l)?l[1]:l,color:u||E.defaultColor,origin:c,name:si(e,c),value:ri(e,c),title:ai(e,c)};o&&(g.marker=T.mix({fill:u||E.defaultColor},o)),r.push(g),-1!==["line","area","path"].indexOf(i)?(n="circle",s.push(g)):"interval"!==i||"cartesian"!==h.type&&"rect"!==h.type||(n="rect",g.width=e.getSize(t._origin),s.push(g))}})}}),r.length){const i={items:s,type:n};e._setTooltip(t,r,i)}else e.hideTooltip()}hideTooltip(){const t=this._tooltipCfg;this._lastActive=null;const e=this.tooltip;if(e){e.hide(),t.onHide&&t.onHide({tooltip:e}),this.chart.get("canvas").draw()}}handleShowEvent=t=>{const e=this.chart;if(!this.enable)return;const i=e.get("plotRange"),n=T.createEvent(t,e);if(!me.isPointInPlot(n,i)&&!this._tooltipCfg.alwaysShow)return void this.hideTooltip();const s=this.timeStamp,r=+new Date;r-s>16&&(this.showTooltip(n),this.timeStamp=r)};handleHideEvent=()=>{this.enable&&this.hideTooltip()};_handleEvent(t,e,i){const n=this.canvas;T.each([].concat(t),t=>{"bind"===i?n.on(t,e):n.off(t,e)})}bindEvents(){const t=this._tooltipCfg,{triggerOn:e,triggerOff:i,alwaysShow:n}=t;e&&this._handleEvent(e,this.handleShowEvent,"bind"),n||this._handleEvent(i,this.handleHideEvent,"bind")}unBindEvents(){const t=this._tooltipCfg,{triggerOn:e,triggerOff:i,alwaysShow:n}=t;e&&this._handleEvent(e,this.handleShowEvent,"unBind"),n||this._handleEvent(i,this.handleHideEvent,"unBind")}}var hi={init(t){const e=new li({chart:t});t.set("tooltipController",e),t.tooltip=function(t,i){return T.isObject(t)&&(i=t,t=!0),e.enable=t,i&&(e.cfg=i),this}},afterGeomDraw(t){const e=t.get("tooltipController");e.render(),t.showTooltip=function(t){return e.showTooltip(t),this},t.hideTooltip=function(){return e.hideTooltip(),this}},clearInner(t){t.get("tooltipController").clear()}};E.guide=T.deepMix({line:{style:{stroke:"#a3a3a3",lineWidth:1},top:!0},text:{style:{fill:"#787878",textAlign:"center",textBaseline:"middle"},offsetX:0,offsetY:0,top:!0},rect:{style:{fill:"#fafafa"},top:!1},arc:{style:{stroke:"#a3a3a3"},top:!0},html:{offsetX:0,offsetY:0,alignX:"center",alignY:"middle"},tag:{top:!0,offsetX:0,offsetY:0,side:4,background:{padding:5,radius:2,fill:"#1890FF"},textStyle:{fontSize:12,fill:"#fff",textAlign:"center",textBaseline:"middle"}},point:{top:!0,offsetX:0,offsetY:0,style:{fill:"#fff",r:3,lineWidth:2,stroke:"#1890ff"}}},E.guide||{});class ci{constructor(t){this.guides=[],this.xScale=null,this.yScales=null,this.guideShapes=[],T.mix(this,t)}_toString(t){return T.isFunction(t)&&(t=t(this.xScale,this.yScales)),t=t.toString()}_getId(t,e){let i=e.id;if(!i){const t=e.type;i="arc"===t||"line"===t||"rect"===t?this._toString(e.start)+"-"+this._toString(e.end):this._toString(e.position)}return i}paint(t){const e=this,{chart:i,guides:n,xScale:s,yScales:r}=e,a=[];T.each(n,(function(n,o){let l;n.xScale=s,n.yScales=r,"regionFilter"===n.type?n.chart=i:l=n.top?e.frontPlot:e.backPlot,n.coord=t,n.container=l,n.canvas=i.get("canvas");const h=n.render(t,l);if(h){const t=e._getId(h,n);[].concat(h).forEach(e=>{e._id=e.get("className")+"-"+t,e.set("index",o),a.push(e)})}})),e.guideShapes=a}clear(){return this.reset(),this.guides=[],this}reset(){const t=this.guides;T.each(t,t=>{t.remove()})}_createGuide(t,e){const i=T.upperFirst(t),n=new He[i](T.deepMix({},E.guide[t],e));return this.guides.push(n),n}line(t={}){return this._createGuide("line",t)}text(t={}){return this._createGuide("text",t)}arc(t={}){return this._createGuide("arc",t)}html(t={}){return this._createGuide("html",t)}rect(t={}){return this._createGuide("rect",t)}tag(t={}){return this._createGuide("tag",t)}point(t={}){return this._createGuide("point",t)}regionFilter(t={}){return this._createGuide("regionFilter",t)}}var ui={init(t){const e=new ci({frontPlot:t.get("frontPlot").addGroup({zIndex:20,className:"guideContainer"}),backPlot:t.get("backPlot").addGroup({className:"guideContainer"})});t.set("guideController",e),t.guide=function(){return e}},afterGeomDraw(t){const e=t.get("guideController");if(!e.guides.length)return;const i=t.getXScale(),n=t.getYScales(),s=t.get("coord");e.xScale=i,e.yScales=n,e.chart=t,e.paint(s)},clear(t){t.get("guideController").clear()},repaint(t){t.get("guideController").reset()}};const gi={itemMarginBottom:12,itemGap:10,showTitle:!1,titleStyle:{fontSize:12,fill:"#808080",textAlign:"start",textBaseline:"top"},nameStyle:{fill:"#808080",fontSize:12,textAlign:"start",textBaseline:"middle"},valueStyle:{fill:"#000000",fontSize:12,textAlign:"start",textBaseline:"middle"},unCheckStyle:{fill:"#bfbfbf"},itemWidth:"auto",wordSpace:6,selectedMode:"multiple"};E.legend=T.deepMix({common:gi,right:T.mix({position:"right",layout:"vertical"},gi),left:T.mix({position:"left",layout:"vertical"},gi),top:T.mix({position:"top",layout:"horizontal"},gi),bottom:T.mix({position:"bottom",layout:"horizontal"},gi)},E.legend||{});class di{constructor(t){this.legendCfg={},this.enable=!0,this.position="top",T.mix(this,t);const e=this.chart;this.canvasDom=e.get("canvas").get("el"),this.clear()}addLegend(t,e,i){const n=this,s=n.legendCfg,r=t.field,a=s[r];if(!1===a)return null;if(a&&a.custom)n.addCustomLegend(r);else{let r=s.position||n.position;a&&a.position&&(r=a.position),t.isCategory&&n._addCategoryLegend(t,e,r,i)}}addCustomLegend(t){let e=this.legendCfg;t&&e[t]&&(e=e[t]);const i=e.position||this.position,n=this.legends;n[i]=n[i]||[];const s=e.items;if(!s)return null;const r=this.container;T.each(s,t=>{T.isPlainObject(t.marker)?t.marker.radius=t.marker.radius||3:t.marker={symbol:t.marker||"circle",fill:t.fill,radius:3},t.checked=!!T.isNil(t.checked)||t.checked,t.name=t.name||t.value});const a=new Qe(T.deepMix({},E.legend[i],e,{maxLength:this._getMaxLength(i),items:s,parent:r}));n[i].push(a)}clear(){const t=this.legends;T.each(t,t=>{T.each(t,t=>{t.clear()})}),this.legends={},this.unBindEvents()}_isFiltered(t,e,i){let n=!1;return T.each(e,e=>{if(n=n||t.getText(e)===t.getText(i),n)return!1}),n}_getMaxLength(t){const e=this.chart,i=T.parsePadding(e.get("appendPadding"));return"right"===t||"left"===t?e.get("height")-(i[0]+i[2]):e.get("width")-(i[1]+i[3])}_addCategoryLegend(t,e,i,n){const s=this,{legendCfg:r,legends:a,container:o,chart:l}=s,h=t.field;a[i]=a[i]||[];let c="circle";r[h]&&r[h].marker?c=r[h].marker:r.marker&&(c=r.marker),T.each(e,e=>{T.isPlainObject(c)?T.mix(e.marker,c):e.marker.symbol=c,n&&(e.checked=!s._isFiltered(t,n,e.dataValue))}),l.get("legendItems")[h]=e;const u=T.deepMix({},E.legend[i],r[h]||r,{maxLength:s._getMaxLength(i),items:e,field:h,filteredVals:n,parent:o});u.showTitle&&T.deepMix(u,{title:t.alias||t.field});const g=new Qe(u);return a[i].push(g),g}_alignLegend(t,e,i){const{tl:n,bl:s}=this.plotRange,r=this.chart;let a=t.offsetX||0,o=t.offsetY||0;const l=r.get("width"),h=r.get("height"),c=T.parsePadding(r.get("appendPadding")),u=t.getHeight(),g=t.getWidth();let d=0,f=0;if("left"===i||"right"===i){const r=t.verticalAlign||"middle",a=Math.abs(n.y-s.y);d="left"===i?c[3]:l-g-c[1],f=(a-u)/2+n.y,"top"===r?f=n.y:"bottom"===r&&(f=s.y-u),e&&(f=e.get("y")-u-12)}else{const n=t.align||"left";if(d=c[3],"center"===n?d=l/2-g/2:"right"===n&&(d=l-(g+c[1])),f="top"===i?c[0]+Math.abs(t.container.getBBox().minY):h-u,e){const t=e.getWidth();d=e.x+t+12}}"bottom"===i&&o>0&&(o=0),"right"===i&&a>0&&(a=0),t.moveTo(d+a,f+o)}alignLegends(){const t=this,e=t.legends;return T.each(e,(e,i)=>{T.each(e,(n,s)=>{const r=e[s-1];t._alignLegend(n,r,i)})}),t}handleEvent=t=>{const e=this;const i=e.chart,{x:n,y:s}=T.createEvent(t,i),r=function(t,i){let n=null;const s=e.legends;return T.each(s,e=>{T.each(e,e=>{const{itemsGroup:s,legendHitBoxes:r}=e,a=s.get("children");if(a.length){const s=e.x,o=e.y;T.each(r,(r,l)=>{if(t>=r.x+s&&t<=r.x+r.width+s&&i>=r.y+o&&i<=r.height+r.y+o)return n={clickedItem:a[l],clickedLegend:e},!1})}})}),n}(n,s);if(r&&!1!==r.clickedLegend.clickable){const{clickedItem:e,clickedLegend:n}=r;if(n.onClick)t.clickedItem=e,n.onClick(t);else if(!n.custom){const t=e.get("checked"),s=e.get("dataValue"),{filteredVals:r,field:a,selectedMode:o}=n;"single"===o?i.filter(a,t=>t===s):(t?r.push(s):T.Array.remove(r,s),i.filter(a,t=>-1===r.indexOf(t))),i.repaint()}}};bindEvents(){const t=this.legendCfg.triggerOn||"touchstart";T.addEventListener(this.canvasDom,t,this.handleEvent)}unBindEvents(){const t=this.legendCfg.triggerOn||"touchstart";T.removeEventListener(this.canvasDom,t,this.handleEvent)}}var fi={init(t){const e=new di({container:t.get("backPlot"),plotRange:t.get("plotRange"),chart:t});t.set("legendController",e),t.legend=function(t,i){let n=e.legendCfg;return e.enable=!0,T.isBoolean(t)?(e.enable=t,n=i||{}):T.isObject(t)?n=t:n[t]=i,e.legendCfg=n,this}},beforeGeomDraw(t){const e=t.get("legendController");if(!e.enable)return null;const i=e.legendCfg;if(i&&i.custom)e.addCustomLegend();else{const i=t.getLegendItems(),n=t.get("scales"),s=t.get("filters");T.each(i,(t,i)=>{const r=n[i],a=r.values;let o;o=s&&s[i]?a.filter(t=>!s[i](t)):[],e.addLegend(r,t,o)})}i&&!1!==i.clickable&&e.bindEvents();const n=e.legends,s={top:0,right:0,bottom:0,left:0};T.each(n,(e,i)=>{let n=0;T.each(e,t=>{const e=t.getWidth(),s=t.getHeight();"top"===i||"bottom"===i?(n=Math.max(n,s),t.offsetY>0&&(n+=t.offsetY)):(n=Math.max(n,e),t.offsetX>0&&(n+=t.offsetX))}),s[i]=n+function(t,e){let i=0;switch(e=T.parsePadding(e),t){case"top":i=e[0];break;case"right":i=e[1];break;case"bottom":i=e[2];break;case"left":i=e[3]}return i}(i,t.get("appendPadding"))}),t.set("legendRange",s)},afterGeomDraw(t){t.get("legendController").alignLegends()},clearInner(t){t.get("legendController").clear(),t.set("legendRange",null)}};const{requestAnimationFrame:pi}=Ht,mi="object"==typeof performance&&performance.now?performance:Date;var xi=class{constructor(){this.anims=[],this.time=null,this.playing=!1,this.canvas=[]}play(){const t=this;t.time=mi.now(),t.playing=!0,pi((function e(){t.playing&&(pi(e),t.update())}))}stop(){this.playing=!1,this.time=null,this.canvas=[]}update(){const t=mi.now();this.canvas=[];for(let e=0;e<this.anims.length;e++){const i=this.anims[e];if(t<i.startTime||i.hasEnded)continue;const n=i.shape;if(n.get("destroyed")){this.anims.splice(e,1),e--;continue}const{startState:s,endState:r,interpolate:a,duration:o}=i;t>=i.startTime&&!i.hasStarted&&(i.hasStarted=!0,i.onStart&&i.onStart());let l=(t-i.startTime)/o;if(l=Math.max(0,Math.min(l,1)),l=i.easing(l),i.onFrame)i.onFrame(l);else for(const t in a){const e=(0,a[t])(l);let i;if("points"===t){i=[];const t=Math.max(s.points.length,r.points.length);for(let n=0;n<t;n+=2)i.push({x:e[n],y:e[n+1]})}else i=e;n._attrs.attrs[t]=i,n._attrs.bbox=null}const h=n.get("canvas");-1===this.canvas.indexOf(h)&&this.canvas.push(h),i.onUpdate&&i.onUpdate(l),t>=i.endTime&&!i.hasEnded&&(i.hasEnded=!0,i.onEnd&&i.onEnd()),1===l&&(this.anims.splice(e,1),e--)}this.canvas.map(t=>(t.draw(),t)),this.time=mi.now()}};const yi={linear:t=>t,quadraticIn:t=>t*t,quadraticOut:t=>t*(2-t),quadraticInOut:t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1),cubicIn:t=>t*t*t,cubicOut:t=>--t*t*t+1,cubicInOut:t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2),elasticIn(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4/(2*Math.PI)*Math.asin(1/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut(t){let e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut(t){let e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=n/(2*Math.PI)*Math.asin(1/i),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},backIn(t){const e=1.70158;return t*t*((e+1)*t-e)},backOut(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},backInOut(t){const e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:t=>1-yi.bounceOut(1-t),bounceOut:t=>(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,bounceInOut:t=>t<.5?.5*yi.bounceIn(2*t):.5*yi.bounceOut(2*t-1)+.5};var vi=yi;function _i(t){const e=[];for(let i=0,n=t.length;i<n;i++)t[i]&&(e.push(t[i].x),e.push(t[i].y));return e}function Si(t,e){return e-=t=+t,function(i){return t+e*i}}function bi(t,e){const i=e?e.length:0,n=t?Math.min(i,t.length):0,s=new Array(n),r=new Array(i);let a;for(a=0;a<n;++a)s[a]=Si(t[a],e[a]);for(;a<i;++a)r[a]=e[a];return function(t){for(a=0;a<n;++a)r[a]=s[a](t);return r}}var Ci=class{constructor(t,e,i){this.hasStarted=!1,this.hasEnded=!1,this.shape=t,this.source=e,this.timeline=i,this.animate=null}to(t={}){const e=t.delay||0,i=t.attrs||{},n=t.duration||1e3;let s;s="function"==typeof t.easing?t.easing:vi[t.easing]||vi.linear;const r={shape:this.shape,startTime:this.timeline.time+e,duration:n,easing:s},a={};for(const t in i){let e=this.source[t],n=i[t];"points"===t?(e=_i(e),n=_i(n),a.points=bi(e,n),this.source.points=e,i.points=n):"matrix"===t?a.matrix=bi(e,n):a[t]=Si(e,n)}return r.interpolate=a,r.startState=this.source,r.endState=i,r.endTime=r.startTime+n,this.timeline.anims.push(r),this.animate=r,this}onFrame(t){return this.animate&&(this.animate.onFrame=function(e){t(e)}),this}onStart(t){return this.animate&&(this.animate.onStart=function(){t()}),this}onUpdate(t){return this.animate&&(this.animate.onUpdate=function(e){t(e)}),this}onEnd(t){return this.animate&&(this.animate.onEnd=function(){t()}),this}};const Pi={appear:{duration:450,easing:"quadraticOut"},update:{duration:300,easing:"quadraticOut"},enter:{duration:300,easing:"quadraticOut"},leave:{duration:350,easing:"quadraticIn"}};var Mi={defaultCfg:{},Action:{},getAnimation(t,e,i){const n=this.defaultCfg[t];if(n){const t=n[i];if(T.isFunction(t))return t(e)}return!1},getAnimateCfg(t,e){const i=Pi[e],n=this.defaultCfg[t];return n&&n.cfg&&n.cfg[e]?T.deepMix({},i,n.cfg[e]):i},registerAnimation(t,e){this.Action||(this.Action={}),this.Action[t]=e}};const{Matrix:wi}=ge,Ti={getCoordInfo(t){const e=t.start,i=t.end;return{start:e,end:i,width:i.x-e.x,height:Math.abs(i.y-e.y)}},getScaledMatrix(t,e,i){let n;t.apply(e);const s=e[0],r=e[1];if("x"===i){t.transform([["t",s,r],["s",.01,1],["t",-s,-r]]);const e=t.getMatrix();n=wi.transform(e,[["t",s,r],["s",100,1],["t",-s,-r]])}else if("y"===i){t.transform([["t",s,r],["s",1,.01],["t",-s,-r]]);const e=t.getMatrix();n=wi.transform(e,[["t",s,r],["s",1,100],["t",-s,-r]])}else if("xy"===i){t.transform([["t",s,r],["s",.01,.01],["t",-s,-r]]);const e=t.getMatrix();n=wi.transform(e,[["t",s,r],["s",100,100],["t",-s,-r]])}return n},getAnimateParam(t,e,i){const n={};return t.delay&&(n.delay=T.isFunction(t.delay)?t.delay(e,i):t.delay),n.easing=t.easing,n.duration=t.duration,n.delay=t.delay,n},doAnimation(t,e,i,n){const s=t._id,r=t.get("index"),{easing:a,delay:o,duration:l}=Ti.getAnimateParam(i,r,s),h=t.animate().to({attrs:e,duration:l,delay:o,easing:a});n&&h.onEnd(()=>{n()})}};var Ai=Ti;var Di={fadeIn:function(t,e){const i=T.isNil(t.attr("fillOpacity"))?1:t.attr("fillOpacity"),n=T.isNil(t.attr("strokeOpacity"))?1:t.attr("strokeOpacity");t.attr("fillOpacity",0),t.attr("strokeOpacity",0);const s={fillOpacity:i,strokeOpacity:n};Ai.doAnimation(t,s,e)}};const{Shape:ki}=ge;function Ei(t,e,i,n,s){const{start:r,end:a,width:o,height:l}=Ai.getCoordInfo(i);let h,c;const u=new ki.Rect({attrs:{x:r.x,y:a.y,width:o,height:l}});"y"===s?(h=r.x+o/2,c=n.y<r.y?n.y:r.y):"x"===s?(h=n.x>r.x?n.x:r.x,c=r.y+l/2):"xy"===s&&(i.isPolar?(h=i.center.x,c=i.center.y):(h=(r.x+a.x)/2,c=(r.y+a.y)/2));const g=Ai.getScaledMatrix(u,[h,c],s);u.isClip=!0,u.endState={matrix:g},u.set("canvas",t.get("canvas")),t.attr("clip",u);Ai.doAnimation(u,u.endState,e,(function(){t.attr("clip",null),u.remove(!0)}))}function Ii(t,e,i){const n=t.get("children");let s,r,a;for(let t=0,o=n.length;t<o;t++){const o=n[t],l=o.getBBox();s=(l.minX+l.maxX)/2,r=(l.minY+l.maxY)/2,a=Ai.getScaledMatrix(o,[s,r],i),Ai.doAnimation(o,{matrix:a},e)}}var Oi={groupWaveIn:function(t,e,i){const n=me.getClip(i);n.set("canvas",t.get("canvas")),t.attr("clip",n);const s={};if(i.isPolar){const{startAngle:t,endAngle:e}=i;s.endAngle=e,n.attr("endAngle",t)}else{const{start:t,end:e}=i,r=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);i.isTransposed?(n.attr("height",0),s.height=a):(n.attr("width",0),s.width=r)}Ai.doAnimation(n,s,e,(function(){t.attr("clip",null),n.remove(!0)}))},groupScaleInX:function(t,e,i,n){Ei(t,e,i,n,"x")},groupScaleInY:function(t,e,i,n){Ei(t,e,i,n,"y")},groupScaleInXY:function(t,e,i,n){Ei(t,e,i,n,"xy")},shapesScaleInX:function(t,e){Ii(t,e,"x")},shapesScaleInY:function(t,e){Ii(t,e,"y")},shapesScaleInXY:function(t,e){Ii(t,e,"xy")}};let Yi;Lt.prototype.animate=function(){const t=T.mix({},this.get("attrs"));return new Ci(this,t,Yi)},ve.prototype.animate=function(t){return this.set("animate",t),this},Mi.Action=Di,Mi.defaultCfg={interval:{enter:t=>t.isPolar&&t.transposed?function(t){t.set("zIndex",-1),t.get("parent").sort()}:Di.fadeIn},area:{enter:t=>t.isPolar?null:Di.fadeIn},line:{enter:t=>t.isPolar?null:Di.fadeIn},path:{enter:t=>t.isPolar?null:Di.fadeIn}};const Fi={line:t=>t.isPolar?Oi.groupScaleInXY:Oi.groupWaveIn,area:t=>t.isPolar?Oi.groupScaleInXY:Oi.groupWaveIn,path:t=>t.isPolar?Oi.groupScaleInXY:Oi.groupWaveIn,point:()=>Oi.shapesScaleInXY,interval(t){let e;return t.isPolar?(e=Oi.groupScaleInXY,t.transposed&&(e=Oi.groupWaveIn)):e=t.transposed?Oi.groupScaleInX:Oi.groupScaleInY,e},schema:()=>Oi.groupWaveIn};function Ni(t,e,i){const n=[];return T.each(t,(t,s)=>{const r=t.get("container").get("children"),a=t.get("type"),o=T.isNil(t.get("animateCfg"))?zi(a,e):t.get("animateCfg");!1!==o&&T.each(r,(e,r)=>{e.get("className")===a&&(e._id=function(t,e,i){const n=t.get("type");let s="geom"+i+"-"+n;const r=t.getXScale(),a=t.getYScale(),o=r.field||"x",l=a.field||"y",h=e[l];let c;c=r.isIdentity?r.value:e[o],s+="interval"===n||"schema"===n?"-"+c:"line"===n||"area"===n||"path"===n?"-"+n:r.isCategory?"-"+c:"-"+c+"-"+h;const u=t._getGroupScales();return T.each(u,t=>{const i=t.field;"identity"!==t.type&&(s+="-"+e[i])}),s}(t,e.get("origin")._origin,s),e.set("coord",i),e.set("animateCfg",o),e.set("index",r),n.push(e))}),t.set("shapes",r)}),n}function Bi(t,e,i,n){let s;return s=T.isFunction(n)?n:T.isString(n)?Mi.Action[n]:Mi.getAnimation(t,e,i),s}function Xi(t,e,i){if(!1===i||T.isObject(i)&&!1===i[e])return!1;const n=Mi.getAnimateCfg(t,e);return i&&i[e]?T.deepMix({},n,i[e]):n}function Li(t,e,i){let n,s;const r=[],a=[];T.each(e,e=>{const i=t[e._id];i?(e.set("cacheShape",i),r.push(e),delete t[e._id]):a.push(e)}),T.each(t,t=>{const{className:e,coord:r,_id:a,attrs:o,index:l,type:h}=t;if(s=Xi(e,"leave",t.animateCfg),!1===s)return!0;if(n=Bi(e,r,"leave",s.animation),T.isFunction(n)){const t=i.addShape(h,{attrs:o,index:l,canvas:i,className:e});t._id=a,n(t,s,r)}}),T.each(r,t=>{const e=t.get("className");if(s=Xi(e,"update",t.get("animateCfg")),!1===s)return!0;const i=t.get("coord"),r=t.get("cacheShape").attrs,a=function(t,e){const i={};for(const n in e)(T.isNumber(t[n])&&t[n]!==e[n]||T.isArray(t[n])&&JSON.stringify(t[n])!==JSON.stringify(e[n]))&&(i[n]=e[n]);return i}(r,t._attrs.attrs);Object.keys(a).length&&(n=Bi(e,i,"update",s.animation),T.isFunction(n)?n(t,s,i):(t.attr(r),t.animate().to({attrs:a,duration:s.duration,easing:s.easing,delay:s.delay}).onEnd((function(){t.set("cacheShape",null)}))))}),T.each(a,t=>{const e=t.get("className"),i=t.get("coord");if(s=Xi(e,"enter",t.get("animateCfg")),!1===s)return!0;if(n=Bi(e,i,"enter",s.animation),T.isFunction(n))if("interval"===e&&i.isPolar&&i.transposed){const e=t.get("index"),i=r[e-1];n(t,s,i)}else n(t,s,i)})}function zi(t,e){if(!t)return null;const i=e.get("animate");return t.indexOf("guide-tag")>-1&&(t="guide-tag"),T.isObject(i)?i[t]:!1!==i&&null}var Ri={afterCanvasInit(){Yi=new xi,Yi.play()},beforeCanvasDraw(t){if(!1===t.get("animate"))return;let e=t.get("isUpdate");const i=t.get("canvas"),n=t.get("coord"),s=t.get("geoms"),r=i.get("caches")||[];0===r.length&&(e=!1);const a=Ni(s,t,n),{frontPlot:o,backPlot:l}=t.get("axisController"),h=o.get("children").concat(l.get("children"));let c=[];t.get("guideController")&&(c=t.get("guideController").guideShapes);const u=[];if(h.concat(c).forEach(e=>{const i=zi(e.get("className"),t);e.set("coord",n),e.set("animateCfg",i),u.push(e),a.push(e)}),i.set("caches",function(t){const e={};for(let i=0,n=t.length;i<n;i++){const n=t[i];if(!n._id||n.isClip)continue;const s=n._id;e[s]={_id:s,type:n.get("type"),attrs:T.mix({},n._attrs.attrs),className:n.get("className"),geomType:n.get("className"),index:n.get("index"),coord:n.get("coord"),animateCfg:n.get("animateCfg")}}return e}(a)),e)Li(r,a,i);else{let e,i;T.each(s,s=>{const r=s.get("type"),a=T.isNil(s.get("animateCfg"))?zi(r,t):s.get("animateCfg");if(!1!==a)if(e=Xi(r,"appear",a),i=Bi(r,n,"appear",e.animation),T.isFunction(i)){const t=s.get("shapes");T.each(t,t=>{i(t,e,n)})}else if(Fi[r]){i=Oi[e.animation]||Fi[r](n);const t=s.getYScale(),a=n.convertPoint({x:0,y:t.scale(s.getYMinValue())}),o=s.get("container");i&&i(o,e,n,a)}}),T.each(u,t=>{const e=t.get("animateCfg"),i=t.get("className");if(e&&e.appear){const s=Mi.getAnimateCfg(i,"appear"),r=T.deepMix({},s,e.appear),a=Bi(i,n,"appear",r.animation);T.isFunction(a)&&a(t,r,n)}})}},afterCanvasDestroyed(){Yi.stop()}},ji={getColDef(t,e){let i;return t.get("colDefs")&&t.get("colDefs")[e]&&(i=t.get("colDefs")[e]),i},getScale:(t,e)=>t.get("scales")[e],getFieldRange(t,e,i){if(!t)return[0,1];let n=0,s=0;if("linear"===i){const{min:i,max:r}=e;n=(t.min-i)/(r-i),s=(t.max-i)/(r-i)}else{const i=e,r=t.values||[],a=i.indexOf(r[0]),o=i.indexOf(r[r.length-1]);n=a/(i.length-1),s=o/(i.length-1)}return[n,s]},getLimitRange(t,e){let i;const{field:n,type:s}=e,r=T.Array.values(t,n);return"linear"===s?(i=T.Array.getRange(r),e.min<i.min&&(i.min=e.min),e.max>i.max&&(i.max=e.max)):"timeCat"===s?(T.each(r,(t,e)=>{r[e]=je(t)}),r.sort((function(t,e){return t-e})),i=r):i=r,i}};const Gi={mode:"x",xStyle:{backgroundColor:"rgba(202, 215, 239, .2)",fillerColor:"rgba(202, 215, 239, .5)",size:4,lineCap:"round",offsetX:0,offsetY:8},yStyle:{backgroundColor:"rgba(202, 215, 239, .2)",fillerColor:"rgba(202, 215, 239, .5)",size:4,lineCap:"round",offsetX:8,offsetY:0}};var Wi={init(t){t.set("_limitRange",{}),t.scrollBar=function(t){!0===t?t=Gi:T.isObject(t)&&(t=T.deepMix({},Gi,t)),this.set("_scrollBarCfg",t)}},clear(t){t.set("_limitRange",{})},changeData(t){t.set("_limitRange",{})},clearInner(t){const e=t.get("_horizontalBar"),i=t.get("_verticalBar");e&&e.remove(!0),i&&i.remove(!0),t.set("_horizontalBar",null),t.set("_verticalBar",null)},afterGeomDraw(t){const e=t.get("_scrollBarCfg");if(!e)return;const i=t.get("data"),n=t.get("plotRange"),s=t.get("backPlot"),r=t.get("canvas").get("height"),a=t.get("_limitRange"),o=e.mode;if(T.directionEnabled(o,"x")){const{offsetX:o,offsetY:l,lineCap:h,backgroundColor:c,fillerColor:u,size:g}=e.xStyle,d=t.getXScale();let f=a[d.field];f||(f=ji.getLimitRange(i,d),a[d.field]=f);const p=ji.getFieldRange(d,f,d.type);let m=t.get("_horizontalBar");const x=r-g/2+l;if(m){m.get("children")[1].attr({x1:Math.max(n.bl.x+n.width*p[0]+o,n.bl.x),x2:Math.min(n.bl.x+n.width*p[1]+o,n.br.x)})}else m=s.addGroup({className:"horizontalBar"}),m.addShape("line",{attrs:{x1:n.bl.x+o,y1:x,x2:n.br.x+o,y2:x,lineWidth:g,stroke:c,lineCap:h}}),m.addShape("line",{attrs:{x1:Math.max(n.bl.x+n.width*p[0]+o,n.bl.x),y1:x,x2:Math.min(n.bl.x+n.width*p[1]+o,n.br.x),y2:x,lineWidth:g,stroke:u,lineCap:h}}),t.set("_horizontalBar",m)}if(T.directionEnabled(o,"y")){const{offsetX:r,offsetY:o,lineCap:l,backgroundColor:h,fillerColor:c,size:u}=e.yStyle,g=t.getYScales()[0];let d=a[g.field];d||(d=ji.getLimitRange(i,g),a[g.field]=d);const f=ji.getFieldRange(g,d,g.type);let p=t.get("_verticalBar");const m=u/2+r;if(p){p.get("children")[1].attr({y1:Math.max(n.tl.y+n.height*f[0]+o,n.tl.y),y2:Math.min(n.tl.y+n.height*f[1]+o,n.bl.y)})}else p=s.addGroup({className:"verticalBar"}),p.addShape("line",{attrs:{x1:m,y1:n.tl.y+o,x2:m,y2:n.bl.y+o,lineWidth:u,stroke:h,lineCap:l}}),p.addShape("line",{attrs:{x1:m,y1:Math.max(n.tl.y+n.height*f[0]+o,n.tl.y),x2:m,y2:Math.min(n.tl.y+n.height*f[1]+o,n.bl.y),lineWidth:u,stroke:c,lineCap:l}}),t.set("_verticalBar",p)}}};const{Group:Hi}=ge,Vi={anchorOffset:5,inflectionOffset:15,sidePadding:20,lineHeight:32,adjustOffset:15,skipOverlapLabels:!1,triggerOn:"touchstart",activeShape:!1,activeStyle:{offset:1,appendRadius:8,fillOpacity:.5},label1OffsetY:-1,label2OffsetY:1};function qi(t,e,i){return{x:t.x+i*Math.cos(e),y:t.y+i*Math.sin(e)}}function Ui(t,e){const i=t.getBBox(),n=e.getBBox();return Math.max(i.minX,n.minX)<=Math.min(i.maxX,n.minX)&&Math.max(i.minY,n.minY)<=Math.min(i.maxY,n.maxY)}class Zi{constructor(t){T.mix(this,t);const e=this.chart;this.canvasDom=e.get("canvas").get("el")}renderLabels(){const t=this,{chart:e,pieLabelCfg:i,labelGroup:n}=t,s=[[],[]],r=e.get("geoms")[0].get("container").get("children"),{anchorOffset:a,inflectionOffset:o,label1:l,label2:h,lineHeight:c,skipOverlapLabels:u,label1OffsetY:g,label2OffsetY:d}=i,f=e.get("coord"),{center:p,circleRadius:m}=f;r.forEach(t=>{const{startAngle:i,endAngle:n}=t._attrs.attrs,r=function(t,e){return e<t&&(e+=2*Math.PI),(e+t)/2}(i,n),c=qi(p,r,m+a),u=qi(p,r,m+o),f=t.get("origin"),{_origin:x,color:y}=f,v={_anchor:c,_inflection:u,_data:x,x:u.x,y:u.y,r:m+o,fill:y},_=new Hi({context:e.get("canvas").get("context"),data:x}),S={x:0,y:0,fontSize:12,lineHeight:12,fill:"#808080"};T.isFunction(l)&&_.addShape("Text",{attrs:T.mix({textBaseline:"bottom"},S,l(x,y)),data:x,offsetY:g}),T.isFunction(h)&&_.addShape("Text",{attrs:T.mix({textBaseline:"top"},S,h(x,y)),data:x,offsetY:d}),v.textGroup=_,c.x<p.x?(v._side="left",s[0].push(v)):(v._side="right",s[1].push(v))});let x=[];if(u){let e;const i=s[1].concat(s[0]);for(let s=0,r=i.length;s<r;s++){const r=i[s],a=t._drawLabel(r);e&&Ui(a,e)||(n.add(a),t._drawLabelLine(r),e=a,x.push(a))}}else{const i=e.get("height"),n=parseInt(i/c,10);s.forEach(e=>{e.length>n&&e.splice(n,e.length-n),e.sort((t,e)=>t.y-e.y);const i=t._antiCollision(e);x=x.concat(i)})}this.drawnLabels=x}bindEvents(){const t=this.pieLabelCfg.triggerOn||"touchstart";T.addEventListener(this.canvasDom,t,this._handleEvent)}unBindEvents(){const t=this.pieLabelCfg.triggerOn||"touchstart";T.removeEventListener(this.canvasDom,t,this._handleEvent)}clear(){this.labelGroup&&this.labelGroup.clear(),this.halo&&this.halo.remove(!0),this.lastSelectedData=null,this.drawnLabels=[],this.unBindEvents()}_drawLabel(t){const{pieLabelCfg:e,chart:i}=this,n=i.get("width"),{sidePadding:s}=e,{y:r,textGroup:a}=t,o=a.get("children"),l={textAlign:"left"===t._side?"left":"right",x:"left"===t._side?s:n-s};return o.forEach(t=>{t.attr(l),t.attr("y",r+t.get("offsetY"))}),a}_drawLabelLine(t,e){const{chart:i,pieLabelCfg:n,labelGroup:s}=this,r=i.get("width"),{sidePadding:a,adjustOffset:o,lineStyle:l,anchorStyle:h,skipOverlapLabels:c}=n,{_anchor:u,_inflection:g,fill:d,y:f}=t,p={x:"left"===t._side?a:r-a,y:f};let m=[u,g,p];if(!c&&g.y!==f)if(g.y<f){const i=g,n={x:"left"===t._side?p.x+e+o:p.x-e-o,y:g.y},s={x:"left"===t._side?p.x+e:p.x-e,y:p.y};m=[u,i,n,s,p],("right"===t._side&&n.x<i.x||"left"===t._side&&n.x>i.x)&&(m=[u,s,p])}else m=[u,{x:g.x,y:f},p];s.addShape("Polyline",{attrs:T.mix({points:m,lineWidth:1,stroke:d},l)}),s.addShape("Circle",{attrs:T.mix({x:u.x,y:u.y,r:2,fill:d},h)})}_antiCollision(t){const e=this,{chart:i,pieLabelCfg:n}=e,s=i.get("coord"),r=i.get("height"),{center:a,circleRadius:o}=s,{inflectionOffset:l,lineHeight:h}=n,c=a.y-o-l-h;let u,g=!0,d=r,f=0,p=Number.MIN_VALUE,m=0;const x=t.map((function(t){const e=t.y;e>f&&(f=e),e<p&&(p=e);const i=t.textGroup.getBBox().width;return i>=m&&(m=i),{size:h,targets:[e-c]}}));f-c>d&&(d=f-c);const y=function(t){t.forEach(t=>{const e=(Math.min.apply(p,t.targets)+Math.max.apply(p,t.targets))/2;t.pos=Math.min(Math.max(p,e-t.size/2),d-t.size)})};for(;g;)for(y(x),g=!1,u=x.length;u--;)if(u>0){const t=x[u-1],e=x[u];t.pos+t.size>e.pos&&(t.size+=e.size,t.targets=t.targets.concat(e.targets),t.pos+t.size>d&&(t.pos=d-t.size),x.splice(u,1),g=!0)}u=0,x.forEach((function(e){let i=c;e.targets.forEach((function(){t[u].y=e.pos+i+h/2,i+=h,u++}))}));const v=[];return t.forEach((function(t){const i=e._drawLabel(t);e.labelGroup.add(i),e._drawLabelLine(t,m),v.push(i)})),v}_handleEvent=t=>{const{chart:e,drawnLabels:i,pieLabelCfg:n}=this,{onClick:s,activeShape:r}=n,a=T.createEvent(t,e),{x:o,y:l}=a;let h;for(let t=0,e=i.length;t<e;t++){const e=i[t],n=e.getBBox();if(o>=n.minX&&o<=n.maxX&&l>=n.minY&&l<=n.maxY){h=e;break}}const c=e.getSnapRecords({x:o,y:l});h?a.data=h.get("data"):c.length&&(a.data=c[0]._origin),s&&s(a),a.data&&r&&this._activeShape(a.data)};_getSelectedShapeByData(t){let e=null;const i=this.chart.get("geoms")[0],n=i.get("container").get("children");return T.each(n,n=>{if(n.get("isShape")&&n.get("className")===i.get("type")){const i=n.get("origin")._origin;if(T.isObjectValueEqual(i,t))return e=n,!1}}),e}_activeShape(t){const{chart:e,lastSelectedData:i,pieLabelCfg:n}=this;if(t===i)return;this.lastSelectedData=t;const s=n.activeStyle,r=this._getSelectedShapeByData(t),{x:a,y:o,startAngle:l,endAngle:h,r:c,fill:u}=r._attrs.attrs,g=e.get("frontPlot");this.halo&&this.halo.remove(!0);const d=g.addShape("sector",{attrs:T.mix({x:a,y:o,r:c+s.offset+s.appendRadius,r0:c+s.offset,fill:u,startAngle:l,endAngle:h},s)});this.halo=d,e.get("canvas").draw()}}var $i={init(t){const e=t.get("frontPlot").addGroup({className:"pie-label",zIndex:0}),i=new Zi({chart:t,labelGroup:e});t.set("pieLabelController",i),t.pieLabel=function(t){return t=T.deepMix({},Vi,t),i.pieLabelCfg=t,this}},afterGeomDraw(t){const e=t.get("pieLabelController");e.pieLabelCfg&&(e.renderLabels(),e.bindEvents())},clearInner(t){const e=t.get("pieLabelController");e.pieLabelCfg&&e.clear()}};const Ji={label:null,offsetX:0,offsetY:0},Ki={textBaseline:"middle",fill:"#808080"};class Qi{constructor({chart:t,container:e}){this.cfg=null,this.chart=t,this.container=e}draw(){const{chart:t,container:e,cfg:i}=this;if(!i)return;const n=T.mix({},Ji,i),s=t.get("coord");t.get("geoms")[0].get("container").get("children").forEach(t=>{const i=t.get("origin"),{_origin:r,color:a,points:o}=i;if(n.label){const t=n.label(r,a),i=e.addGroup(),c=s.convertPoint((l=o[1],h=o[2],{x:(l.x-h.x)/2+h.x,y:(l.y-h.y)/2+h.y}));i.addShape("Text",{attrs:T.mix({x:c.x+n.offsetX,y:c.y+n.offsetY},t,Ki)})}var l,h})}clear(){const{container:t}=this;t.clear()}}var tn={init(t){const e=t.get("frontPlot").addGroup({className:"label",zIndex:0}),i=new Qi({chart:t,container:e});t.set("intervalLabelController",i),t.intervalLabel=function(t){i.cfg=t}},afterGeomDraw(t){t.get("intervalLabelController").draw()},clearInner(t){t.get("intervalLabelController").clear()}},en=Le((function(t){
/*! Hammer.JS - v2.0.7 - 2016-04-22
     * http://hammerjs.github.io/
     *
     * Copyright (c) 2016 Jorik Tangelder;
     * Licensed under the MIT license */
!function(e,i,n,s){var r,a=["","webkit","Moz","MS","ms","o"],o=i.createElement("div"),l=Math.round,h=Math.abs,c=Date.now;function u(t,e,i){return setTimeout(y(t,i),e)}function g(t,e,i){return!!Array.isArray(t)&&(d(t,i[e],i),!0)}function d(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function f(t,i,n){var s="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=e.console&&(e.console.warn||e.console.log);return r&&r.call(e.console,s,n),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:Object.assign;var p=f((function(t,e,i){for(var n=Object.keys(e),s=0;s<n.length;)(!i||i&&void 0===t[n[s]])&&(t[n[s]]=e[n[s]]),s++;return t}),"extend","Use `assign`."),m=f((function(t,e){return p(t,e,!0)}),"merge","Use `assign`.");function x(t,e,i){var n,s=e.prototype;(n=t.prototype=Object.create(s)).constructor=t,n._super=s,i&&r(n,i)}function y(t,e){return function(){return t.apply(e,arguments)}}function v(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function _(t,e){return void 0===t?e:t}function S(t,e,i){d(M(e),(function(e){t.addEventListener(e,i,!1)}))}function b(t,e,i){d(M(e),(function(e){t.removeEventListener(e,i,!1)}))}function C(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function P(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function w(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function A(t,e,i){for(var n=[],s=[],r=0;r<t.length;){var a=e?t[r][e]:t[r];w(s,a)<0&&n.push(t[r]),s[r]=a,r++}return i&&(n=e?n.sort((function(t,i){return t[e]>i[e]})):n.sort()),n}function D(t,e){for(var i,n,s=e[0].toUpperCase()+e.slice(1),r=0;r<a.length;){if((n=(i=a[r])?i+s:e)in t)return n;r++}}var k=1;function E(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}var I="ontouchstart"in e,O=void 0!==D(e,"PointerEvent"),Y=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=["x","y"],N=["clientX","clientY"];function B(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){v(t.options.enable,[t])&&i.handler(e)},this.init()}function X(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,r=1&e&&n-s==0,a=12&e&&n-s==0;i.isFirst=!!r,i.isFinal=!!a,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=L(e));s>1&&!i.firstMultiple?i.firstMultiple=L(e):1===s&&(i.firstMultiple=!1);var r=i.firstInput,a=i.firstMultiple,o=a?a.center:r.center,l=e.center=z(n);e.timeStamp=c(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=W(o,l),e.distance=G(o,l),function(t,e){var i=e.center,n=t.offsetDelta||{},s=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(s=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y});e.deltaX=s.x+(i.x-n.x),e.deltaY=s.y+(i.y-n.y)}(i,e),e.offsetDirection=j(e.deltaX,e.deltaY);var u=R(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=h(u.x)>h(u.y)?u.x:u.y,e.scale=a?function(t,e){return G(e[0],e[1],N)/G(t[0],t[1],N)}(a.pointers,n):1,e.rotation=a?function(t,e){return W(e[1],e[0],N)+W(t[1],t[0],N)}(a.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,s,r,a=t.lastInterval||e,o=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(o>25||void 0===a.velocity)){var l=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,u=R(o,l,c);n=u.x,s=u.y,i=h(u.x)>h(u.y)?u.x:u.y,r=j(l,c),t.lastInterval=e}else i=a.velocity,n=a.velocityX,s=a.velocityY,r=a.direction;e.velocity=i,e.velocityX=n,e.velocityY=s,e.direction=r}(i,e);var g=t.element;C(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function L(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:l(t.pointers[i].clientX),clientY:l(t.pointers[i].clientY)},i++;return{timeStamp:c(),pointers:e,center:z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function z(t){var e=t.length;if(1===e)return{x:l(t[0].clientX),y:l(t[0].clientY)};for(var i=0,n=0,s=0;s<e;)i+=t[s].clientX,n+=t[s].clientY,s++;return{x:l(i/e),y:l(n/e)}}function R(t,e,i){return{x:e/t||0,y:i/t||0}}function j(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function G(t,e,i){i||(i=F);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return Math.sqrt(n*n+s*s)}function W(t,e,i){i||(i=F);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return 180*Math.atan2(s,n)/Math.PI}B.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(E(this.element),this.evWin,this.domHandler)}};var H={mousedown:1,mousemove:2,mouseup:4};function V(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,B.apply(this,arguments)}x(V,B,{handler:function(t){var e=H[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},U={2:"touch",3:"pen",4:"mouse",5:"kinect"},Z="pointerdown",$="pointermove pointerup pointercancel";function J(){this.evEl=Z,this.evWin=$,B.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(Z="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),x(J,B,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),s=q[n],r=U[t.pointerType]||t.pointerType,a="touch"==r,o=w(e,t.pointerId,"pointerId");1&s&&(0===t.button||a)?o<0&&(e.push(t),o=e.length-1):12&s&&(i=!0),o<0||(e[o]=t,this.callback(this.manager,s,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(o,1))}});var K={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function Q(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,B.apply(this,arguments)}function tt(t,e){var i=T(t.touches),n=T(t.changedTouches);return 12&e&&(i=A(i.concat(n),"identifier",!0)),[i,n]}x(Q,B,{handler:function(t){var e=K[t.type];if(1===e&&(this.started=!0),this.started){var i=tt.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function it(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},B.apply(this,arguments)}function nt(t,e){var i=T(t.touches),n=this.targetIds;if(3&e&&1===i.length)return n[i[0].identifier]=!0,[i,i];var s,r,a=T(t.changedTouches),o=[],l=this.target;if(r=i.filter((function(t){return C(t.target,l)})),1===e)for(s=0;s<r.length;)n[r[s].identifier]=!0,s++;for(s=0;s<a.length;)n[a[s].identifier]&&o.push(a[s]),12&e&&delete n[a[s].identifier],s++;return o.length?[A(r.concat(o),"identifier",!0),o]:void 0}x(it,B,{handler:function(t){var e=et[t.type],i=nt.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}});function st(){B.apply(this,arguments);var t=y(this.handler,this);this.touch=new it(this.manager,t),this.mouse=new V(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function rt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,at.call(this,e)):12&t&&at.call(this,e)}function at(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout((function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)}),2500)}}function ot(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var s=this.lastTouches[n],r=Math.abs(e-s.x),a=Math.abs(i-s.y);if(r<=25&&a<=25)return!0}return!1}x(st,B,{handler:function(t,e,i){var n="touch"==i.pointerType,s="mouse"==i.pointerType;if(!(s&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)rt.call(this,e,i);else if(s&&ot.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var lt=D(o.style,"touchAction"),ht=void 0!==lt,ct=function(){if(!ht)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!i||e.CSS.supports("touch-action",n)})),t}();function ut(t,e){this.manager=t,this.set(e)}ut.prototype={set:function(t){"compute"==t&&(t=this.compute()),ht&&this.manager.element.style&&ct[t]&&(this.manager.element.style[lt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return d(this.manager.recognizers,(function(e){v(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(P(t,"none"))return"none";var e=P(t,"pan-x"),i=P(t,"pan-y");if(e&&i)return"none";if(e||i)return e?"pan-x":"pan-y";if(P(t,"manipulation"))return"manipulation";return"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,s=P(n,"none")&&!ct.none,r=P(n,"pan-y")&&!ct["pan-y"],a=P(n,"pan-x")&&!ct["pan-x"];if(s){var o=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(o&&l&&h)return}if(!a||!r)return s||r&&6&i||a&&24&i?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function gt(t){this.options=r({},this.defaults,t||{}),this.id=k++,this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function dt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function ft(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function pt(t,e){var i=e.manager;return i?i.get(t):t}function mt(){gt.apply(this,arguments)}function xt(){mt.apply(this,arguments),this.pX=null,this.pY=null}function yt(){mt.apply(this,arguments)}function vt(){gt.apply(this,arguments),this._timer=null,this._input=null}function _t(){mt.apply(this,arguments)}function St(){mt.apply(this,arguments)}function bt(){gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ct(t,e){return(e=e||{}).recognizers=_(e.recognizers,Ct.defaults.preset),new Pt(t,e)}gt.prototype={defaults:{},set:function(t){return r(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=pt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=pt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===w(e,t=pt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=pt(t,this);var e=w(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+dt(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+dt(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=r({},t);if(!v(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(mt,gt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=6&e,s=this.attrTest(t);return n&&(8&i||!s)?16|e:n||s?4&i?8|e:2&e?4|e:2:32}}),x(xt,mt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,s=t.direction,r=t.deltaX,a=t.deltaY;return s&e.direction||(6&e.direction?(s=0===r?1:r<0?2:4,i=r!=this.pX,n=Math.abs(t.deltaX)):(s=0===a?1:a<0?8:16,i=a!=this.pY,n=Math.abs(t.deltaY))),t.direction=s,i&&n>e.threshold&&s&e.direction},attrTest:function(t){return mt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=ft(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(yt,mt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(vt,gt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!n||!i||12&t.eventType&&!s)this.reset();else if(1&t.eventType)this.reset(),this._timer=u((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}}),x(_t,mt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),x(St,mt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return xt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return 30&i?e=t.overallVelocity:6&i?e=t.overallVelocityX:24&i&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=ft(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(bt,gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(n&&s&&i){if(4!=t.eventType)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||G(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=u((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=u((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ct.VERSION="2.0.7",Ct.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[_t,{enable:!1}],[yt,{enable:!1},["rotate"]],[St,{direction:6}],[xt,{direction:6},["swipe"]],[bt],[bt,{event:"doubletap",taps:2},["tap"]],[vt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Pt(t,e){var i;this.options=r({},Ct.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(O?J:Y?it:I?st:V))(i,X),this.touchAction=new ut(this,this.options.touchAction),Mt(this,!0),d(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Mt(t,e){var i,n=t.element;n.style&&(d(t.options.cssProps,(function(s,r){i=D(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=s):n.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}Pt.prototype={set:function(t){return r(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,s=e.curRecognizer;(!s||s&&8&s.state)&&(s=e.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||s&&i!=s&&!i.canRecognizeWith(s)?i.reset():i.recognize(t),!s&&14&i.state&&(s=e.curRecognizer=i),r++}},get:function(t){if(t instanceof gt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=w(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var i=this.handlers;return d(M(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var i=this.handlers;return d(M(t),(function(t){e?i[t]&&i[t].splice(w(i[t],e),1):delete i[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var s=0;s<n.length;)n[s](e),s++}},destroy:function(){this.element&&Mt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Ct,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Pt,Input:B,TouchAction:ut,TouchInput:it,MouseInput:V,PointerEventInput:J,TouchMouseInput:st,SingleTouchInput:Q,Recognizer:gt,AttrRecognizer:mt,Tap:bt,Pan:xt,Swipe:St,Pinch:yt,Rotate:_t,Press:vt,on:S,off:b,each:d,merge:m,extend:p,assign:r,inherit:x,bindFn:y,prefixed:D}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Ct,t.exports?t.exports=Ct:e.Hammer=Ct}(window,document)}));let nn;ve._Interactions={},ve.registerInteraction=function(t,e){ve._Interactions[t]=e},ve.getInteraction=function(t){return ve._Interactions[t]},ve.prototype.interaction=function(t,e){const i=this._interactions||{};i[t]&&i[t].destroy();const n=new(ve.getInteraction(t))(e,this);return i[t]=n,this._interactions=i,this},ve.prototype.clearInteraction=function(t){const e=this._interactions;if(e)return t?(e[t]&&e[t].destroy(),delete e[t]):o(e,(t,i)=>{t.destroy(),delete e[i]}),this},T.isWx||T.isMy||(nn=en);const sn=["touchstart","touchmove","touchend"];class rn{getDefaultCfg(){return{startEvent:sn[0],processEvent:sn[1],endEvent:sn[2],resetEvent:null}}_start=t=>{this.preStart&&this.preStart(t),this.start(t),this.onStart&&this.onStart(t)};_process=t=>{this.preProcess&&this.preProcess(t),this.process(t),this.onProcess&&this.onProcess(t)};_end=t=>{this.preEnd&&this.preEnd(t),this.end(t),this.onEnd&&this.onEnd(t)};_reset=t=>{this.preReset&&this.preReset(t),this.reset(t),this.onReset&&this.onReset(t)};start(){}process(){}end(){}reset(){}constructor(t,e){const i=this.getDefaultCfg();T.deepMix(this,i,t),this.chart=e,this.canvas=e.get("canvas"),this.el=e.get("canvas").get("el"),this._bindEvents()}_bindEvents(){this._clearEvents();const{startEvent:t,processEvent:e,endEvent:i,resetEvent:n,el:s}=this;nn&&(this.hammer=new nn(s)),this._bindEvent(t,this._start),this._bindEvent(e,this._process),this._bindEvent(i,this._end),this._bindEvent(n,this._reset)}_clearEvents(){const{startEvent:t,processEvent:e,endEvent:i,resetEvent:n}=this;this.hammer&&(this.hammer.destroy(),this.hammer=null),this._clearTouchEvent(t,this._start),this._clearTouchEvent(e,this._process),this._clearTouchEvent(i,this._end),this._clearTouchEvent(n,this._reset)}_bindEvent(t,e){const i=this.el;t&&(-1!==sn.indexOf(t)?T.addEventListener(i,t,e):this.hammer&&this.hammer.on(t,e))}_clearTouchEvent(t,e){const i=this.el;t&&-1!==sn.indexOf(t)&&T.removeEventListener(i,t,e)}destroy(){this._clearEvents()}}ve.registerInteraction("pie-select",class extends rn{getDefaultCfg(){let t=super.getDefaultCfg();return t=T.mix({},t,{startEvent:"tap",processEvent:null,animate:!1,offset:1,appendRadius:8,style:{fillOpacity:.5},cancelable:!0,defaultSelected:null}),(T.isWx||T.isMy)&&(t.startEvent="touchstart",t.endEvent="touchend"),t}constructor(t,e){super(t,e);const i=this;e.registerPlugins({clearInner(){i.halo&&i.halo.remove(!0),i.selected=!1,i.selectedShape=null,i.lastShape=null,i.halo=null,i.defaultSelected=null}});const n=i.defaultSelected;if(T.isObject(n)){const t=i._getSelectedShapeByData(n);t&&i._selectedShape(t),this.canvas.draw()}}_getSelectedShapeByData(t){let e=null;const i=this.chart.get("geoms")[0],n=i.get("container").get("children");return T.each(n,n=>{if(n.get("isShape")&&n.get("className")===i.get("type")){const i=n.get("origin")._origin;if(T.isObjectValueEqual(i,t))return e=n,!1}}),e}_selectedShape(t){const{offset:e,style:i,appendRadius:n,chart:s}=this;this.lastShape=t;const{x:r,y:a,startAngle:o,endAngle:l,r:h,fill:c}=t._attrs.attrs,u=s.get("frontPlot").addShape("sector",{attrs:T.mix({x:r,y:a,r:h+e+n,r0:h+e,fill:c,startAngle:o,endAngle:l},i)});this.halo=u;let g=this.animate;g&&(!0===g&&(g={duration:300}),u.attr("r",h+e),u.animate().to(T.mix({attrs:{r:h+e+n}},g)))}start(t){const e=this.chart;"tap"===t.type&&(t.clientX=t.center.x,t.clientY=t.center.y);const{x:i,y:n}=T.createEvent(t,e),s=e.getSnapRecords({x:i,y:n});if(!s.length)return this.selected=!1,void(this.selectedShape=null);const r=s[0]._origin,a=this._getSelectedShapeByData(r),o=this.lastShape;if(this.selectedShape=a,this.selected=!0,a===o){if(!this.cancelable)return;this.halo&&this.halo.remove(!0),this.lastShape=null,this.selected=!1}else this.halo&&this.halo.remove(!0),this._selectedShape(a);this.canvas.draw()}end(t){const e=this.selectedShape;e&&!e.get("destroyed")&&(t.data=e.get("origin")._origin,t.shapeInfo=e.get("origin"),t.shape=e,t.selected=!!this.selected)}});ve.registerInteraction("interval-select",class extends rn{getDefaultCfg(){let t=super.getDefaultCfg();return t=T.mix({},t,{startEvent:"tap",processEvent:null,selectAxis:!0,selectAxisStyle:{fontWeight:"bold"},mode:"shape",selectStyle:{fillOpacity:1},unSelectStyle:{fillOpacity:.4},cancelable:!0,defaultSelected:null}),(T.isWx||T.isMy)&&(t.startEvent="touchstart",t.endEvent="touchend"),t}constructor(t,e){super(t,e);const i=this.defaultSelected;if(T.isObject(i)){const{selectedShape:t,unSelectedShapes:e}=this._selectShapesByData(i);t&&this._selectShapes(t,e),this.selectedShape=t}}_getIntervalShapes(){let t=[];return this.chart.get("geoms").forEach(e=>{if("interval"===e.get("type")){const i=e.get("container");t=t.concat(i.get("children"))}}),t}_resetShape(t){const e=t.get("_originAttrs");e&&(t._attrs.attrs=e,t.set("_originAttrs",null))}_setEventData(t){const e=this.selectedShape;e&&!e.get("destroyed")&&(t.data=e.get("origin")._origin,t.shapeInfo=e.get("origin"),t.shape=e,t.selected=!!e.get("_selected"))}_selectShapesByData(t){const e=this._getIntervalShapes();let i=null;const n=[];return T.each(e,e=>{if(e.get("isShape")&&"interval"===e.get("className")){const s=e.get("origin")._origin;T.isObjectValueEqual(s,t)?i=e:n.push(e)}}),{selectedShape:i,unSelectedShapes:n}}_selectShapes(t,e){const{selectStyle:i,unSelectStyle:n,selectAxisStyle:s,chart:r}=this;if(!t.get("_originAttrs")){const e=Object.assign({},t.attr());t.set("_originAttrs",e)}if(t.attr(i),T.each(e,t=>{if(t.get("_originAttrs"))t.attr(t.get("_originAttrs"));else{const e=Object.assign({},t.attr());t.set("_originAttrs",e)}t.set("_selected",!1),n&&t.attr(n)}),t.set("_selected",!0),this.selectAxis){this.selectedAxisShape&&this._resetShape(this.selectedAxisShape);const e=r.getXScale(),i=t.get("origin")._origin,{frontPlot:n,backPlot:a}=r.get("axisController");let o;T.each(n.get("children").concat(a.get("children")),t=>{if(t.get("value")===e.scale(i[e.field]))return o=t,!1}),this.selectedAxisShape=o,o.set("_originAttrs",Object.assign({},o.attr())),o.attr(s)}this.canvas.draw()}reset(){const t=this;if(!t.selectedShape)return;const e=t._getIntervalShapes();T.each(e,e=>{t._resetShape(e),e.set("_selected",!1)}),t.selectedAxisShape&&t._resetShape(t.selectedAxisShape),t.canvas.draw(),t.selectedShape=null,t.selectedAxisShape=null}start(t){const e=this.chart;"tap"===t.type&&(t.clientX=t.center.x,t.clientY=t.center.y);const{x:i,y:n}=T.createEvent(t,e),s=this.mode,r=this._getIntervalShapes();let a,o=[];if("shape"===s){const t=e.get("plotRange");if(!me.isPointInPlot({x:i,y:n},t))return void this.reset();T.each(r,t=>{const e=t.getBBox();i>=e.x&&i<=e.x+e.width&&n>=e.y&&n<=e.height+e.y?a=t:o.push(t)})}else if("range"===s){const t=e.getSnapRecords({x:i,y:n});if(!t.length)return void this.reset();const s=t[0]._origin,r=this._selectShapesByData(s);a=r.selectedShape,o=r.unSelectedShapes}if(a)if(this.selectedShape=a,a.get("_selected")){if(!this.cancelable)return void this._setEventData(t);this.reset()}else this._selectShapes(a,o);else this.reset();this._setEventData(t)}end(t){this._setEventData(t)}});var an={beforeGeomInit(t){t.set("limitInPlot",!0);const e=t.get("filteredData"),i=t.get("colDefs");if(!i)return e;const n=t.get("geoms");let s=!1;T.each(n,t=>{if(-1!==["area","line","path"].indexOf(t.get("type")))return s=!0,!1});const r=[];if(T.each(i,(t,e)=>{!s&&t&&(t.values||t.min||t.max)&&r.push(e)}),0===r.length)return e;const a=[];T.each(e,t=>{let e=!0;T.each(r,n=>{let s=t[n];if(s){const t=i[n];if("timeCat"===t.type){const e=t.values;T.isNumber(e[0])&&(s=je(s))}(t.values&&-1===t.values.indexOf(s)||t.min&&s<t.min||t.max&&s>t.max)&&(e=!1)}}),e&&a.push(t)}),t.set("filteredData",a)}};const on=["touchstart","touchmove","touchend","touchStart","touchMove","touchEnd"];var ln={_handleMove(t){if("swipe"===t.type&&t.deltaTime>350)return null;const{currentDeltaX:e,currentDeltaY:i,lastPoint:n}=this;let s,r;if(-1!==on.indexOf(t.type)){const e=t.touches[0];s=e.x-n.x,r=e.y-n.y,this.lastPoint=e}else null!==e&&null!==i&&(s=t.deltaX-e,r=t.deltaY-i,this.currentDeltaX=t.deltaX,this.currentDeltaY=t.deltaY);if(Math.abs(s)>0||Math.abs(r)>0){const t=this._timestamp,e=+new Date;e-t>16&&(this._doMove(s,r),this._timestamp=e)}},_doMove(t,e){const i=this,{mode:n,chart:s,limitRange:r}=i,a=s.get("coord"),{start:o,end:l}=a,h=s.get("data");if(T.directionEnabled(n,"x")&&0!==t){const e=s.getXScale(),n=e.field;r[n]||(r[n]=ji.getLimitRange(h,e));const a=l.x-o.x;e.isCategory?i._handleCatScale(e,t,a):e.isLinear&&i._handleLinearScale(e,t,a,"x"),i.xRange=ji.getFieldRange(e,r[n],e.type)}if(T.directionEnabled(n,"y")&&0!==e){const t=o.y-l.y,n=s.getYScales();T.each(n,n=>{const s=n.field;r[s]||(r[s]=ji.getLimitRange(h,n)),n.isLinear&&i._handleLinearScale(n,e,t,"y")});const a=n[0];i.yRange=ji.getFieldRange(a,r[a.field],a.type)}s.repaint()},_handleLinearScale(t,e,i,n){const{field:s,min:r,max:a}=t,o=this.limitRange;if(r===o[s].min&&a===o[s].max)return;const l=e/i*(a-r);let h="x"===n?a-l:a+l,c="x"===n?r-l:r+l;o[s]&&!T.isNil(o[s].min)&&c<=o[s].min&&(c=o[s].min,h=a-r+c),o[s]&&!T.isNil(o[s].max)&&h>=o[s].max&&(h=o[s].max,c=h-(a-r)),this.updateLinearScale(s,c,h)},_handleCatScale(t,e,i){const{type:n,field:s,values:r,ticks:a}=t,o=T.uniq(r),l=this.limitRange[s],h=l.length-1,c=o.length,u=i/(c*(this.speed||1)),g=l.indexOf(o[0]),d=l.indexOf(o[c-1]);let f=g,p=d;const m=Math.abs(e/i),x=this.step||Math.max(1,parseInt(m*c));if(this._panCumulativeDelta+=e,f=this._panCumulativeDelta>u?Math.max(0,f-x):this._panCumulativeDelta<-u?Math.min(h-c+1,f+x):f,p=Math.min(h,f+c-1),f===g&&p===d)return null;const y=l.slice(f,p+1);let v=null;if("timeCat"===n){const t=a.length>2?a[1]-a[0]:864e5;if(this._panCumulativeDelta>u)for(let e=a[0]-t;e>=y[0];e-=t)a.unshift(e);else if(this._panCumulativeDelta<-u)for(let e=a[a.length-1]+t;e<=y[y.length-1];e+=t)a.push(e);v=a}else v=a;this.updateCatScale(s,y,v,l,f,p),this._panCumulativeDelta=f!==g?0:this._panCumulativeDelta}},hn={updateLinearScale(t,e,i){const n=this.chart;ji.getScale(n,t).change({min:e,max:i,nice:!1})},updateCatScale(t,e,i,n,s,r){const a=this.chart;ji.getScale(a,t).change({values:e,ticks:i,scale(t){"timeCat"===this.type&&(t=this._toTimeStamp(t));const e=this.rangeMin(),i=this.rangeMax(),a=i-e;let o,l,h;const c=n.indexOf(t);if(c>=0&&c<s)l=e>0?-.1:e-.1,o=l-a,h=c/s;else if(c>=0&&c>r)o=i<1?1.1:i+.1,l=o+a,h=(c-r-1)/(n.length-1-r);else{const n=this.translate(t);h=1===this.values.length?n:n/(this.values.length-1),o=e,l=i}return o+h*(l-o)},getTicks(){const t=this,e=this.ticks,i=[];return T.each(e,e=>{let n;if(T.isObject(e))n=e;else{let i=t.scale(e);i=i>=0&&i<=1?i:NaN,n={text:T.isString(e)?e:t.getText(e),value:i,tickValue:e}}i.push(n)}),i}})}};ve.registerInteraction("swipe",class extends rn{getDefaultCfg(){let t=super.getDefaultCfg();return t=T.mix({},t,{startEvent:"touchstart",processEvent:"swipe",endEvent:"touchend",currentDeltaX:null,threshold:10,velocity:.3,limitRange:{},_timestamp:0,_panCumulativeDelta:0,speed:5}),t}constructor(t,e){super(t,e);const i=this,{hammer:n,threshold:s,velocity:r}=i;n&&n.get("swipe").set({direction:6,threshold:s,velocity:r}),e.registerPlugins([an,{changeData(){i.limitRange={}},clear(){i.limitRange={}}}]),i.mode="x",T.mix(i,hn,ln)}process(t){this.currentDeltaX=0,this._handleMove(t)}end(){this.currentDeltaX=null,this._panCumulativeDelta=0}});ve.registerInteraction("pan",class extends rn{getDefaultCfg(){let t=super.getDefaultCfg();return t=T.mix({},t,{startEvent:"panstart",processEvent:"panmove",endEvent:"panend",resetEvent:"touchend",mode:"x",panThreshold:10,pressThreshold:9,pressTime:251,currentDeltaX:null,currentDeltaY:null,limitRange:{},_timestamp:0,lastPoint:null,_panCumulativeDelta:0,speed:5}),(T.isWx||T.isMy)&&(t.startEvent="touchstart",t.processEvent="touchmove",t.endEvent="touchend"),t}constructor(t,e){super(t,e);const i=this,{hammer:n,panThreshold:s}=i;n&&(n.get("pan").set({threshold:s}),e.get("canvas").on("pan",()=>{})),e.registerPlugins([an,{changeData(){i.limitRange={}},clear(){i.limitRange={}}}]),T.mix(this,hn,ln)}start(t){this.pressed||(this.currentDeltaX=0,this.currentDeltaY=0,"touchstart"!==t.type&&"touchStart"!==t.type||(this.lastPoint=t.touches[0]),this._handleMove(t))}process(t){this.pressed||this._handleMove(t)}end(){this.pressed||(this.currentDeltaX=null,this.currentDeltaY=null,this.lastPoint=null,this._panCumulativeDelta=0)}});return ve.registerInteraction("pinch",class extends rn{getDefaultCfg(){const t=super.getDefaultCfg();return T.mix({},t,{startEvent:"pinchstart",processEvent:"pinch",endEvent:"pinchend",resetEvent:"touchend",pressThreshold:9,pressTime:251,mode:"x",currentPinchScaling:null,originValues:null,minScale:null,maxScale:null,limitRange:{},sensitivity:1,_pinchCumulativeDelta:0,_timestamp:0})}constructor(t,e){super(t,e);const i=this,{hammer:n}=i;n.get("pinch").set({enable:!0}),e.registerPlugins([an,{changeData(){i.limitRange={},i.originTicks=null},clear(){i.limitRange={},i.originTicks=null}}]),T.mix(i,hn)}start(){this.pressed||(this.currentPinchScaling=1)}process(t){this.pressed||this._handlePinch(t)}end(t){this.pressed||(this._handlePinch(t),this.currentPinchScaling=null,this.pinchCumulativeDelta=0)}_handlePinch(t){const e=1/this.currentPinchScaling*t.scale,i=t.target.getBoundingClientRect(),n={x:t.center.x-i.left,y:t.center.y-i.top},s=Math.abs(t.pointers[0].clientX-t.pointers[1].clientX),r=Math.abs(t.pointers[0].clientY-t.pointers[1].clientY),a=s/r;let o;o=a>.3&&a<1.7?"xy":s>r?"x":"y";const l=this._timestamp,h=+new Date;h-l>16&&(this._doZoom(e,n,o),this._timestamp=h),this.currentPinchScaling=t.scale}_doZoom(t,e,i){const n=this,{mode:s,chart:r,limitRange:a}=n;let o;o="xy"===s&&void 0!==i?i:"xy";const l=r.get("data");if(T.directionEnabled(s,"x")&&T.directionEnabled(o,"x")){const i=r.getXScale(),s=i.field;a[s]||(a[s]=ji.getLimitRange(l,i)),i.isCategory?n._zoomCatScale(i,t,e):i.isLinear&&n._zoomLinearScale(i,t,e,"x"),this.xRange=ji.getFieldRange(i,a[s],i.type)}if(T.directionEnabled(s,"y")&&T.directionEnabled(o,"y")){const i=r.getYScales();T.each(i,i=>{const s=i.field;a[s]||(a[s]=ji.getLimitRange(l,i)),i.isLinear&&n._zoomLinearScale(i,t,e,"y")});const s=i[0];this.yRange=ji.getFieldRange(s,a[s.field],s.type)}r.repaint()}_zoomLinearScale(t,e,i,n){const s=this.chart,{min:r,max:a,field:o}=t,l=a-r,h=this.limitRange,c=h[o].max-h[o].min,u=s.get("coord");let g=l*(e-1);if(this.minScale&&e<1){const t=c/this.minScale;g=Math.max(l-t,g)}if(this.maxScale&&e>=1){const t=c/this.maxScale;g=Math.min(l-t,g)}const d=u.invertPoint(i),f="x"===n?d.x:d.y,p=a-g*(1-f),m=r+g*f;this.updateLinearScale(o,m,p)}_zoomCatScale(t,e,i){let n=this._pinchCumulativeDelta;const s=this.sensitivity;n=e>1?n+1:n-1,this._pinchCumulativeDelta=n;const{field:r,values:a}=t,o=this.chart.get("coord");this.originTicks||(this.originTicks=t.ticks);const l=this.limitRange[r],h=l.length,c=this.minScale||1,u=this.maxScale||5,g=parseInt(h/u),d=parseInt(h/c),f=a.length;if(n>0&&f<=g)return null;if(n<0&&f>=d)return null;const p=h-1,m=a[0],x=a[f-1];let y=l.indexOf(m),v=l.indexOf(x);const _=(o.start.x+o.end.x)/2,S=i.x;if(Math.abs(n)>s){const t=Math.max(1,parseInt(f*Math.abs(e-1)));n<0?(S>=_?y<=0?v=Math.min(p,v+t):y=Math.max(0,y-t):S<_&&(v>=p?y=Math.max(0,y-t):v=Math.min(p,v+t)),this._pinchCumulativeDelta=0):n>0&&(S>=_?y=y<v?y=Math.min(v,y+t):y:S<_&&(v=v>y?v=Math.max(y,v-t):v),this._pinchCumulativeDelta=0);const i=l.slice(y,v+1);this.updateCatScale(r,i,this.originTicks,l,y,v)}}}),Se.Animate=Mi,Se.Chart.plugins.register([hi,fi,ui,Ri,Wi,$i,tn]),Se.Interaction=rn,Se}));
